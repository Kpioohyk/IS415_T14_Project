---
title: "try test"
author: "Ng Xun Jie"
date: "10/25/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
packages = c('sf','spdep','rgdal','tmap','tidyverse', "knitr")
for (p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p, character.only = T)
}
```


```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- read_csv("data/aspatial/podes2018_part4.csv")
#glimpse(podes4)
```

```{r}
colnames(podes4)
```





```{r}
podes4 <- podes4 %>%
  rename(SHAPE = Shape,
         PROVINCE_ID = R101,
         PROVINCE = R101N,
         CITY_ID = R102,
         CITY = R102N,
         DISTRICT_ID = R103,
         DISTRICT = R103N,
         VILLAGE_ID = R104,
         VILLAGE = R104N,
         FIGHTS_VILLAGE_SUBDISTRICT = R1301A,
         TOTAL_FIGHT_COMMUNITY_GRP = R1301B1K2,
         FIGHT_COMMUNITY_GRP_DIED = R1301B1K3,
         FIGHT_COMMUNITY_GRP_INJURED = R1301B1K4,
         CAUSE_OF_FIGHT_COMMUNITY_GRP = R1301B1K5,
         TOTAL_FIGHT_RURAL_COMMUNITY = R1301B2K2,
         FIGHT_RURAL_COMMUNITY_DIED = R1301B2K3,
         FIGHT_RURAL_COMMUNITY_INJURED = R1301B2K4,
         CAUSE_OF_FIGHT_RURAL_COMMUNITY = R1301B2K5,
         TOTAL_FIGHT_COMMUNITY_SECURITY_FORCE = R1301B3K2,
         FIGHT_RURAL_COMMUNITY_SECURITY_FORCE_DIED = R1301B3K3,
         FIGHT_RURAL_COMMUNITY_SECURITY_FORCE_INJURED = R1301B3K4,
         CAUSE_OF_FIGHT_RURAL_COMMUNITY_SECURITY_FORCE = R1301B3K5,
         TOTAL_FIGHT_COMMUNITY_GOV_OFF = R1301B4K2,
         FIGHT_RURAL_COMMUNITY_GOV_OFF_DIED = R1301B4K3,
         FIGHT_RURAL_COMMUNITY_GOV_OFF_INJURED = R1301B4K4,
         CAUSE_OF_FIGHT_RURAL_COMMUNITY_GOV_OFF = R1301B4K5,
         TOTAL_FIGHT_STUDENT = R1301B5K2,
         FIGHT_RURAL_STUDENT_DIED = R1301B5K3,
         FIGHT_RURAL_STUDENT_INJURED = R1301B5K4,
         CAUSE_OF_FIGHT_RURAL_STUDENT = R1301B5K5,
         TOTAL_FIGHT_ETHNIC= R1301B6K2,
         FIGHT_RURAL_ETHNIC_DIED = R1301B6K3,
         FIGHT_RURAL_ETHNIC_INJURED = R1301B6K4,
         CAUSE_OF_FIGHT_RURAL_ETHNIC = R1301B6K5,
         TOTAL_FIGHT_OTHERS = R1301B7K2,
         FIGHT_RURAL_OTHERS_DIED = R1301B7K3,
         FIGHT_RURAL_OTHERS_INJURED = R1301B7K4,
         CAUSE_OF_FIGHT_RURAL_OTHERS = R1301B7K5,
         RESOLVED_FIGHT = R1302A,
         RECONCILIATOR = R1302B,
         THEFT = R1303A01K3,
         TREND_THEFT= R1303A01K4,
         ROBBERY= R1303A02K3,
         TREND_ROBBERY = R1303A02K4,
         FRAUD_EMBEZZLEMENT = R1303A03K3,
         TREND_FRAUD_EMBEZZLEMENT = R1303A03K4,
         PERSECUTION = R1303A04K3,
         TREND_PERSECUTION = R1303A04K4,
         ARSON = R1303A05K3,
         TREND_ARSON= R1303A05K4,
         RAPE_CRIME_AGAINST_DECENCY = R1303A06K3,
         TREND_RAPE_CRIME_AGAINST_DECENCY = R1303A06K4,
         DRUG_ABUSE_TRAFFICKING = R1303A07K3,
         TREND_DRUG_ABUSE_TRAFFICKING = R1303A07K4,
         GAMBLING = R1303A08K3,
         TREND_GAMBLING = R1303A08K4,
         MURDER= R1303A09K3,
         TREND_MURDER= R1303A09K4,
         TRAFFICKING= R1303A10K3,
         TREND_TRAFFICKING= R1303A10K4,
         CORRUPTION= R1303A11K3,
         TREND_CORRUPTION= R1303A11K4,
         TYPE_OF_CRIME_MOST= R1303B,
         BUILDING_MAINTENANCE_SECURITY_POST= R1304A,
         ESTABLISHING_SECURITY_GUARD= R1304B,
         RAISING_CIVIL_DEFENSE= R1304C,
         REPORTING_GUEST_STAY_MORE_THAN_24_HOURS= R1304D,
         ACTIVATION_OF_SECURITY_SYSTEM_FROM_CITIZEN_INITIATIVE= R1304E,
         NO_OF_CIVIL_DEFENSE_PROTECTION_PERSONNEL_IN_VILLAGE= R1305, 
         EXISTENCE_OF_POLICE_STATION_OFFICE_VILLAGE= R1306A,
         NUMBER_OF_POLICE_STATION_USED= R1306B1,
         NUMBER_OF_POLICE_STATION_NOT_USED= R1306B2,
         ESTIMATE_DISTANCE_TO_NEAREST_POLICE_STATION_KM= R1306C1,
         CONVENIENCE_TO_REACH_NEAREST_POLICE_STATION= R1306C2,
         NO_OF_SUICIDE_VICTIM_ATTEMPTED_SUICIDE_VILLAGE= R1307,
         CONVENIENCE_TO_STREET_CHILDREN_HANGOUT_LOCATION= R1308A,  
         CONVENIENCE_TO_HANGOUT_PLACES_HOMELESS_BEGGAR= R1308B, 
         CONVENIENCE_TO_LOCATION_OF_COMMERCIAL_SEX_WORKERS= R1309,  
         AVAILABILITY_OF_VILLAGE_INFORMATION= R1403A,  
         USAGE_OF_VILLAGE_FINANCIAL_SYSTEM= R1403B,  
         VILLAGE_OWNED_ENTERPRISE_LAND= R1404B,  
         VILLAGE_BUILDINGS= R1404C,  
         VILLAGE_MARKET= R1404D,  
         OTHER_VILLAGE_ASSETS= R1404E,  
         VILLAGE_MED_TERM_DEV_PLAN= R1405A1,
         PERIOD_OF_RPJM_DEVELOP_YEAR_START= R1405A2K1,
         PERIOD_OF_RPJM_DEVELOP_YEAR_END= R1405A2K2,
         VILLAGE_GOV_WORK_PLAN_2018= R1405B,   
         VILLAGE_REGULATION_NUMBER_2017= R1405C, 
         NO_OF_HEADMAN_REGULATION_2017= R1405D, 
         AVAILABILITY_OF_VILLAGE_COOPERATION_BETWEEN_VILLAGES_2018= R1406A,  
         AVAILABILITY_OF_VILLAGE_COOPERATION_WITH_THIRD_PARTIES_2018= R1406B,  
         AVAILABILITY_OF_VILLAGE_ASSISTANCE= R1407,   
         TRANSPORTATION_INFRASTRUCTURE_DEVELOPMENT= R1601A1K2, 
         SOURCE_OF_FUND1= R1601A1K3,
         ADMINISTRATOR1= R1601A1K4,
         DIRECT_BENEFIT_RECEIVER1= R1601A1K5,
         ENERGY_INFRASTRUCTURE= R1601A2K2,
         SOURCE_OF_FUND2= R1601A2K3,
         ADMINISTRATOR2= R1601A2K4,
         DIRECT_BENEFIT_RECEIVER2= R1601A2K5,
         INFORMATION_COMMUNICATION_INFRASTRUCTURE= R1601A3K2,
         SOURCE_OF_FUND3= R1601A3K3,
         ADMINISTRATOR3= R1601A3K4,
         DIRECT_BENEFIT_RECEIVER3= R1601A3K5,
         SANITATION_INFRASTRUCTURE= R1601A4K2,
         SOURCE_OF_FUND4= R1601A4K3,
         ADMINISTRATOR4= R1601A4K4,
         DIRECT_BENEFIT_RECEIVER4= R1601A4K5,
         EDUCATION_CULTURE_HEALTH_INFRASTRUCTURE= R1601A5K2,
         SOURCE_OF_FUND5= R1601A5K3,
         ADMINISTRATOR5= R1601A5K4,
         DIRECT_BENEFIT_RECEIVER5= R1601A5K5,
         TRADING_SERVICES_INFRASTRUCTURE= R1601A6K2,
         SOURCE_OF_FUND6= R1601A6K3,
         ADMINISTRATOR6= R1601A6K4,
         DIRECT_BENEFIT_RECEIVER6= R1601A6K5,
         FARMING_PRODUCTION_VILLAGE_SMALL_INDUSTRY_INFRASTRUCTURE= R1601A7K2,
         SOURCE_OF_FUND7= R1601A7K3,
         ADMINISTRATOR7= R1601A7K4,
         DIRECT_BENEFIT_RECEIVER7= R1601A7K5,
         RECREATION_TOURISM_INFRASTRUCTURE= R1601A8K2,
         SOURCE_OF_FUND8= R1601A8K3,
         ADMINISTRATOR8= R1601A8K4,
         DIRECT_BENEFIT_RECEIVER8= R1601A8K5,
         DISASTER_MGMT_ENV_CONSERVATION_INFRASTRUCTURE= R1601A9K2,
         SOURCE_OF_FUND9= R1601A9K3,
         ADMINISTRATOR9= R1601A9K4,
         DIRECT_BENEFIT_RECEIVER9= R1601A9K5,
         GOV_SUPPORT_INFRASTRUCTURE= R1601A10K2 ,
         SOURCE_OF_FUND10= R1601A10K3,
         ADMINISTRATOR10= R1601A10K4,
         DIRECT_BENEFIT_RECEIVER10= R1601A10K5,
         EDU_HEALTH_PUBLIC_CULTURE_EMPOWERMENT= R1601B1K2,
         SOURCE_OF_FUND11= R1601B1K3,
         ADMINISTRATOR11= R1601B1K4,
         DIRECT_BENEFIT_RECEIVER11= R1601B1K5,
         VILLAGE_RESIDENTIAL_NEIGHBOURHOOD_MGMT_EMPOWERMENT= R1601B2K2,
         SOURCE_OF_FUND12= R1601B2K3,
         ADMINISTRATOR12= R1601B2K4,
         DIRECT_BENEFIT_RECEIVER12= R1601B2K5,
         VILLAGE_TRANSPORTATION_MGMT_EMPOWERMENT= R1601B3K2,
         SOURCE_OF_FUND13= R1601B3K3,
         ADMINISTRATOR13= R1601B3K4,
         DIRECT_BENEFIT_RECEIVER13= R1601B3K5,
         RENEWABLE_ENERGY_DEVELOPMENT_EMPOWERMENT= R1601B4K2,
         SOURCE_OF_FUND14= R1601B4K3,
         ADMINISTRATOR14= R1601B4K4,
         DIRECT_BENEFIT_RECEIVER14= R1601B4K5,
         INFORMATION_COMMUNICATION_MGMT_EMPOWERMENT= R1601B5K2,
         SOURCE_OF_FUND15= R1601B5K3,
         ADMINISTRATOR15= R1601B5K4,
         DIRECT_BENEFIT_RECEIVER15= R1601B5K5,
         AGRI_BASED_PRODUCTIVE_BUSI_NON_AGRI_VILLAGE_SMALL_BUSI_MGMT_EMPOWERMENT= R1601B6K2,
         SOURCE_OF_FUND16= R1601B6K3,
         ADMINISTRATOR16= R1601B6K4,
         DIRECT_BENEFIT_RECEIVER16= R1601B6K5,
         NATURE_CONSERVE_AWARENESS_DISASTER_MGMT_EMPOWERMENT= R1601B7K2,
         SOURCE_OF_FUND17= R1601B7K3,
         ADMINISTRATOR17= R1601B7K4,
         DIRECT_BENEFIT_RECEIVER17= R1601B7K5,
         COMMUNITY_ROLE_IMPROVE_VILLAGE_GOVERNANCE_EMPOWERMENT= R1601B8K2,
         SOURCE_OF_FUND18= R1601B8K3,
         ADMINISTRATOR18= R1601B8K4,
         DIRECT_BENEFIT_RECEIVER18= R1601B8K5,
         QUALITY_CAPACITY_OF_VILLAGE_COMMUNITY_EMPOWERMENT = R1601B9K2,
         SOURCE_OF_FUND19 = R1601B9K3,
         ADMINISTRATOR19= R1601B9K4,
         DIRECT_BENEFIT_RECEIVER19= R1601B9K5,
         ESTABLISHMENT_DEVELOPMENT_VILLAGE_GOV_ENTERPRISE_EMPOWERMENT= R1601B10K2,
         SOURCE_OF_FUND20= R1601B10K3,
         ADMINISTRATOR20= R1601B10K4,
         DIRECT_BENEFIT_RECEIVER20= R1601B10K5,
         VILLAGE_HEAD_EXISTENCE= R1701AK2,
         AGE1= R1701AK3,  
         GENDER1= R1701AK4,  
         HIGHEST_EDUCATION_LEVEL1= R1701AK5, 
         VILLAGE_SECRETARY_EXISTENCE= R1701BK2, 
         AGE2= R1701BK3, 
         GENDER2 = R1701BK4, 
         HIGHEST_EDUCATION_LEVEL2= R1701BK5,
         VILLAGE_SECRETARIAT_TREASURER= R1702A,  
         TECHNICAL_EXECUTOR = R1702B, 
         TERRITORIAL_EXECUTOR= R1702C, 
         VILLAGE_OFFICIALS= R1702D)
```

```{r}
colnames(podes4)
```


```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
#var_meaning1 = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE", "FIGHTS_VILLAGE_SUBDISTRICT", "TOTAL_FIGHT_COMMUNITY_GRP", "FIGHT_COMMUNITY_GRP_DIED", "FIGHT_COMMUNITY_GRP_INJURED", "CAUSE_OF_FIGHT_COMMUNITY_GRP" , "TOTAL_FIGHT_RURAL_COMMUNITY", "FIGHT_RURAL_COMMUNITY_DIED", "FIGHT_RURAL_COMMUNITY_INJURED", "CAUSE_OF_FIGHT_RURAL_COMMUNITY","TOTAL_FIGHT_COMMUNITY_SECURITY_FORCE", "FIGHT_RURAL_COMMUNITY_SECURITY_FORCE_DIED", "FIGHT_RURAL_COMMUNITY_SECURITY_FORCE_INJURED", "CAUSE_OF_FIGHT_RURAL_COMMUNITY_SECURITY_FORCE", "TOTAL_FIGHT_COMMUNITY_GOV_OFF", "FIGHT_RURAL_COMMUNITY_GOV_OFF_DIED", "FIGHT_RURAL_COMMUNITY_GOV_OFF_INJURED", "CAUSE_OF_FIGHT_RURAL_COMMUNITY_GOV_OFF", "TOTAL_FIGHT_STUDENT", "FIGHT_RURAL_STUDENT_DIED", "FIGHT_RURAL_STUDENT_INJURED", "CAUSE_OF_FIGHT_RURAL_STUDENT", "TOTAL_FIGHT_ETHNIC", "FIGHT_RURAL_ETHNIC_DIED", "FIGHT_RURAL_ETHNIC_INJURED", "CAUSE_OF_FIGHT_RURAL_ETHNIC", "TOTAL_FIGHT_OTHERS", "FIGHT_RURAL_OTHERS_DIED", "FIGHT_RURAL_OTHERS_INJURED", "CAUSE_OF_FIGHT_RURAL_OTHERS", "RESOLVED_FIGHT", "RECONCILIATOR", "THEFT", "TREND_THEFT", "ROBBERY", "TREND_ROBBERY", "FRAUD_EMBEZZLEMENT", "TREND_FRAUD_EMBEZZLEMENT", "PERSECUTION", "TREND_PERSECUTION", "ARSON", "TREND_ARSON", "RAPE_CRIME_AGAINST_DECENCY", "TREND_RAPE_CRIME_AGAINST_DECENCY", "DRUG_ABUSE_TRAFFICKING", "TREND_DRUG_ABUSE_TRAFFICKING", "GAMBLING", "TREND_GAMBLING", "MURDER", "TREND_MURDER", "TRAFFICKING", "TREND_TRAFFICKING", "CORRUPTION", "TREND_CORRUPTION", "TYPE_OF_CRIME_MOST", "BUILDING_MAINTENANCE_SECURITY_POST", "ESTABLISHING_SECURITY_GUARD", "RAISING_CIVIL_DEFENSE", "REPORTING_GUEST_STAY_MORE_THAN_24_HOURS", "ACTIVATION_OF_SECURITY_SYSTEM_FROM_CITIZEN_INITIATIVE", "NO_OF_CIVIL_DEFENSE_PROTECTION_PERSONNEL_IN_VILLAGE", "EXISTENCE_OF_POLICE_STATION_OFFICE_VILLAGE", "NUMBER_OF_POLICE_STATION_USED", "NUMBER_OF_POLICE_STATION_NOT_USED", "ESTIMATE_DISTANCE_TO_NEAREST_POLICE_STATION_KM", "CONVENIENCE_TO_REACH_NEAREST_POLICE_STATION", "NO_OF_SUICIDE_VICTIM_ATTEMPTED_SUICIDE_VILLAGE", "CONVENIENCE_TO_STREET_CHILDREN_HANGOUT_LOCATION", "CONVENIENCE_TO_HANGOUT_PLACES_HOMELESS_BEGGAR", "CONVENIENCE_TO_LOCATION_OF_COMMERCIAL_SEX_WORKERS", "AVAILABILITY_OF_VILLAGE_INFORMATION", "USAGE_OF_VILLAGE_FINANCIAL_SYSTEM", "VILLAGE_OWNED_ENTERPRISE_LAND", "VILLAGE_BUILDINGS", "VILLAGE_MARKET", "OTHER_VILLAGE_ASSETS", "VILLAGE_MED_TERM_DEV_PLAN", "PERIOD_OF_RPJM_DEVELOP_YEAR_START", "PERIOD_OF_RPJM_DEVELOP_YEAR_END", "VILLAGE_GOV_WORK_PLAN_2018", "VILLAGE_REGULATION_NUMBER_2017", "NO_OF_HEADMAN_REGULATION_2017", "AVAILABILITY_OF_VILLAGE_COOPERATION_BETWEEN_VILLAGES_2018", "AVAILABILITY_OF_VILLAGE_COOPERATION_WITH_THIRD_PARTIES_2018", "AVAILABILITY_OF_VILLAGE_ASSISTANCE", "TRANSPORTATION_INFRASTRUCTURE_DEVELOPMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "ENERGY_INFRASTRUCTURE", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "INFORMATION_COMMUNICATION_INFRASTRUCTURE", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "SANITATION_INFRASTRUCTURE", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "EDUCATION_CULTURE_HEALTH_INFRASTRUCTURE", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "TRADING_SERVICES_INFRASTRUCTURE", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "FARMING_PRODUCTION_VILLAGE_SMALL_INDUSTRY_INFRASTRUCTURE", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "RECREATION_TOURISM_INFRASTRUCTURE", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "DISASTER_MGMT_ENV_CONSERVATION_INFRASTRUCTURE", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "GOV_SUPPORT_INFRASTRUCTURE", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "EDU_HEALTH_PUBLIC_CULTURE_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "VILLAGE_RESIDENTIAL_NEIGHBOURHOOD_MGMT_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "VILLAGE_TRANSPORTATION_MGMT_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "RENEWABLE_ENERGY_DEVELOPMENT_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "INFORMATION_COMMUNICATION_MGMT_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "AGRI_BASED_PRODUCTIVE_BUSI_NON_AGRI_VILLAGE_SMALL_BUSI_MGMT_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "NATURE_CONSERVE_AWARENESS_DISASTER_MGMT_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "COMMUNITY_ROLE_IMPROVE_VILLAGE_GOVERNANCE_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "QUALITY_CAPACITY_OF_VILLAGE_COMMUNITY_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "ESTABLISHMENT_DEVELOPMENT_VILLAGE_GOV_ENTERPRISE_EMPOWERMENT", "SOURCE_OF_FUND", "ADMINISTRATOR", "DIRECT_BENEFIT_RECEIVER", "VILLAGE_HEAD_EXISTENCE", "AGE", "GENDER", "HIGHEST_EDUCATION_LEVEL", "VILLAGE_SECRETARY_EXISTENCE", "AGE", "GENDER", "HIGHEST_EDUCATION_LEVEL", "VILLAGE_SECRETARIAT_TREASURER", "TECHNICAL_EXECUTOR", "TERRITORIAL_EXECUTOR", "VILLAGE_OFFICIALS")







