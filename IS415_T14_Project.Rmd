---
title: "Team 14: East Kalimantan as the new J-Town"
author: "Team 14, Ng Xun Jie, Erika Aldisa Gunawan, Sean Lee Jun Hui"
date: "9/26/2020 (updated: `r Sys.Date()`)"
output: 
  html_document:
    theme: read
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Overview

Team 14 aims to do profiling & segmentation of the new proposed area of Indonesia's capital city in East Kalimantan province. 

To do this, we will firstly load the necessary R packages to do our analysis. Next, we will load the PODES 2018 data (CSV) and East Kalimantan province shapefile, both received from Professor Kam Tin Seong.

Afterwards, data wrangling to get renamed columns and extra variables is really important because the datasets are in Bahasa Indonesia so some translation by renaming columns will be done.

Lastly, we will conduct **Spatially Constrained Clustering** analysis on the variables selected that are indicators of how well developed a city is. 


# 2. Load/Install necessary R packages

R packages needed:

* sf - for handling simple feature objects

* spdep - for spatial statistical analysis

* rgdal - for handling spatial data

* tmap - for choropleth mapping


* lubridate - for handling date and time data types

* tidyverse - for tidying data (tidyr, purrr, tibble, stringr, forcats, readr, ggplot2 & dplyr)

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
packages = c('sf','spdep','rgdal','tmap','tidyverse', 'cluster', 'NbClust', 'heatmaply', 'corrplot','factoextra', 'lubridate', 'ggpubr')
for (p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p, character.only = T)
}
```


# 3. Importing Data into R

We import shapefile using **readOGR() function** of rgdal package.

Then, we import csv file using **read_csv() function** of readr package (tidyverse).


## 3.1 Importing geospatial data (shapefile)

- Imported as sf data frame
```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=TRUE}
area <- st_read(dsn = "data/geospatial/StudyArea.shp", layer = "StudyArea")
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
glimpse(area)
```

We can see that there are 12 variables whose column names are in Bahasa Indonesia.

* PROVNO - unique ID of the province East Kalimantan

* KABKOTNO - unique ID of regencies/cities

* KECNO - unique ID of districts

* DESANO - unique ID of villages

* PROVINSI - name of **provinces** in East Kalimantan, the highest level of govt. administrative region

* KABKOT - name of **regencies/cities** in East Kalimantan, the second level of govt. administrative region

* KECAMATAN - name of **districts** in East Kalimantan, the third level of govt. administrative region

* DESA - name of **village** in East Kalimantan, the lowest level of govt. administrative region

* IDDESA - unique ID of villages that is the full region code (concatenation of PROVNO, KABKOTNO, KECNO, DESANO)

* TAHUN - year

* SUMBER - source of data, BPS stands for Badan Pusat Statistik, Statistics Indonesia 

* geometry - the coordinates of the geometries polygons

For this project, it's important to learn about the government administrative region of Indonesia. In Indonesia, nationally one country, divided into **34 provinces** which includes East Kalimantan. 

* A **province (provinsi)** is divided into **cities/regencies**

* **Regencies (kabupaten)** are usually larger than cities (kota) in size and have agricultural activities. In East Kalimantan province, there are 3 cities (Balikpapan, Samarinda, Bontang) and 7 regencies

* Regencies and cities are further divided into **districts (kecamatan)**

* The last level of government administrative region is **village (desa)** or **sub-district (kelurahan)**

* Village most often used for regencies & sub-district most often used for cities, just like how regency is more rural than city

## 3.2 Renaming columns of area shapefile

We will rename the columns of "area" into English.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
area <- area %>%
  rename(
    PROVINCE_ID = PROVNO,
    CITY_ID = KABKOTNO,
    DISTRICT_ID = KECNO,
    VILLAGE_ID = DESANO,
    PROVINCE = PROVINSI,
    CITY = KABKOT,
    DISTRICT =KECAMATAN,
    VILLAGE = DESA,
    REGION_CODE = IDDESA,
    YEAR = TAHUN,
    SOURCE = SUMBER,
    GEOMETRY = geometry
  )
```



Let's observe if the area shapefile has any missing/NA values.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=TRUE}
summary(area)
any(is.na(area))
```
We can see that there are no NA values and all variables have the same number of observations. 


## 3.3 Plot of the Study Area

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=TRUE}
tm_shape(area)+
  tm_basemap('OpenStreetMap')+
  tm_polygons("CITY")+
  tm_text("VILLAGE_ID", size = 0.1)+ 
  tm_borders(lwd=0.5)+
  tm_layout(legend.height = 0.50, 
            legend.width = 0.44,
            frame = FALSE) +
  tm_compass(type="8star", size = 2) +
  tm_scale_bar(width = 0.15)
```

Note: The study area does not cover the whole area of East Kalimantan province, only 2 regencies which are Kutai Kartanegara and Penajam Paser Utara & 2 biggest cities in East Kalimantan which are Balikpapan and Samarinda. This is shown below by finding the distinct regencies/cities variable.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
distinct(as.data.frame(area$CITY))
```


## 3.4 Importing aspatial data (PODES 2018 in CSV format)

The PODES 2018 data is divided into 4 parts in CSV format so we will import all 4 CSV files and bind them to one dataframe.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- read_csv("data/aspatial/podes2018_part1.csv")
head(podes1)
```

We can see that the variables of the PODES 2018 data are in codes (R101N, R102, R102N, etc.) which we have to convert based on the information found in the reference of this data. 

However, we will firstly see the other parts of the PODES 2018 data and see if there's some tidying to do.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
glimpse(podes1)
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2 <- read_csv("data/aspatial/podes2018_part2.csv")
#glimpse(podes2)
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes3 <- read_csv("data/aspatial/podes2018_part3.csv")
#glimpse(podes3)
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- read_csv("data/aspatial/podes2018_part4.csv")
#glimpse(podes4)
```

As we can see from the glimpse() function, all the different parts of PODES 2018 dataframe have different number of columns/variable. 

PODES1 has 150 variables, PODES2 has 217 variables, PODES3 has 232 variables and PODES4 has 185 variables. However, we can see **the only overlapping variables are the first 9 variables** namely shape, R101, R101N, R102, R102N, R103, R103N, R104, R104N. 



## 3.5 Deriving column names of combined PODES 2018 dataframe (Data wrangling)

### 3.5.1 PODES 2018 part 1 (general info of village, demographics & employment, housing & living environment)

From the reference data, we can derive the meaning of each variables and we will be doing so in the order of the podes dataframe. Note that some variables need further tidying such as changing type of variable from double to factor. 


What we will be doing now is to either recode the variable or to change the variable values, and we will only be **changing the column name at the end to simplify the process**, we will be keeping a vector of all the variable name in podes1 dataframe and will be setting the column names of the new tidy podes1 data frame with that variable name vector.

Changing variable "R301" - governance status to factor variable by using recode_factor() function of dplyr package.

UTP means Transmigration Settlement Unit & STP means Entity of Transmigration Settlement. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R301 = recode_factor(as.vector(podes1$R301), `1` = "VILLAGE", `2` = "SUBDISTRICT", `3` = "UPT/SPT"))
```


Changing variable "R302A" - village/sub-district council to factor variable. 1 means have and 2 means do not have. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R302A = recode_factor(as.vector(podes1$R302A), `1` = 1, `2` = 0))
```


Changing variable "R303" - village/subdistrict map set by the governor(provincial level) or mayor (city level) to factor variable. 1 means have and 2 means do not have. It will be changed to 1 as yes and 0 as no.
```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R303 = recode_factor(as.vector(podes1$R303), `1` = 1, `2` = 0))
```

Changing variable "R304A" - presence of local units which are smaller level or units of administrative region, below village and subdistrict level. Changing this dbl type to factor type. 1 means have and 2 means do not have. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R304A = recode_factor(as.vector(podes1$R304A), `1` = 1, `2` = 0))
```


Changing variable "R305B" - topography of the village/subdistrict area to  factor variable. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R305B = recode_factor(as.vector(podes1$R305B), `1` = "SLOPE/PEAK", `2` = "VALLEY", `3` = "FLAT"))
```

Changing variable "R305C" - presence of residential areas in slope/peak to  factor variable. 1 means have and 2 means do not have. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R305C = recode_factor(as.vector(podes1$R305C), `1` = 1, `2` = 0))
```



Changing variable "R306A" - presence of village head office. 1 means have and 2 means do not have. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R306A = recode_factor(as.vector(podes1$R306A), `1` = 1, `2` = 0))
```

Changing variable "R306B" - status of village head office, whether they are an asset of the village or not. 1 means yes it's an asset and 2 means not an asset. It will be changed to "ASSET" and "NON-ASSET".

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R306B = recode_factor(as.vector(podes1$R306B), `1` = "ASSET", `2` = "NON-ASSET"))
```

Changing variable "R306C" - condition of village head office, whether they are worthy to have run the office or not. 1 means yes it's deserving/worthy and 2 means not deserving/worthy. It will be changed to "WORTH" and "NOT WORTH".

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R306C = recode_factor(as.vector(podes1$R306C), `1` = "WORTH" , `2` = "NOT WORTH"))
```

Changing variable "R306D" - location of village head office, whether it is located inside or outside the village/sub-district. 1 means it's located inside the area and 2 means located outside the area. It will be changed to "INSIDE" and "OUTSIDE".

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R306D = recode_factor(as.vector(podes1$R306D), `1` = "INSIDE VILLAGE" , `2` = "OUTSIDE VILLAGE"))
```

Changing variable "R307A" - where the governmental activities are executed mainly. 1 means activities are executed in village head office and 2 means activities are not executed in the head offices. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R307A = recode_factor(as.vector(podes1$R307A), `1` = 1 , `2` = 0))
```


Changing variable "R308A" - whether there are any villages/sub-districts that is directly adjacent to the sea. 1 means yes and 2 means no villages/sub-districts that is adjacent to the sea. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R308A = recode_factor(as.vector(podes1$R308A), `1` = 1 , `2` = 0))
```

Changing variable "R308B1A" - does the village/subdistrict adjacent to the sea have benefited in their fishing catches (includes all marine life). 1 means yes and 2 means no. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R308B1A = recode_factor(as.vector(podes1$R308B1A), `1` = 1 , `2` = 0))
```

Changing variable "R308B1B" - does the village/subdistrict adjacent to the sea have benefited in their fish farming/cultivation (includes all marine life). 3 means yes and 4 means no. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R308B1B = recode_factor(as.vector(podes1$R308B1B), `3` = 1 , `4` = 0))
```

Changing variable "R308B1C" - does the village/subdistrict adjacent to the sea have benefited in their salt evaporation pond. 5 means yes and 6 means no. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R308B1C = recode_factor(as.vector(podes1$R308B1C), `5` = 1 , `6` = 0))
```

Changing variable "R308B1D" - does the village/subdistrict adjacent to the sea have benefited in their marine tourism. 7 means yes and 8 means no. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R308B1D = recode_factor(as.vector(podes1$R308B1D), `7` = 1 , `8` = 0))
```

Changing variable "R308B1E" - does the village/subdistrict adjacent to the sea have benefited in improved public transportation. 1 means yes and 2 means no. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R308B1E = recode_factor(as.vector(podes1$R308B1E), `1` = 1 , `2` = 0))
```

Changing variable "R308B2" - presence of any types of mangrove trees. 1 means yes and 2 means no. It will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R308B2 = recode_factor(as.vector(podes1$R308B2), `1` = 1 , `2` = 0))
```


Changing variable "R308B3" - condition of mangrove trees. 1 means good, 2 means partly damaged and 3 means damaged. It will be changed to "GOOD", "BAD", "WORST".

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R308B3 = recode_factor(as.vector(podes1$R308B3), `1` = "GOOD" , `2` = "BAD", `3` = "WORST"))
```

Changing variable "R309A" - village/subdistrict location in proximity to forested areas. 1 means it's located in forested areas, 2 means it's located at the edge or around the forested areas and 3 means it's located outside the area. It will be changed to "INSIDE", "AROUND", "OUTSIDE".

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R309A = recode_factor(as.vector(podes1$R309A), `1` = "INSIDE" , `2` = "AROUND", `3` = "OUTSIDE"))
```


Changing variable "R309B" - forested areas' main function. 1 means conservation, 2 means protection and 3 means production. It will be changed to "CONSERVATION", "PROTECTION", "PRODUCTION".

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R309B = recode_factor(as.vector(podes1$R309B), `1` = "CONSERVATION" , `2` = "PROTECTION", `3` = "PRODUCTION"))
```

Changing variable "R309C" - residents' dependency on the forested area. 1 means high dependency, 2 means medium/average dependency and 3 means low dependency. It will be changed to "HIGH", "MED", "LOW".

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R309C = recode_factor(as.vector(podes1$R309C), `1` = "HIGH" , `2` = "MED", `3` = "LOW"))
```


- demographics & employment

Changing variable "R402A" - if residents of villages/sub-districts are currently working as migrant workers abroad. 1 means have, 2 means do not have and 3 means do not know. It will be changed to "YES", "NO", "NOT SURE".

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R402A = recode_factor(as.vector(podes1$R402A), `1` = "HI" , `2` = "NO", `3` = "NOT SURE"))
```


Changing variable "R402C" - presence of an agent who sends residents abroad to become migrant workers. These agents can be a person, a group or a company. 1 means yes and 2 means no. It will be changed to 1 for yes and 0 for no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R402C = recode_factor(as.vector(podes1$R402C), `1` = 1 , `2` = 0))
```

Changing variable "R403A" - source of main income for the majority of the population of the village/sub-district 
From the reference,

- 1 means agriculture

- 2 means mining and excavation

- 3 means manufacturing/processing of goods such as fabric/handicrafts

- 4 means retail businesses/restaurants

- 5 means transportation/storage/logistics

- 6 means services (legal, moving, tax, electronic repair, salon)

- 7 means Others/Miscellaneous

It will be changed the character string of what the number represents.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R403A = recode_factor(as.vector(podes1$R403A), `1` = "AGRICULTURE" , `2` = "MINING", `3` = "MANUFACTURING", `4` = "RETAIL/RESTAURANTS", `5` = "LOGISTICS", `6` = "SERVICES", `7` = "OTHERS"))
```

Changing variable "R403B" - Type of commodities for majority of village/sub-district 

From the reference,

- 1 means rice

- 2 means secondary staple crop (corn, beans, potatoes, cassava, root vegetables)

- 3 means horticulture (fruits, vegetables, decorative flowers, plant medicine)

- 4 means rubber

- 5 means palm oil

- 6 means coffee

- 7 means cacao

- 8 means coconut

- 9 means pepper

- 10 means clove

- 11 means tobacco

- 12 means sugarcane

- 13 means livestock

- 14 means caught fishes

- 15 means farmed fishes

- 16 means forest resources (such as bamboo, tak and mahogany)

- 17 means forest products (such as honey, fruits and firewood)

- 18 means wild animals (pigs, wild chickens and deer)

- 19 means captive bred animals/plants (crocodile, orchid, arowana fish)

- 20 means farming services (renting machineries or seeding)

It will be changed the character string of what the number represents.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R403B = recode_factor(as.vector(podes1$R403B), `1` = "RICE" , `2` = "SECONDARY STAPLE CROP", `3` = "HORTICULTURE", `4` = "RUBBER", `5` = "PALMOIL", `6` = "COFFEE", `7` = "CACAO", `8` = "COCONUT", `9` = "PEPPER", `10` = "CLOVE", `11` = "TOBACCO", `12` = "SUGARCANE", `13` = "LIVESTOCK", `14` = "CAUGHT FISH", `15` = "FARMED FISH", `16` = "FOREST RESOURCES", `17` = "FOREST PRODUCTS", `18` = "WILD ANIMALS", `19` = "CAPTIVE BRED ANIMALS", `20` = "FARMING SERVICES"))
```


Changing variable "R403C1" - type of available infrastructure from/to the local central production place in the village/sub-district

From the reference,

- 1 means asphalt/concrete

- 2 means hardened rocks (gravel,rocks,etc.)

- 3 means land

- 4 means water

- 5 means others

It will be changed the character string of what the number represents.


```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R403C1 = recode_factor(as.vector(podes1$R403C1), `1` = "CONCRETE" , `2` = "ROCKS", `3` = "LAND", `4` = "WATER", `5` = "OTHERS"))
```

Changing variable "R403C2" - road from/to the local central production place to main road of village/sub-district can be accessed by 4-wheel vehicles

- 1 means accessible all year around

- 2 means accessible all year around except conditions such as heavy rain or currents

- 3 means accessible during dry season only

- 4 means not accessible all year around


It will be changed the character string of what the number represents.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R403C2 = recode_factor(as.vector(podes1$R403C2), `1` = "YES" , `2` = "NO DURING EXTREME WEATHER CONDITIONS",`3` = "DRY SEASON ONLY", `4` = "NO"))
```

Changing variable "R404A" - presence of unique/main product of the village/sub-district. 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R404A = recode_factor(as.vector(podes1$R404A), `1` = 1 , `2` = 0))
```


Changing variable "R404C" - how many unique products are being exported overseas, there's no specific measure for this. 1 means yes, to a large extent. 2 means yes, to a small extent and 3 means no. 

We will change this into character string to better understand it.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R404C = recode_factor(as.vector(podes1$R404C), `1` = "MANY" , `2` = "LITTLE", `3` = "NONE"))
```


- housing & living environment

Changing variable "R502A" - presence of street lighting on the main road of the village/sub-district. 1 means majority has street lighting, 2 means small part and 3 means no lighting.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R502A = recode_factor(as.vector(podes1$R502A), `1` = "MAJORITY" , `2` = "MINORITY", `3` = "NONE"))
```

Changing variable "R502B" - type of street lighting on the main road of the village/sub-district. 1 means government provided electricity, 2 means non-public provided electricity and 3 means no electricity

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% mutate(R502B = recode_factor(as.vector(podes1$R502B), `1` = "GOVT" , `2` = "NON GOVT", `3` = "NO ELECTRICITY"))
```


Changing variable "R503A" - type of fuel used for cooking by households

R503A1 variable - natural gas pipes

R503A2 varible - liquefied petroleum gas (LGP) 3 kg

R503A3 varible - liquefied petroleum gas (LGP) > 3kg
 
R503A4 varible - kerosene

R503A5 varible - firewood

R503A6 varible - others (charcoal, coal, etc.)

From the reference, we will change yes to value of 1 and no to 0.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R503A1 = recode_factor(as.vector(podes1$R503A1), `1` = 1 , `2` = 0)) %>%
  mutate(R503A2 = recode_factor(as.vector(podes1$R503A2), `3` = 1 , `4` = 0)) %>%
  mutate(R503A3 = recode_factor(as.vector(podes1$R503A3), `5` = 1 , `6` = 0)) %>%
  mutate(R503A4 = recode_factor(as.vector(podes1$R503A4), `7` = 1 , `8` = 0)) %>%
  mutate(R503A5 = recode_factor(as.vector(podes1$R503A5), `1` = 1 , `2` = 0)) %>%
  mutate(R503A6 = recode_factor(as.vector(podes1$R503A6), `3` = 1 , `4` = 0)) 
```


Changing variable "R503B" - the type of fuel that is most often used (pick one from the previous variable that is 1 (Yes))
 
```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R503B = recode_factor(as.vector(podes1$R503B), `1` = "GAS PIPES" , `2` = "LPG 3KG", `3` = "LPG >3KG", `4` = "KEROSENE", `5` = "FIREWOOD", `6` = "OTHERS"))
```


For variable "R503C", it's how the households obtain firewood if their most often used fuel is firewood. The choices are: 1 for bought, 2 for forest, 3 for outside forest, 4 for others.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R503C = recode_factor(as.vector(podes1$R503C), `1` = "BOUGHT" , `2` = "FROM FOREST", `3` = "FROM OUTSIDE FOREST", `4` = "OTHERS"))
```

Changing variable "R504" - where families throw their trash

R504A1 variable - trash bin, which will be collected

R504A2 varible - inside a hole or burned

R504A3 varible - river/lake/sea/irrigation channel
 
R504A4 varible - drainage (sewer)

R504A5 varible - others

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R504A1 = recode_factor(as.vector(podes1$R504A1), `1` = 1, `2` = 0)) %>%
  mutate(R504A2 = recode_factor(as.vector(podes1$R504A2), `3` = 1, `4` = 0)) %>%
  mutate(R504A3 = recode_factor(as.vector(podes1$R504A3), `5` = 1, `6` = 0)) %>%
  mutate(R504A4 = recode_factor(as.vector(podes1$R504A4), `7` = 1, `8` = 0)) %>%
  mutate(R504A5 = recode_factor(as.vector(podes1$R504A5), `1` = 1, `2` = 0))
```

Changing variable "R504B" - trash dump/system used most often for the village/sub-district

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R504B = recode_factor(as.vector(podes1$R504B), `1` = "TRASH CAN" , `2` = "BURNED", `3` = "WATER BODY", `4` = "DRAINAGE", `5` = "OTHERS"))
```

Changing variable "R504C" - presence and use of temporary garbage/trash dump/system used to store the garbage before being taken away to a facility processing center 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R504C = recode_factor(as.vector(podes1$R504C), `1` = "YES, USED" , `2` = "YES, NOT USED", `3` = "NO"))
```

Changing variable "R505A" - use of toilet facilities for families in villages/sub-districts

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R505A = recode_factor(as.vector(podes1$R505A), `1` = "OWN TOILET" , `2` = "SHARED TOILET", `3` = "PUBLIC TOILET", `4` = "NOT TOILET"))
```

Changing variable "R505B" - the final disposal site of the toilet

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R505B = recode_factor(as.vector(podes1$R505B), `1` = "WASTEWATER TREATMENT TANKS" , `2` = "NATURE", `3` = "GROUND HOLE", `4` = "OTHERS"))
```

Changing variable "R506" - the place/channel for liquid sewage disposal from bath/washed water

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R506 = recode_factor(as.vector(podes1$R506), `1` = "INFILTRATION HOLES" , `2` = "DRAINAGE", `3` = "WATERBODY", `4` = "OPEN GROUND", `5` = "OTHERS"))
```

Changing variable "R507A" - source of drinking water for the families

Changing variable "R507B" - souce of water for purpose of bathing and washing for the families

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R507A = recode_factor(as.vector(podes1$R507A), `1` = "BRANDED BOTTLED WATER" , `2` = "REFILLABLE DISPENSER WATER", `3` = "TAP WITH METER", `4` = "TAP W/O METER", `5` = "PUMP", `6` = "WELL", `7` = "WATER SPRING", `8` = "WATER RESERVOIR", `9` = "RAIN WATER", `10` = "OTHERS")) %>%
  mutate(R507B = recode_factor(as.vector(podes1$R507B), `1` = "BRANDED BOTTLED WATER" , `2` = "REFILLABLE DISPENSER WATER", `3` = "TAP WITH METER", `4` = "TAP W/O METER", `5` = "PUMP", `6` = "WELL", `7` = "WATER SPRING", `8` = "WATER RESERVOIR", `9` = "RAIN WATER", `10` = "OTHERS"))
```


Changing variable "R508A" -  whether the village is passed through by the Extra High Voltage Power Line (SUTET), the High Voltage Power Line (SUTT),
High Voltage Power Line with direct current (SUTTAS)

Changing variable "R508B" - presence of settlement under the power lines (SUTET, SUTT, SUTTAS)

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R508A = recode_factor(as.vector(podes1$R508A), `1` = 1 , `2` = 0)) %>%
  mutate(R508B = recode_factor(as.vector(podes1$R508B), `1` = 1 , `2` = 0))
```

Changing variable "R509A" - presence of river, irrigation channel, lake, dam, reservoir, and retention basin

R509AK2 variable - presence of river

R509AK3 variable - presence of irrigation channel

R509AK4 variable - presence of lake/reservoir/dam

R509AK5 variable - presence of retention basin

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509AK2 = recode_factor(as.vector(podes1$R509AK2), `1` = 1 , `2` = 0)) %>%
  mutate(R509AK3 = recode_factor(as.vector(podes1$R509AK3), `1` = 1 , `2` = 0)) %>%
  mutate(R509AK4 = recode_factor(as.vector(podes1$R509AK4), `1` = 1 , `2` = 0)) %>%
  mutate(R509AK5 = recode_factor(as.vector(podes1$R509AK5), `1` = 1 , `2` = 0))
```


Changing variable "R509B1" - presence of different water bodies for the purpose of **bathing and washing**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B1K2 = recode_factor(as.vector(podes1$R509B1K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B1K3 = recode_factor(as.vector(podes1$R509B1K3), `1` = 1 , `2` = 0)) %>%
  mutate(R509B1K4 = recode_factor(as.vector(podes1$R509B1K4), `1` = 1 , `2` = 0)) %>%
  mutate(R509B1K5 = recode_factor(as.vector(podes1$R509B1K5), `1` = 1 , `2` = 0))
```


Changing variable "R509B2" - presence of different water bodies for the purpose of **drinking water and cooking**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B2K2 = recode_factor(as.vector(podes1$R509B2K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B2K3 = recode_factor(as.vector(podes1$R509B2K3), `1` = 1 , `2` = 0)) %>%
  mutate(R509B2K4 = recode_factor(as.vector(podes1$R509B2K4), `1` = 1 , `2` = 0)) %>%
  mutate(R509B2K5 = recode_factor(as.vector(podes1$R509B2K5), `1` = 1 , `2` = 0))
```


Changing variable "R509B3" - presence of different water bodies for the purpose of **raw drinking water**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B3K2 = recode_factor(as.vector(podes1$R509B3K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B3K3 = recode_factor(as.vector(podes1$R509B3K3), `1` = 1 , `2` = 0)) %>%
  mutate(R509B3K4 = recode_factor(as.vector(podes1$R509B3K4), `1` = 1 , `2` = 0)) %>%
  mutate(R509B3K5 = recode_factor(as.vector(podes1$R509B3K5), `1` = 1 , `2` = 0))
```


Changing variable "R509B4" - presence of different water bodies for the purpose of **irrigation**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B4K2 = recode_factor(as.vector(podes1$R509B4K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B4K3 = recode_factor(as.vector(podes1$R509B4K3), `1` = 1 , `2` = 0)) %>%
  mutate(R509B4K4 = recode_factor(as.vector(podes1$R509B4K4), `1` = 1 , `2` = 0)) %>%
  mutate(R509B4K5 = recode_factor(as.vector(podes1$R509B4K5), `1` = 1 , `2` = 0))
```


Changing variable "R509B5" - presence of different water bodies for the purpose of **tourism (commercial)**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B5K2 = recode_factor(as.vector(podes1$R509B5K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B5K3 = recode_factor(as.vector(podes1$R509B5K3), `1` = 1 , `2` = 0)) %>%
  mutate(R509B5K4 = recode_factor(as.vector(podes1$R509B5K4), `1` = 1 , `2` = 0)) %>%
  mutate(R509B5K5 = recode_factor(as.vector(podes1$R509B5K5), `1` = 1 , `2` = 0))
```

Changing variable "R509B6" - presence of different water bodies for the purpose of **fishing/fishery**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B6K2 = recode_factor(as.vector(podes1$R509B6K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B6K3 = recode_factor(as.vector(podes1$R509B6K3), `1` = 1 , `2` = 0)) %>%
  mutate(R509B6K4 = recode_factor(as.vector(podes1$R509B6K4), `1` = 1 , `2` = 0)) %>%
  mutate(R509B6K5 = recode_factor(as.vector(podes1$R509B6K5), `1` = 1 , `2` = 0))
```

Changing variable "R509B7" - presence of different water bodies for the purpose of **transportation**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B7K2 = recode_factor(as.vector(podes1$R509B7K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B7K3 = recode_factor(as.vector(podes1$R509B7K3), `1` = 1 , `2` = 0)) %>%
  mutate(R509B7K4 = recode_factor(as.vector(podes1$R509B7K4), `1` = 1 , `2` = 0))
```

Changing variable "R509B8" - presence of different water bodies for the purpose of **power plants**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B8K2 = recode_factor(as.vector(podes1$R509B8K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B8K3 = recode_factor(as.vector(podes1$R509B8K3), `1` = 1 , `2` = 0)) %>%
  mutate(R509B8K4 = recode_factor(as.vector(podes1$R509B8K4), `1` = 1 , `2` = 0)) %>%
  mutate(R509B8K5 = recode_factor(as.vector(podes1$R509B8K5), `1` = 1 , `2` = 0))
```

Changing variable "R509B9" - presence of different water bodies for the purpose of **industrial factories**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B9K2 = recode_factor(as.vector(podes1$R509B9K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B9K4 = recode_factor(as.vector(podes1$R509B9K4), `1` = 1 , `2` = 0)) %>%
  mutate(R509B9K5 = recode_factor(as.vector(podes1$R509B9K5), `1` = 1 , `2` = 0))
```

Changing variable "R509B10" - presence of different water bodies for the purpose of **other matters**

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R509B10K2 = recode_factor(as.vector(podes1$R509B10K2), `1` = 1 , `2` = 0)) %>%
  mutate(R509B10K4 = recode_factor(as.vector(podes1$R509B10K4), `1` = 1 , `2` = 0)) %>%
  mutate(R509B10K5 = recode_factor(as.vector(podes1$R509B10K5), `1` = 1 , `2` = 0))
```

Changing variable "R510B" - presence of settlements in river banks

1 means yes and 2 means no so we will change it to 1 means yes and 0 means no

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R510B = recode_factor(as.vector(podes1$R510B), `1` = 1 , `2` = 0))
```


Changing variable "R510D1" - whether the river water is contaminated with waste

1 means yes and 2 means no so we will change it to 1 means yes and 0 means no

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R510D1 = recode_factor(as.vector(podes1$R510D1), `1` = 1 , `2` = 0))
```

Changing variable "R510D2" - where does the waste that contaminated the river come from

R510D2A variable - industrial 

R510D2B variable - household 

R510D2C variable - others

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R510D2A = recode_factor(as.vector(podes1$R510D2A), `1` = 1 , `2` = 0)) %>%
  mutate(R510D2B = recode_factor(as.vector(podes1$R510D2B), `3` = 1 , `4` = 0)) %>%
  mutate(R510D2C = recode_factor(as.vector(podes1$R510D2C), `5` = 1 , `6` = 0))
```

Changing variable "R510D3" - where is the source of waste located

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R510D3 = recode_factor(as.vector(podes1$R510D3), `1` = "INSIDE VILLAGE" , `2` = "OUTSIDE VILLAGE", `3` = "INSIDE & OUTSIDE VILLAGE"))
```


Changing variable "R511A" - the presence of water springs in the village/sub-district

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R511A = recode_factor(as.vector(podes1$R511A), `1` = "YES, MANAGED" , `2` = "YES, NOT MANAGED", `3` = "NO"))
```


Changing variable "R512A" - presence of slums (unsanitary environment, dense buildings, etc.)

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>% 
  mutate(R512A = recode_factor(as.vector(podes1$R512A), `1` = 1 , `2` = 0))
```

Changing variable "R513A" - environmental **water pollution** in the village/sub-district last year

R513AK2 variable - incident of water pollution

R513AK3 variable - If there's an incident, the source of the water pollution

R513ALK3 variable - the name of the pollution source

R513AK4 variable - complaint filed to the village head

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>%
  mutate(R513AK2 = recode_factor(as.vector(podes1$R513AK2), `1` = 1, `2` =0)) %>%
  mutate(R513AK3 = recode_factor(as.vector(podes1$R513AK3), `1` = "HOUSEHOLD", `2` ="INDUSTRIAL", `3` = "OTHERS")) %>%
  mutate(R513AK4 = recode_factor(as.vector(podes1$R513AK4), `1` = 1, `2` = 0))
```

Changing variable "R513B" - environmental **land pollution** in the village/sub-district last year, the variables are the same as R513A above

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>%
  mutate(R513BK2 = recode_factor(as.vector(podes1$R513BK2), `1` = 1, `2` =0)) %>%
  mutate(R513BK3 = recode_factor(as.vector(podes1$R513BK3), `1` = "HOUSEHOLD", `2` ="INDUSTRIAL", `3` = "OTHERS")) %>%
  mutate(R513BK4 = recode_factor(as.vector(podes1$R513BK4), `1` = 1, `2` = 0))
```


Changing variable "R513C" - environmental **air pollution** in the village/sub-district last year, the variables are the same as R513A above

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>%
  mutate(R513CK2 = recode_factor(as.vector(podes1$R513CK2), `1` = 1, `2` =0)) %>%
  mutate(R513CK3 = recode_factor(as.vector(podes1$R513CK3), `1` = "HOUSEHOLD", `2` ="INDUSTRIAL", `3` = "OTHERS")) %>%
  mutate(R513CK4 = recode_factor(as.vector(podes1$R513CK4), `1` = 1, `2` = 0))
```

Changing variable "R514" - presence of environmental conservation and waste processing activities over the last 3 years

R514A variable - planting of trees, mangrove plantation, etc.

R514B variable - processing/recycling waste

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>%
  mutate(R514A = recode_factor(as.vector(podes1$R514A), `1` = "YES WITH CITIZENS", `2` = "YES W/O CITIZENS", `3` = "NO")) %>%
  mutate(R514B = recode_factor(as.vector(podes1$R514B), `1` = "YES WITH CITIZENS", `2` = "YES W/O CITIZENS", `3` = "NO"))
```

Changing variable "R515" - the tendency/habits of citizens to slash and burn the land/forest for farming

We will be deselecting/removing variable R516, the location of mining for sand and clay, because it is not relevant

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1 <- podes1 %>%
  mutate(R515 = recode_factor(as.vector(podes1$R515), `1` = 1, `2` =0)) %>%
  select(-R516)
```

`var_meaning1` is the vector of column names of podes1 dataframe.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
var_meaning1 = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE", "VILLAGE/SUBDISTRICT", "PRESENCE_VILLAGE/SUBDISTRICT_COUNCIL", "COUNCIL_MEMBER_NUM", "COUNCIL_ACTIVITY_2017", "VILLAGE/SUBDISTRICT_MAP",
"PRESENCE_LOCAL_UNITS", "LOCAL_UNITS_LEVEL", "LOCAL_UNITS_NUM", 
"VILLAGE/SUBDISTRICT_BY_AREA_IN_ISLAND", "VILLAGE/SUBDISTRICT_BY_TOPOGRAPHY", "PRESENCE_RESIDENTIALAREAS_IN_SLOPE/PEAK",
"PRESENCE_VILLAGE_HEAD_OFFICE", "STATUS_HEAD_OFFICE", "CONDITION_HEAD_OFFICE", "LOCATION_HEAD_OFFICE", "ACTIVITY_EXECUTION_IN_HEAD_OFFICE", 
"VILLAGE_ADJACENT_TO_SEA", "SEA_BENEFIT_FISHING", "SEA_BENEFIT_FISH_FARMING", "SEA_BENEFIT_SALTPOND", "SEA_BENEFIT_MARINE_TOURISM", "SEA_BENEFIT_PUBLIC_TRANSPORTATION", 
"PRESENCE_MANGROVE_TREES", "CONDITION_MANGROVE_TREES", "VILLAGE_LOCATION_TO_FOREST", "FOREST_FUNCTION", "DEPENDENCY_ON_FOREST",
"PRESENCE_MIGRANT_WORKERS(TKI)", "MALE_MIGRANT_WORKERS", "FEMALE_MIGRANT_WORKERS", "PRESENCE_MIGRANT_WORKERS_AGENT", 
"VILLAGE_MAIN_INCOME", "TYPE_OF_COMMODITIES", "INFRASTRUCTURE_FROM_PRODUCTION_PLACE_TO_VILLAGE", "ACCESSIBLE_ROAD_FROM_PRODUCTION_PLACE_TO_VILLAGE", 
"UNIQUE_PRODUCT_VILLAGE", "FOOD_UNIQUE_PRODUCT", "NON_FOOD_UNIQUE_PRODUCT", "UNIQUE_PRODUCTS_EXPORTED", 
"HOUSEHOLDS_PLN_ELECTRICITY", "HOUSEHOLDS_NONPLN_ELECTRICITY", "HOUSEHOLDS_NO_ELECTRICITY", "STREET_LIGHTING", "ELECTRICTY_PROVIDER", 
"FUEL_GAS_PIPES", "FUEL_LPG3KG", "FUEL_LPG>3KG", "FUEL_KEROSENE", "FUEL_FIREWOOD", "FUEL_OTHERS", "FUEL_USED_OFTEN", "OBTAIN_FIREWOOD",
"TRASH_BIN", "TRASH_BURNED", "TRASH_DUMPED_WATERBODY", "TRASH_DRAINAGE", "TRASH_OTHERS", "TRASH_DUMP_USED_OFTEN", "PRESENCE_GARBAGE_DUMP", 
"TOILET_FACILITIES", "TOILET_DISPOSAL_SITE", "LIQUID_SEWAGE_CHANNEL", "SOURCE_DRINKING_WATER", "SOURCE_BATH_WATER", 
"PRESENCE_POWER_LINES", "SETTLEMENT_UNDER_POWER_LINES", "NUM_OF_POWER_LINES", "NUM_OF_HOUSES", "NUM_OF_FAMILIES", 
"PRESENCE_RIVER", "PRESENCE_IRRIGATIONCHANNEL", "PRESENCE_RESERVOIR", "PRESENCE_BASIN",
"RIVER_BATH_WATER", "IRGN_BATH_WATER", "RSRV_BATH_WATER", "BASIN_BATH_WATER", 
"RIVER_DRINK_WATER", "IRGN_DRINK_WATER", "RSRV_DRINK_WATER", "BASIN_DRINK_WATER",
"RIVER_RAW_WATER", "IRGN_RAW_WATER", "RSRV_RAW_WATER", "BASIN_RAW_WATER", 
"RIVER_IRRIGATION_WATER", "IRGN_IRRIGATION_WATER", "RSRV_IRRIGATION_WATER", "BASIN_IRRIGATION_WATER", 
"RIVER_TOURISM", "IRGN_TOURISM", "RSRV_TOURISM", "BASIN_TOURISM",
"RIVER_FISHING", "IRGN_FISHING", "RSRV_FISHING", "BASIN_FISHING", 
"RIVER_TRANSPORTATION", "IRGN_TRANSPORTATION", "RSRV_TRANSPORTATION",  
"RIVER_POWERPLANT", "IRGN_POWERPLANT", "RSRV_POWERPLANT", "BASIN_POWERPLANT", 
"RIVER_INDUSTRIAL", "RSRV_INDUSTRIAL", "BASIN_INDUSTRIAL", 
"RIVER_OTHERS", "RSRV_OTHERS", "BASIN_OTHERS", 
"SETTLEMENT_IN_RIVERBANKS", 
"NUM_SETTLEMENTS_RIVERBANKS", "NUM_HOUSES_RIVERBANKS", "NUM_FAMILIES_RIVERBANKS",
"RIVER_CONTAMINATION", "RIVER_INDUSTRIAL_CONTAMINATION", "RIVER_HOUSEHOLD_CONTAMINATION", "RIVER_OTHER_CONTAMINATION", "SOURCE_RIVER_WASTE", 
"PRESENCE_WATERSPRINGS", "NO_OF_BASIN", "PRESENCE_SLUMS", "NUM_OF_SLUMS", "NUM_OF_BUILDING_SLUMS", "NUM_OF_FAMILY_SLUMS", 
"WATER_POLUTTION_INCIDENT", "SOUCE_WATER_POLLUTION", "WP_SOURCE_NAME", "WATER_POLLUTION_COMPLAINT", 
"LAND_POLLUTION_INCIDENT", "SOURCE_LAND_POLLUTION",  "LP_SOURCE_NAME", "LAND_POLLUTION_COMPLAINT", 
"AIR_POLLUTION_INCIDENT", "SOURCE_AIR_POLLUTION",  "AP_SOURCE_NAME", "AIR_POLLUTION_COMPLAINT", 
"PLANTING_ENVIRONMENTAL_CONSERVATION", "RECYCLE_ENVIRONMENTAL_CONSERVATION", "SLASH_AND_BURN")
```


Now, let's rename the column names of podes1 with the column names vector `var_meaning1`.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
colnames(podes1) <- var_meaning1
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
head(podes1)
```

Now, let's select only **the relevant variables** that we will be using for our analysis. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes1_final <- podes1 %>%
  select("SHAPE", 
         "PROVINCE_ID", 
         "PROVINCE", 
         "CITY_ID", 
         "CITY", 
         "DISTRICT_ID", 
         "DISTRICT", 
         "VILLAGE_ID", 
         "VILLAGE", 
         "VILLAGE/SUBDISTRICT", 
         "PRESENCE_VILLAGE/SUBDISTRICT_COUNCIL", 
         # "COUNCIL_MEMBER_NUM", 
         # "PRESENCE_VILLAGE_HEAD_OFFICE", 
         # "STATUS_HEAD_OFFICE", 
         # "CONDITION_HEAD_OFFICE", 
         "VILLAGE/SUBDISTRICT_BY_AREA_IN_ISLAND",
         # "VILLAGE/SUBDISTRICT_BY_TOPOGRAPHY", 
         "VILLAGE_ADJACENT_TO_SEA", 
         "SEA_BENEFIT_FISHING", 
         "SEA_BENEFIT_FISH_FARMING", 
         "SEA_BENEFIT_SALTPOND", 
         "SEA_BENEFIT_MARINE_TOURISM", 
         "SEA_BENEFIT_PUBLIC_TRANSPORTATION", 
         "PRESENCE_MANGROVE_TREES", 
         # "CONDITION_MANGROVE_TREES", 
         "VILLAGE_LOCATION_TO_FOREST", 
         "FOREST_FUNCTION", 
         "DEPENDENCY_ON_FOREST", 
         "VILLAGE_MAIN_INCOME", 
         "STREET_LIGHTING", 
         "ELECTRICTY_PROVIDER", 
         "FUEL_USED_OFTEN", 
         "TRASH_DUMP_USED_OFTEN", 
         "TOILET_FACILITIES", 
         "TOILET_DISPOSAL_SITE",
         "PRESENCE_POWER_LINES", 
         "PRESENCE_RIVER", 
         "PRESENCE_IRRIGATIONCHANNEL", 
         "PRESENCE_RESERVOIR", 
         "PRESENCE_BASIN", 
         "PRESENCE_SLUMS", 
         "NUM_OF_SLUMS", 
         # "WATER_POLUTTION_INCIDENT", 
         # "SOUCE_WATER_POLLUTION", 
         # "LAND_POLLUTION_INCIDENT", 
         # "SOURCE_LAND_POLLUTION", 
         # "AIR_POLLUTION_INCIDENT", 
         # "SOURCE_AIR_POLLUTION", 
         "SLASH_AND_BURN"
         )

podes1_final %>%
  arrange(desc(`VILLAGE/SUBDISTRICT_BY_AREA_IN_ISLAND`))
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
summary(podes1_final)
```

From this summary, we can learn a lot of things about East Kalimantan, here are some of the observations:

- There are more villages (223) than sub-districts (161) in East Kalimantan

- There is 1 sub-district called Muara Kembang that consists of 11 islands

- 20% of the villages/sub-districts are adjacent to the sea, and mostly benefits them in fishing and fish-farming

- The main income of these villages/sub-districts are from agriculture and retail, indicating under developed economy 

- The villages/sub-districts are lacking in street lighting and power lines, and most of their electricity is provided by the government

- The most prominent pollution is water pollution caused by industrial activities


### 3.5.2 PODES 2018 part 2 (natural disaster incidence & mitigation, education and health)

Let's take a look at the podes2 data frame before we tidy the data by recoding the values and renaming the columns.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
glimpse(podes2)
```

- natural disaster & mitigation

Changing variable "R601AK" - all the variables related to **mud slides** that happened in the last 3 years

R601AK2 variable - presence of mud slides incident or not in the villages

R601AK3 variable - number of mud slides incidents in 2015

R601AK4 variable - number of casualties in 2015

R601AK5 variable - number of mud slides incidents in 2016

R601AK6 variable - number of casualties in 2016

R601AK7 variable - number of mud slides incidents in 2017

R601AK8 variable - number of casualties in 2017

This goes the same for all the variables until "R601JK" which is all the variables related to **drought** in the last 3 years

We will only be recoding the value of variables which ends with K2 because for that variable, 1 means yes there's an incident and 2 means no accident, which we will change 1 to 1 and 2 to 0.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2 <- podes2 %>% mutate(R601AK2 = recode_factor(as.vector(podes2$R601AK2), `1` = 1, `2` = 0)) %>%
  mutate(R601BK2 = recode_factor(as.vector(podes2$R601BK2), `1` = 1, `2` = 0)) %>%
  mutate(R601CK2 = recode_factor(as.vector(podes2$R601CK2), `1` = 1, `2` = 0)) %>%
  mutate(R601DK2 = recode_factor(as.vector(podes2$R601DK2), `1` = 1, `2` = 0)) %>%
  mutate(R601EK2 = recode_factor(as.vector(podes2$R601EK2), `1` = 1, `2` = 0)) %>%
  mutate(R601FK2 = recode_factor(as.vector(podes2$R601FK2), `1` = 1, `2` = 0)) %>%
  mutate(R601GK2 = recode_factor(as.vector(podes2$R601GK2), `1` = 1, `2` = 0)) %>%
  mutate(R601HK2 = recode_factor(as.vector(podes2$R601HK2), `1` = 1, `2` = 0)) %>%
  mutate(R601IK2 = recode_factor(as.vector(podes2$R601IK2), `1` = 1, `2` = 0)) %>%
  mutate(R601JK2 = recode_factor(as.vector(podes2$R601JK2), `1` = 1, `2` = 0))
```


Changing variable "R602" - facilities and mitigation efforts for natural disasters in the village/sub-district

R602A variable - presence of early natural disaster warning system

R602B variable - presence of early tsunami warning system

R602C variable - presence of safety equipment such as inflatable boat, tents and masks

R602D variable - presence of evacuation routes and signs

R602E variable - presence of construction, maintenance or normalization of rivers, canals, embankments, ditches, drainage, reservoir, coast, etc.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2 <- podes2 %>% mutate(R602A = recode_factor(as.vector(podes2$R602A), `1` = 1, `2` = 0)) %>%
  mutate(R602B = recode_factor(as.vector(podes2$R602B), `3` = 1, `4` = 0)) %>%
  mutate(R602C = recode_factor(as.vector(podes2$R602C), `5` = 1, `6` = 0)) %>%
  mutate(R602D = recode_factor(as.vector(podes2$R602D), `7` = 1, `8` = 0)) %>%
  mutate(R602E = recode_factor(as.vector(podes2$R602E), `1` = 1, `2` = 0)) 
```



- education and health

Changing variable "R701" - presence of **education facilities** according to the level of education in the village/sub-district 

R701AK variable - early childhood education (Pos PAUD) level

R701B variable - kindergarten level

R701C variable - primary school

R701D variable - middle school

R701E variable - high school

R701F variable - polytechnic high school

R701G variable - academy/college

R701H variable - special needs primary school 

R701I variable - special needs middle school

R701J variable - special needs high school

R701K variable - islamic boarding school 

R701L variable - seconday islamic school

R701M variable - seminary, school of theology

For this variable, there are 4 columns for each 701 variable, namely the number of private institutions, number of public institutions, distance to the nearest education facility and the convenience to reach the nearest education facility. 
 
We will only recode the convenience level to reach the nearest education facility variable as it's discrete value and the rest are continuous variables.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2 <- podes2 %>% mutate(R701AK5 = recode_factor(as.vector(podes2$R701AK5), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R701BK5 = recode_factor(as.vector(podes2$R701BK5), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R701CK5 = recode_factor(as.vector(podes2$R701CK5), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R701DK5 = recode_factor(as.vector(podes2$R701DK5), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R701EK5 = recode_factor(as.vector(podes2$R701EK5), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R701FK5 = recode_factor(as.vector(podes2$R701FK5), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R701GK5 = recode_factor(as.vector(podes2$R701GK5), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) 
```


Changing variable "R702" - variables related to **education**

R702A variable - illiteracy eradication activity in the last 3 years

R702B variable - package A/B/C education activities in the last 1 year (these are non-formal education that allows students out of age range to study the syllabus)

R702C variable - play group/ kindergarten

R702D variable - childcare park (TPA)

R702E variable - Qur'an education park

R702F variable - public reading park

We will be changing all the yes to 1 and no to 0 for standardization.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2 <- podes2 %>% mutate(R702A = recode_factor(as.vector(podes2$R702A), `1` = 1, `2` = 0)) %>%
  mutate(R702B = recode_factor(as.vector(podes2$R702B), `3` = 1, `4` = 0)) %>%
  mutate(R702C = recode_factor(as.vector(podes2$R702C), `5` = 1, `6` = 0)) %>%
  mutate(R702D = recode_factor(as.vector(podes2$R702D), `7` = 1, `8` = 0)) %>%
  mutate(R702E = recode_factor(as.vector(podes2$R702E), `1` = 1, `2` = 0)) %>%
  mutate(R702F = recode_factor(as.vector(podes2$R702F), `3` = 1, `4` = 0))
```


We will be deselecting one of the variable of variable "R703" which is the **other skills education** by the village or not by the village. The other skill is not specified in name so it's not relevant to the data and will not value-add.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2 <- podes2 %>%
  select(-c(R703GK2,R703GK3))
```


Changing variable "R704" - presence of **health facilities** in the village/sub-district

R704A variable - hospital

R704B variable - maternity hospital

R704C variable - public health clinic with inpatient care

R704D variable - public health clinic with inpatient care with outpatient care

R704E variable - seconday public health clinic

R704F variable - polyclinic/medical hall

R704G variable - general practitioner (GP)

R704H variable - maternity clinic

R704I variable - midwife practitioner

R704J variable - village health post

R704K variable - village maternity hut

R704L variable - pharmacy

R704M variable - drugstore

For this variable, there are 3 columns for each 704 variable, namely the number of that type of health facility in the village, distance to the nearest health facility and the convenience to go to the nearest health facility.
 
We will only recode the convenience level to reach the nearest health facility variable as it's discrete value and the rest are continuous variables.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2 <- podes2 %>% mutate(R704AK4 = recode_factor(as.vector(podes2$R704AK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704BK4 = recode_factor(as.vector(podes2$R704BK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704CK4 = recode_factor(as.vector(podes2$R704CK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704DK4 = recode_factor(as.vector(podes2$R704DK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704EK4 = recode_factor(as.vector(podes2$R704EK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704FK4 = recode_factor(as.vector(podes2$R704FK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704GK4 = recode_factor(as.vector(podes2$R704GK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704HK4 = recode_factor(as.vector(podes2$R704HK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704IK4 = recode_factor(as.vector(podes2$R704IK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704JK4 = recode_factor(as.vector(podes2$R704JK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704KK4 = recode_factor(as.vector(podes2$R704KK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704LK4 = recode_factor(as.vector(podes2$R704LK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) %>%
  mutate(R704MK4 = recode_factor(as.vector(podes2$R704MK4), `1` = "VERY EASY", `2` = "EASY", `3` = "HARD", `4` = "VERY HARD")) 
```


Changing variable "R707" - presence of village midwife, it will be changed to 1 as yes and 0 as no.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2 <- podes2 %>% mutate(R707 = recode_factor(as.vector(podes2$R707), `1` = 1, `2` = 0))
```


Changing variable "R709" - **extraordinary events** (KLB - Kejadian luar biasa) or **disease outbreaks** in the last year, for one of the column presence of such outbreaks/events to be 1 if yes and 0 if no. The rest of the variables are continuous variables and we do not need to recode them.

R709A variable - Vomiting and Diarrhea

R709B variable - Dengue fever 

R709C variable - Measles

R709D variable - Malaria

R709E variable - SARS/Bird Flu

R709F variable - Hepatitis E

R709G variable - Diphtheria

Next, we will deselect R709H variable because it does not specify what the disease outbreak/event is so it will not value-add our analysis.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2 <- podes2 %>% mutate(R709AK2 = recode_factor(as.vector(podes2$R709AK2), `1` = 1, `2` = 0)) %>%
  mutate(R709BK2 = recode_factor(as.vector(podes2$R709BK2), `1` = 1, `2` = 0)) %>%
  mutate(R709CK2 = recode_factor(as.vector(podes2$R709CK2), `1` = 1, `2` = 0)) %>%
  mutate(R709DK2 = recode_factor(as.vector(podes2$R709DK2), `1` = 1, `2` = 0)) %>%
  mutate(R709EK2 = recode_factor(as.vector(podes2$R709EK2), `1` = 1, `2` = 0)) %>%
  mutate(R709FK2 = recode_factor(as.vector(podes2$R709FK2), `1` = 1, `2` = 0)) %>%
  mutate(R709GK2 = recode_factor(as.vector(podes2$R709GK2), `1` = 1, `2` = 0)) %>%
  select(-c(R709HK2, R709HK3, R709HK4))
```

`var_meaning2` is the vector of column names of podes2 dataframe.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
var_meaning2 = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE", 
"PRESENCE_MUDSLIDES", "2015_MUDSLIDES", "2015_MUDSLIDES_CASUALTIES", "2016_MUDSLIDES", "2016_MUDSLIDES_CASUALTIES", 
"2017_MUDSLIDES", "2017_MUDSLIDES_CASUALTIES", "2017_FLOOD", "2017_FLOOD_CASUALTIES", 
"PRESENCE_FLOOD", "2015_FLOOD", "2015_FLOOD_CASUALTIES", "2016_FLOOD", "2016_FLOOD_CASUALTIES", 
"PRESENCE_FLASHFLOOD", "2015_FLASHFLOOD", "2015_FLASHFLOOD_CASUALTIES", "2016_FLASHFLOOD", "2016_FLASHFLOOD_CASUALTIES", 
"2017_FLASHFLOOD", "2017_FLASHFLOOD_CASUALTIES", "PRESENCE_EARTHQUAKE", "2015_EARTHQUAKE", "2015_EARTHQUAKE_CASUALTIES", 
"2016_EARTHQUAKE", "2016_EARTHQUAKE_CASUALTIES", "2017_EARTHQUAKE", "2017_EARTHQUAKE_CASUALTIES", "PRESENCE_TSUNAMI", 
"2015_TSUNAMI", "2015_TSUNAMI_CASUALTIES", "2016_TSUNAMI", "2016_TSUNAMI_CASUALTIES", "2017_TSUNAMI", "2017_TSUNAMI_CASUALTIES", 
"PRESENCE_TIDALWAVES", "2015_TIDALWAVES", "2015_TIDALWAVES_CASUALTIES", "2016_TIDALWAVES", "2016_TIDALWAVES_CASUALTIES", 
"2017_TIDALWAVES", "2017_TIDALWAVES_CASUALTIES", "PRESENCE_TORNADO", "2015_TORNADO", "2015_TORNADO_CASUALTIES", 
"2016_TORNADO", "2016_TORNADO_CASUALTIES", "2017_TORNADO", "2017_TORNADO_CASUALTIES", "PRESENCE_VOLCANIC_ERUPTIONS", 
"2015_VOLCANIC_ERUPTIONS", "2015_VOLCANIC_ERUPTIONS_CASUALTIES", "2016_VOLCANIC_ERUPTIONS", "2016_VOLCANIC_ERUPTIONS_CASUALTIES", 
"2017_VOLCANIC_ERUPTIONS", "2017_VOLCANIC_ERUPTIONS_CASUALTIES", "PRESENCE_FORESTFIRE", "2015_FORESTFIRE", 
"2015_FORESTFIRE_CASUALTIES", "2016_FORESTFIRE", "2016_FORESTFIRE_CASUALTIES", "2017_FORESTFIRE", "2017_FORESTFIRE_CASUALTIES", 
"PRESENCE_DROUGHT", "2015_DROUGHT", "2015_DROUGHT_CASUALTIES", "2016_DROUGHT", "2016_DROUGHT_CASUALTIES", 
"2017_DROUGHT", "2017_DROUGHT_CASUALTIES", "WARNING_SYSTEM_NATURAL_DISASTER", "WARNING_SYSTEM_TSUNAMI", "SAFETY_EQUIPMENT", 
"SIGNS_EVACUATION_ROUTES", "CONSTRUCTION_MAINTENANCE_WATERBODY", "EARLYCHILDHOOD_PUBLIC_INSTITUTION_NUM", "EARLYCHILDHOOD_PRIVATE_INSTITUTION_NUM", 
"DISTANCE_TO_NEAREST_CHILDHOOCCENTRE", "CONVENIENCE_TO_CHILDHOODCENTRE", "KINDERGARTEN_PUBLIC_INSTITUTION_NUM", "KINDERGARTEN_PRIVATE_INSTITUTION_NUM", 
"DISTANCE_TO_NEAREST_KINDERGARTEN", "CONVENIENCE_TO_KINDERGARTEN", "PRIMARY_PUBLIC_INSTITUTION_NUM", "PRIMARY_PRIVATE_INSTITUTION_NUM", 
"DISTANCE_TO_NEAREST_PRIMARYSCHOOL", "CONVENIENCE_TO_PRIMARYSCHOOL", "MIDDLE_PUBLIC_INSTITUTION_NUM", "MIDDLE_PRIVATE_INSTITUTION_NUM", 
"DISTANCE_TO_NEAREST_MIDDLESCHOOL", "CONVENIENCE_TO_MIDDLESCHOOL", "HIGH_PUBLIC_INSTITUTION_NUM", "HIGH_PRIVATE_INSTITUTION_NUM", 
"DISTANCE_TO_NEAREST_HIGHSCHOOL", "CONVENIENCE_TO_HIGHSCHOOL", "POLYTECHNIC_PUBLIC_INSTITUTION_NUM", "POLYTECHNIC_PRIVATE_INSTITUTION_NUM", 
"DISTANCE_TO_NEAREST_POLYTECHNIC", "CONVENIENCE_TO_POLYTECHNIC", "COLLEGE_PUBLIC_INSTITUTION_NUM", "COLLEGE_PRIVATE_INSTITUTION_NUM", 
"DISTANCE_TO_NEAREST_COLLEGE", "CONVENIENCE_TO_COLLEGE", "SPECIALNEEDS_PRIMARY_PUBLIC_INSTITUTION_NUM", "SPECIALNEEDS_PRIMARY_PRIVATE_INSTITUTION_NUM", 
"SPECIALNEEDS_MIDDLE_PUBLIC_INSTITUTION_NUM", "SPECIALNEEDS_MIDDLE_PRIVATE_INSTITUTION_NUM", "SPECIALNEEDS_HIGH_PUBLIC_INSTITUTION_NUM",
"SPECIALNEEDS_HIGH_PRIVATE_INSTITUTION_NUM", "ISLAMIC_SCHOOL_PRIVATE_INSTITUTION_NUM", "SECONDARY_ISLAMIC_SCHOOL_PRIVATE_INSTITUTION_NUM", 
"THEOLOGY_SCHOOL_PRIVATE_INSTITUTION_NUM", "ILLITERACY_ERADICATION_ACTIVITY", "PACKAGEA/B/C_EDUCATION", "PLAYGROUP", "CHILDCARE_PARK", 
"QURAN_EDUCATION_PARK", "PUBLIC_READING_PARK", "FOREIGN_LANGUAGE_EDU_BY_VILLAGE", "FOREIGN_LANGUANGE_EDU_NOT_BY_VILLAGE", 
"COMPUTER_EDU_BY_VILLAGE", "COMPUTER_EDU_NOT_BY_VILLAGE", "FASHION_EDU_BY_VILLAGE", "FASHION_EDU_NOT_BY_VILLAGE", "BEAUTY_EDU_BY_VILLAGE", 
"BEAUTY_EDU_NOT_BY_VILLAGE", "CAR_MECHANIC_EDU_BY_VILLAGE", "CAR_MECHANIC_EDU_NOT_BY_VILLAGE", "ELECTRONICS_EDU_BY_VILLAGE", 
"ELECTRONICS_EDU_NOT_BY_VILLAGE", "HOSPITAL_NUM", "DISTANCE_TO_NEAREST_HOSPITAL", "CONVENIENCE_TO_HOSPITAL", "MATERNITY_HOSPITAL_NUM", 
"DISTANCE_TO_NEAREST_MATERNITY_HOSPITAL", "CONVENIENCE_TO_MATERNITY_HOSPITAL", "PUBLIC_HEALTH_CLINIC_INPATIENT_CARE_NUM", 
"DISTANCE_TO_NEAREST_CLINIC_INPATIENT_CARE", "CONVENIENCE_TO_CLINIC_INPATIENT_CARE", "PUBLIC_HEALTH_CLINIC_OUTPATIENT_CARE_NUM", 
"DISTANCE_TO_NEAREST_CLINIC_OUTPATIENT_CARE", "CONVENIENCE_TO_CLINIC_OUTPATIENT_CARE", "SEC_PUBLIC_HEALTH_CLINIC_NUM", 
"DISTANCE_TO_NEAREST_SEC_CLINIC", "CONVENIENCE_TO_SEC_CLINIC", "POLYCLINIC_NUM", 
"DISTANCE_TO_NEAREST_POLYCLINIC", "CONVENIENCE_TO_POLYCLINIC", "GP_NUM", 
"DISTANCE_TO_NEAREST_GP", "CONVENIENCE_TO_GP", "MATERNITY_CLINIC_NUM", 
"DISTANCE_TO_NEAREST_MATERNITY_CLINIC", "CONVENIENCE_TO_MATERNITY_CLINIC", "MIDWIFE_PRACTICE_NUM", 
"DISTANCE_TO_NEAREST_MIDWIFE_PRACTICE", "CONVENIENCE_TO_MIDWIFE_PRACTICE", "VILLAGE_HEALTH_POST_NUM", 
"DISTANCE_TO_NEAREST_HEALTH_POST", "CONVENIENCE_TO_HEALTH_POST", "VILLAGE_MATERNITY_HUT_NUM", 
"DISTANCE_TO_NEAREST_MATERNITY_HUT", "CONVENIENCE_TO_MATERNITY_HUT", "PHARMACY_NUM", 
"DISTANCE_TO_NEAREST_PHARMACY", "CONVENIENCE_TO_PHARMACY", "DRUGSTORE_NUM", 
"DISTANCE_TO_NEAREST_DRUGSTORE", "CONVENIENCE_TO_DRUGSTORE", "INTEGRATED_HEALTHCARE_CENTRE_ACTIVITY_ONCE_MONTH", 
"INTEGRATED_HEALTHCARE_CENTRE_ACTIVITY_TWICE_MONTH", "INTEGRATED_COACHING_CENTRE", "MALE_DOCTOR_NUM", "FEMALE_DOCTOR_NUM", "DENTIST_NUM", 
"MIDWIFE_NUM", "OTHER_HEALTHCARE_STAFF", "PRESENCE_VILLAGE_MIDWIFE", "TRADITIONAL_BIRTH_ATTENDANTS_NUM", 
"DIARRHEA_OUTBREAK", "DIARRHEA_COUNT", "DIARRHEA_DEATH_COUNT", "DENGUE_OUTBREAK", "DENGUE_COUNT", "DENGUE_DEATH_COUNT", 
"MEASLES_OUTBREAK", "MEASLES_COUNT", "MEASLES_DEATH_COUNT", "MALARIA_OUTBREAK", "MALARIA_COUNT", "MALARIA_DEATH_COUNT", 
"SARS_OUTBREAK", "SARS_COUNT", "SARS_DEATH_COUNT", "HEPATITIS_OUTBREAK", "HEPATITIS_COUNT", "HEPATITIS_DEATH_COUNT", 
"DIPHTHERIA_OUTBREAK", "DIPHTHERIA_COUNT", "DIPHTHERIA_DEATH_COUNT", "MALNUTRITION_POP_2017", "UNIVERSAL_HEALTHCARE_PROGRAMME_POP_2017", 
"STATEMENT_OF_POVERTY")
```

Now, let's rename the column names of podes2 with the column names vector `var_meaning2`.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
colnames(podes2) <- var_meaning2
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
head(podes2)
```

Now, let's select only **the relevant variables** that we will be using for our analysis. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes2_final <- podes2 %>%
  select("SHAPE", 
         "PROVINCE_ID", 
         "PROVINCE", 
         "CITY_ID", 
         "CITY", 
         "DISTRICT_ID",
         "DISTRICT",
         "VILLAGE_ID", 
         "VILLAGE", 
         "PRESENCE_MUDSLIDES",
         # "2017_MUDSLIDES", 
         # "2017_MUDSLIDES_CASUALTIES",
         "PRESENCE_FLOOD",
         # "2017_FLOOD", 
         # "2017_FLOOD_CASUALTIES",
         "PRESENCE_FLASHFLOOD", 
         # "2017_FLASHFLOOD", 
         # "2017_FLASHFLOOD_CASUALTIES",
         "PRESENCE_EARTHQUAKE", 
         # "2017_EARTHQUAKE",
         # "2017_EARTHQUAKE_CASUALTIES", 
         "PRESENCE_TSUNAMI",
         # "2017_TSUNAMI",
         # "2017_TSUNAMI_CASUALTIES", 
         "PRESENCE_TIDALWAVES", 
         # "2017_TIDALWAVES", 
         # "2017_TIDALWAVES_CASUALTIES", 
         "PRESENCE_TORNADO", 
         # "2017_TORNADO", 
         # "2017_TORNADO_CASUALTIES",
         "PRESENCE_VOLCANIC_ERUPTIONS", 
         # "2017_VOLCANIC_ERUPTIONS", 
         # "2017_VOLCANIC_ERUPTIONS_CASUALTIES",
         "PRESENCE_FORESTFIRE", 
         # "2017_FORESTFIRE", 
         # "2017_FORESTFIRE_CASUALTIES", 
         "PRESENCE_DROUGHT", 
         # "2017_DROUGHT",
         # "2017_DROUGHT_CASUALTIES", 
         "WARNING_SYSTEM_NATURAL_DISASTER", 
         "WARNING_SYSTEM_TSUNAMI", 
         # "SAFETY_EQUIPMENT",
         # "SIGNS_EVACUATION_ROUTES",
         # "CONSTRUCTION_MAINTENANCE_WATERBODY",
         "HOSPITAL_NUM", 
         # "DISTANCE_TO_NEAREST_HOSPITAL", # Remove distance since correlated to convenience 
         "CONVENIENCE_TO_HOSPITAL", 
         "MATERNITY_HOSPITAL_NUM",
         # "DISTANCE_TO_NEAREST_MATERNITY_HOSPITAL", 
         "CONVENIENCE_TO_MATERNITY_HOSPITAL", 
         "PUBLIC_HEALTH_CLINIC_INPATIENT_CARE_NUM", 
         # "DISTANCE_TO_NEAREST_CLINIC_INPATIENT_CARE", 
         "CONVENIENCE_TO_CLINIC_INPATIENT_CARE",
         "PUBLIC_HEALTH_CLINIC_OUTPATIENT_CARE_NUM",
         # "DISTANCE_TO_NEAREST_CLINIC_OUTPATIENT_CARE",
         "CONVENIENCE_TO_CLINIC_OUTPATIENT_CARE",
         "POLYCLINIC_NUM", 
         # "DISTANCE_TO_NEAREST_POLYCLINIC",
         "CONVENIENCE_TO_POLYCLINIC", 
         "GP_NUM", 
         # "DISTANCE_TO_NEAREST_GP", 
         "CONVENIENCE_TO_GP", 
         "MIDWIFE_PRACTICE_NUM", 
         # "DISTANCE_TO_NEAREST_MIDWIFE_PRACTICE", 
         "CONVENIENCE_TO_MIDWIFE_PRACTICE", 
         "VILLAGE_HEALTH_POST_NUM", 
         # "DISTANCE_TO_NEAREST_HEALTH_POST", 
         "CONVENIENCE_TO_HEALTH_POST",
         "VILLAGE_MATERNITY_HUT_NUM", 
         # "DISTANCE_TO_NEAREST_MATERNITY_HUT", 
         "CONVENIENCE_TO_MATERNITY_HUT",
         "PHARMACY_NUM", 
         # "DISTANCE_TO_NEAREST_PHARMACY", 
         "CONVENIENCE_TO_PHARMACY", 
         "DRUGSTORE_NUM", 
         # "DISTANCE_TO_NEAREST_DRUGSTORE", 
         "CONVENIENCE_TO_DRUGSTORE", 
         "DENTIST_NUM", 
         "DIARRHEA_OUTBREAK",
         # "DIARRHEA_COUNT",
         # "DIARRHEA_DEATH_COUNT",
         "DENGUE_OUTBREAK", 
         # "DENGUE_COUNT",
         # "DENGUE_DEATH_COUNT", 
         "MEASLES_OUTBREAK", 
         # "MEASLES_COUNT", 
         # "MEASLES_DEATH_COUNT", 
         "MALARIA_OUTBREAK",
         # "MALARIA_COUNT", 
         # "MALARIA_DEATH_COUNT", 
         "SARS_OUTBREAK", 
         # "SARS_COUNT", 
         # "SARS_DEATH_COUNT",
         "HEPATITIS_OUTBREAK", 
         # "HEPATITIS_COUNT",
         # "HEPATITIS_DEATH_COUNT", 
         "DIPHTHERIA_OUTBREAK",
         # "DIPHTHERIA_COUNT", 
         # "DIPHTHERIA_DEATH_COUNT",
         "MALNUTRITION_POP_2017", 
         "UNIVERSAL_HEALTHCARE_PROGRAMME_POP_2017", 
         "STATEMENT_OF_POVERTY",
         "EARLYCHILDHOOD_PUBLIC_INSTITUTION_NUM", 
         "EARLYCHILDHOOD_PRIVATE_INSTITUTION_NUM", 
         # "DISTANCE_TO_NEAREST_CHILDHOOCCENTRE", 
         "CONVENIENCE_TO_CHILDHOODCENTRE", 
         "KINDERGARTEN_PUBLIC_INSTITUTION_NUM", 
         "KINDERGARTEN_PRIVATE_INSTITUTION_NUM", 
         # "DISTANCE_TO_NEAREST_KINDERGARTEN", 
         "CONVENIENCE_TO_KINDERGARTEN", 
         "PRIMARY_PUBLIC_INSTITUTION_NUM",
         "PRIMARY_PRIVATE_INSTITUTION_NUM", 
         # "DISTANCE_TO_NEAREST_PRIMARYSCHOOL", 
         "CONVENIENCE_TO_PRIMARYSCHOOL",
         "MIDDLE_PUBLIC_INSTITUTION_NUM", 
         "MIDDLE_PRIVATE_INSTITUTION_NUM", 
         # "DISTANCE_TO_NEAREST_MIDDLESCHOOL", 
         "CONVENIENCE_TO_MIDDLESCHOOL", 
         "HIGH_PUBLIC_INSTITUTION_NUM", 
         "HIGH_PRIVATE_INSTITUTION_NUM", 
         # "DISTANCE_TO_NEAREST_HIGHSCHOOL",
         "CONVENIENCE_TO_HIGHSCHOOL",
         "POLYTECHNIC_PUBLIC_INSTITUTION_NUM", 
         "POLYTECHNIC_PRIVATE_INSTITUTION_NUM", 
         # "DISTANCE_TO_NEAREST_POLYTECHNIC",
         "CONVENIENCE_TO_POLYTECHNIC", 
         "COLLEGE_PUBLIC_INSTITUTION_NUM", 
         "COLLEGE_PRIVATE_INSTITUTION_NUM", 
         # "DISTANCE_TO_NEAREST_COLLEGE",
         "CONVENIENCE_TO_COLLEGE", 
         "ISLAMIC_SCHOOL_PRIVATE_INSTITUTION_NUM")
```


```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
summary(podes2_final)
```


From this summary, the observations are:

-

-

-

-



### 3.5.3 PODES 2018 part 3 (social & cultural, entertainment & sport, transportation, communication and information, economy)

In PODES 2018 Part 3, it covers mostly demographic, economic, transport and as well as telecommunications data. The latter 3 are of more interest to us for this study as it can act as a proxy for how developed a DESA is. This would be important to city planners as it lets them know how much development needs to take place in order to build the village into a new capital city. 


```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
glimpse(podes3)
```

- social & cultural 

Changing variable "R801" - this encodes for whether a religion is present in a desa. The data has been encoded using different numbers; e.g. for Islam, 1 means present while 2 means absent; but for catholicism, 5 means present and 6 means absent. Change all these variables to 1 for presence and 0 for absence to ensure easier interpretability. 

```{r}
podes3 <- podes3 %>% 
  mutate(R80101 = recode_factor(as.vector(podes3$R80101), `1` = 1, `2` = 0)) %>%
  mutate(R80102 = recode_factor(as.vector(podes3$R80102), `3` = 1, `4` = 0)) %>%
  mutate(R80103 = recode_factor(as.vector(podes3$R80103), `5` = 1, `6` = 0)) %>%
  mutate(R80104 = recode_factor(as.vector(podes3$R80104), `7` = 1, `8` = 0)) %>%
  mutate(R80105 = recode_factor(as.vector(podes3$R80105), `1` = 1, `2` = 0)) %>%
  mutate(R80106 = recode_factor(as.vector(podes3$R80106), `3` = 1, `4` = 0)) %>%
  mutate(R80107 = recode_factor(as.vector(podes3$R80107), `5` = 1, `6` = 0))
```

Changing variable "R802" - this encodes for the dominant religion present in a desa. The numbers refer to the categories in "R801".

```{r}
podes3 <- podes3 %>% 
  mutate(R80102 = recode_factor(as.vector(podes3$R80102), `1` = 'ISLAM', `3` = 'CHRISTIANITY', `5` = 'CATHOLICISM', `7` = "BUDDHISM"))
```

Variable "R803" - this encodes for the number of religious buildings in a desa. No need to change anything since it is a continuous variable.


Variable "R804A1" - this encodes for whether a desa is multiethnic. 1 means yes, 2 means no. Change it to 1 and 0 respectively.

```{r}
podes3 <- podes3 %>% 
  mutate(R804A1 = recode_factor(as.vector(podes3$R804A1), `1` = 1, `2` = 0)) 
```

Variable "R804A2A",  "R804A2B","R804A2C" - these give the biggest, 2nd  largest and 3rd largest ethnic group. This is encoded by PML code. Since we are not sure what the PML codes mean - we will drop this column later on. 

Variable "R804B1" - this encodes for whether a desa is multilingual. 1 means yes, 2 means no. Change it to 1 and 0 respectively.

```{r}
podes3 <- podes3 %>% 
  mutate(R804B1 = recode_factor(as.vector(podes3$R804B1), `1` = 1, `2` = 0)) 
```

Variable "R804B2" - this give the most spoken language in a desa. This is encoded by PML code. Since we are not sure what the PML codes mean - we will drop this column later on. 

Variables "R805A" to "R805I" give the number of disabled people in a village broken down by disability. 

"R806" gives the number of physically restrained people. As it is continuous, no need to recode anything.

Variable "R807" - this encodes for whether a desa has cultural heritage sites. 1 means yes & actively managed, 2 means yes & rarely managed, 3 means yes & not managed, 4 means there are no such sites. 

```{r}
podes3 <- podes3 %>% 
  mutate(R807 = recode_factor(as.vector(podes3$R807), `1` = 'YES, MANAGED', `2` = 'YES, RARELY MANAGED', `3` = 'YES, NOT MANAGED', `4` = 'NO')) 
```

Variable "R808" - this encodes for whether a desa has communal spaces. 1 means yes & actively managed, 2 means yes & not managed, 3 means there are no such sites. 

```{r}
podes3 <- podes3 %>% 
  mutate(R808 = recode_factor(as.vector(podes3$R808), `1` = 'YES, MANAGED', `2` =  'YES, NOT MANAGED', `3` = 'NO')) 
```

Variable "R809A" gives whether a desa has engaged in communal activities (e.g. volunteering) for public good in the past year.

Variable "R809B" is whether a desa has helped citizens  in need (diseases or death) in the past year. 

1 means most were involved, 2 means some were involved, 3 means no such activities. 

```{r}
podes3 <- podes3 %>% 
  mutate(R809A = recode_factor(as.vector(podes3$R809A), `1` = 'YES, MAJORITY INVOLVED', `2` =  'YES, SOME INVOLVED', `3` = 'No')) %>% 
  mutate(R809B = recode_factor(as.vector(podes3$R809B), `1` = 'YES, MAJORITY INVOLVED', `2` =  'YES, SOME INVOLVED', `3` = 'NO'))
```

Variable "R8101K2" to "R8107K2" gives the local culture that are related to pregnancy, marriage, work, environment, marriage, community and death. As the columns have some missing data, and are unable to be coded into distinct groups, we will be dropping these columns later on.

Variable "R811A" to "R811F" gives the number of social institutions in the Desa. No need to recode anything since it is a continuous variable.

Variable R811A - family welfare organizations

Variable R811B - youth organizations

Variable R811C - traditional organizations that preserve customs

Variable R811D - farmers group/union

Variable R811E - water management organizations

Variable R811F - community groups


- entertainment & sport

Variable "R901AK2" to "R901LK3" encode for whether sports facilities and activity groups are present in a region. 

If a variable ends with 2, such as R901AK2 and R901BK2,  they mean presence of sports facilities and condition, while if the variable name ends with 3, such as R901AK3 and R901BK3, they mean presence of sports activity groups. 

For the variables ending with 2, 1 means 'Yes, In good condition', 2 means 'Yes, but moderately damaged' , 3 means 'Yes, but badly damaged' and 4 means 'No'. 

For the variables ending with 3, 1 means have, 2 means don't have - need to recode this to 1 and 0. 

```{r}
podes3 <- podes3 %>% 
  mutate(R901AK2 = recode_factor(as.vector(podes3$R901AK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901BK2 = recode_factor(as.vector(podes3$R901BK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901CK2 = recode_factor(as.vector(podes3$R901CK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901DK2 = recode_factor(as.vector(podes3$R901DK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'Yes, poor condition', `4` = 'No')) %>% 
  mutate(R901EK2 = recode_factor(as.vector(podes3$R901EK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901FK2 = recode_factor(as.vector(podes3$R901FK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901GK2 = recode_factor(as.vector(podes3$R901GK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901HK2 = recode_factor(as.vector(podes3$R901HK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901IK2 = recode_factor(as.vector(podes3$R901IK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901JK2 = recode_factor(as.vector(podes3$R901JK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901KK2 = recode_factor(as.vector(podes3$R901KK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) %>% 
  mutate(R901LK2 = recode_factor(as.vector(podes3$R901LK2), `1` = 'YES, GOOD CONDITION', `2` =  'YES, MODERATE CONDITION',`3` = 'YES, POOR CONDITION', `4` = 'NO')) 
```

```{r}
podes3 <- podes3 %>% 
  mutate(R901AK3 = recode_factor(as.vector(podes3$R901AK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901BK3 = recode_factor(as.vector(podes3$R901BK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901CK3 = recode_factor(as.vector(podes3$R901CK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901DK3 = recode_factor(as.vector(podes3$R901DK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901EK3 = recode_factor(as.vector(podes3$R901EK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901FK3 = recode_factor(as.vector(podes3$R901FK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901GK3 = recode_factor(as.vector(podes3$R901GK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901HK3 = recode_factor(as.vector(podes3$R901HK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901IK3 = recode_factor(as.vector(podes3$R901IK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901JK3 = recode_factor(as.vector(podes3$R901JK3), `1` = 1, `2` = 0)) %>% 
  mutate(R901KK3 = recode_factor(as.vector(podes3$R901KK3), `1` = 1, `2` = 0))  %>% 
  mutate(R901LK3 = recode_factor(as.vector(podes3$R901LK3), `1` = 1, `2` = 0))
```

Variable R902A Gives us whether a pub/club/karaoke is present in the desa. 1 means have, 2 means don't have - need to recode this to 1 and 0. The follow up question (R902B) refers to the distance to the nearest bar, which is a continuous variable. No need to recode anything. 

```{r}
podes3 <- podes3 %>% 
  mutate(R902A = recode_factor(as.vector(podes3$R902A), `1` = 1, `2` = 0)) 
```

- transportation, communication and information

Variable R1001A gives us the means of transport available in the desa to access other villages/sub-districts. 1 means land, 2 means water, 3 means land and water, while 4 means air. They are mutually exclusive categories.

```{r}
podes3 <- podes3 %>% 
  mutate(R1001A = recode_factor(as.vector(podes3$R1001A), `1` = 'LAND', `2` = 'WATER', `3` = 'LAND AND WATER' , `4` = 'AIR')) 
```

The next section is for those that answered either option 1 or 3 only, transportation through land/land & water. "R1001B1" refers to road surface material, while "R1001B2" refers to whether the roads can be used throughout the year by 4-wheel vehicles. 

```{r}
podes3 <- podes3 %>% 
  mutate(R1001B1 = recode_factor(as.vector(podes3$R1001B1), `1` = 'ASPHALT/CONCRETE', `2` = 'GRAVEL/STONE', `3` = 'SOIL' , `4` = 'OTHERS')) %>% 
  mutate(R1001B2 = recode_factor(as.vector(podes3$R1001B2), `1` = 'ALWAYS', `2` = 'ALWAYS, EXCEPT FOR EXTREME WEATHER', `3` = 'DRY SEASON' , `4` = 'NEVER'))
```

"R1001C1" refers to whether public transport exists and pass through the village.

"R1001C2" refers to whether it operates daily.

"R1001C3" refers to its operational hours/times. 

```{r}
podes3 <- podes3 %>% 
  mutate(R1001C1 = recode_factor(as.vector(podes3$R1001C1), `1` = 'YES, FIXED ROUTE', `2` = 'YES, NO FIXED ROUTE', `3` = 'NO')) %>% 
  mutate(R1001C2 = recode_factor(as.vector(podes3$R1001C2), `1` = 1, `2` = 0)) %>%
  mutate(R1001C3 = recode_factor(as.vector(podes3$R1001C3), `1` = 'MORNING & NIGHT', `2` = 'MORNING'))
```

The next section R1002 gives us information about traveling from the head office to various locations. The first alphabet tells us the destination - AK is to the district office, BK is to the mayor's office, CK is to the next nearest district office, while DK is to the next nearest mayor's office.

The last number gives us the metric for this transportation route. '2' is for the transportation method most commonly used, '3' and '4' is for the explicit transport method, 5 gives the distance, M gives the hours, E gives the minutes, and 7 gives the transportation cost. 

```{r}
podes3 <- podes3 %>% 
  mutate(R1002AK2 = recode_factor(as.vector(podes3$R1002AK2), `1` = 'PUBLIC TRANSPORT', `2` = 'PRIVATE VEHICLE', `4` = 'WALKING/CYCLE')) %>% 
  mutate(R1002BK2 = recode_factor(as.vector(podes3$R1002BK2), `1` = 'PUBLIC TRANSPORT', `2` = 'PRIVATE VEHICLE', `4` = 'WALKING/CYCLE')) %>% 
  mutate(R1002CK2 = recode_factor(as.vector(podes3$R1002CK2), `1` = 'PUBLIC TRANSPORT', `2` = 'PRIVATE VEHICLE', `4` = 'WALKING/CYCLE')) %>% 
  mutate(R1002DK2 = recode_factor(as.vector(podes3$R1002DK2), `1` = 'PUBLIC TRANSPORT', `2` = 'PRIVATE VEHICLE', `4` = 'WALKING/CYCLE')) %>% 
  mutate(R1002AK3 = recode_factor(as.vector(podes3$R1002AK3), `1` = 'MOTORCYCLE', `2` = 'VEHICLE WITH 3 OR MORE WHEELS', `4` = 'BOAT', `8` = 'AIRPLANE', `16` = 'OTHERS'))  %>% 
  mutate(R1002BK3 = recode_factor(as.vector(podes3$R1002BK3), `1` = 'MOTORCYCLE', `2` = 'VEHICLE WITH 3 OR MORE WHEELS', `4` = 'BOAT', `8` = 'AIRPLANE', `16` = 'OTHERS')) %>%
  mutate(R1002CK3 = recode_factor(as.vector(podes3$R1002CK3), `1` = 'MOTORCYCLE', `2` = 'VEHICLE WITH 3 OR MORE WHEELS', `4` = 'BOAT', `8` = 'AIRPLANE', `16` = 'OTHERS')) %>%
  mutate(R1002DK3 = recode_factor(as.vector(podes3$R1002DK3), `1` = 'MOTORCYCLE', `2` = 'VEHICLE WITH 3 OR MORE WHEELS', `4` = 'BOAT', `8` = 'AIRPLANE', `16` = 'OTHERS')) %>%
  mutate(R1002AK4 = recode_factor(as.vector(podes3$R1002AK4), `1` = 'MOTORCYCLE', `2` = 'VEHICLE WITH 3 OR MORE WHEELS', `3` = 'BOAT', `4` = 'AIRPLANE', `5` = 'OTHERS')) %>% 
  mutate(R1002BK4 = recode_factor(as.vector(podes3$R1002BK4), `1` = 'MOTORCYCLE', `2` = 'VEHICLE WITH 3 OR MORE WHEELS', `3` = 'BOAT', `4` = 'AIRPLANE', `5` = 'OTHERS')) %>% 
  mutate(R1002CK4 = recode_factor(as.vector(podes3$R1002CK4), `1` = 'MOTORCYCLE', `2` = 'VEHICLE WITH 3 OR MORE WHEELS', `3` = 'BOAT', `4` = 'AIRPLANE', `5` = 'OTHERS')) %>% 
  mutate(R1002DK4 = recode_factor(as.vector(podes3$R1002DK4), `1` = 'MOTORCYCLE', `2` = 'VEHICLE WITH 3 OR MORE WHEELS', `3` = 'BOAT', `4` = 'AIRPLANE', `5` = 'OTHERS'))
```

"R1003A" refers to the number of families that subscribe to a landline telephone, a continuous variable which doesn't need any recoding.

"R1003B" refers to the presence of citizens owning and using cellphones/handphones.

```{r}
podes3 <- podes3 %>% 
  mutate(R1003B = recode_factor(as.vector(podes3$R1003B), `1` = 'MAJORITY', `2` = 'MINORITY', `3` = 'NONE'))
```


"R1004" gives us whether internet cafes are present in a desa. Recode to 1 for yes and 0 for no.

```{r}
podes3 <- podes3 %>% 
  mutate(R1004 = recode_factor(as.vector(podes3$R1004), `1` = 1, `2` = 0))
```

"R1005A" and "R1005B" are continuous variables. R1005A refers to the total number of Base Transceiver Station (BTS) towers. R1005B refers to the total number of cellphones services operators that reach the village/sub-district.

"R1005C" tells us about the strength of cellphone signals/reception in the desa. We will recode this variable from 1 to "VERY STRONG", 2 to "STRONG", 3 to "WEAK", 4 to "NONE".

"R1005D" refers to the type of internet signal for most cellphones in the desa. We will recode this variable from 1 to "4G/LTE", 2 to "3G/H/H+/EVDO", 3 to "2.5G/E/GPRS", 4 to "NONE".

```{r}
podes3 <- podes3 %>% 
  mutate(R1005C = recode_factor(as.vector(podes3$R1005C), `1` = 'VERY STRONG', `2` = 'STRONG', `3` = 'WEAK', `4` = 'NONE')) %>% 
  mutate(R1005D = recode_factor(as.vector(podes3$R1005D), `1` = '4G/LTE', `2` = '3G/H/H+/EVDO', `3` = '2.5G/E/GPRS', `4` = 'NONE'))
```

"R1006A" refers to the working conditions of computers present in the village head office. 

"R1006B" refers to the working conditions of internet facilities in the village head office.

```{r}
podes3 <- podes3 %>% 
  mutate(R1006A = recode_factor(as.vector(podes3$R1006A), `1` = 'USED', `2` = 'RARELY USED', `3` = 'NOT USED', `4` = 'NONE')) %>% 
  mutate(R1006B = recode_factor(as.vector(podes3$R1006B), `1` = 'FUNCTIONING', `2` = 'RARELY FUNCTIONING', `3` = 'NOT FUNCTIONING', `4` = 'NONE'))
```

"R1007A" refers to the working condition of post offices. 

"R1007B" refers to presence of mobile post offices.

"R1007C" refers to the working condition of private couriers.

```{r}
podes3 <- podes3 %>% 
  mutate(R1007A = recode_factor(as.vector(podes3$R1007A), `1` = 'OPERATIONAL', `2` = 'RARELY OPERATIONAL', `3` = 'NOT OPERATIONAL', `4` = 'NONE')) %>% 
  mutate(R1007B = recode_factor(as.vector(podes3$R1007B), `1` = 1, `2` = 0)) %>%
  mutate(R1007C = recode_factor(as.vector(podes3$R1007C), `1` = 'OPERATIONAL', `2` = 'RARELY OPERATIONAL', `3` = 'NOT OPERATIONAL', `4` = 'NONE'))
```


Variable "R1008" refers to the media programs/TV channels that the village has access to.

Variable R1008AK2, ending with K2, refers to the whether villagers receive TV/Radio broadcast.

Variable R1008AK3, ending with K3, refers to whether the broadcast needs TV cable to connect to.

This applies to all the R1008 variable from R1008A to R1008G.

R1008A variable - TVRI, national TV

R1008B variable - TVRI daerah, regional TV

R1008C variable - TV Swasta, private TV

R1008D variable - TV luar negeri, overseas TV

R1008E variable - RRI, national radio

R1008F variable - RRI daerah, regional radio

R1008G variable - Radio Swasta, private radio


```{r}
podes3 <- podes3 %>% 
  mutate(R1008AK2 = recode_factor(as.vector(podes3$R1008AK2), `1` = 1, `2` = 0)) %>% 
  mutate(R1008BK2 = recode_factor(as.vector(podes3$R1008BK2), `1` = 1, `2` = 0)) %>% 
  mutate(R1008CK2 = recode_factor(as.vector(podes3$R1008CK2), `1` = 1, `2` = 0)) %>% 
  mutate(R1008DK2 = recode_factor(as.vector(podes3$R1008DK2), `1` = 1, `2` = 0)) %>% 
  mutate(R1008EK2 = recode_factor(as.vector(podes3$R1008EK2), `1` = 1, `2` = 0)) %>% 
  mutate(R1008FK2 = recode_factor(as.vector(podes3$R1008FK2), `1` = 1, `2` = 0)) %>% 
  mutate(R1008GK2 = recode_factor(as.vector(podes3$R1008GK2), `1` = 1, `2` = 0)) %>% 
  mutate(R1008AK3 = recode_factor(as.vector(podes3$R1008AK3), `1` = 1, `2` = 0)) %>% 
  mutate(R1008BK3 = recode_factor(as.vector(podes3$R1008BK3), `1` = 1, `2` = 0)) %>% 
  mutate(R1008CK3 = recode_factor(as.vector(podes3$R1008CK3), `1` = 1, `2` = 0)) %>% 
  mutate(R1008DK3 = recode_factor(as.vector(podes3$R1008DK3), `1` = 1, `2` = 0)) 
```


- Economy

Variable "R1201" refers to the total number of units of micro industries according to raw materials. Variable R1201A to R1201H are continuous variables. 

Variable "R1202A" gives us the total number of location of industry centrals in the village. It is a continuous variable.

Variable "R1202B" gives us the total number of small industry ecosystem (LIK). It is a continuous variable.

Variable "R1202C" gives us the total number of small industrial village (PIK). It is a continuous variable.

Variable "R1203A" refers to the presence of kerosene sellers while variable "R1203B" refers to the presence of LPG sellers. We will recode these variables to 1 for yes and 0 for no.

```{r}
podes3 <- podes3 %>% 
  mutate(R1203A = recode_factor(as.vector(podes3$R1203A), `1` = 1, `2` = 0)) %>% 
  mutate(R1203B = recode_factor(as.vector(podes3$R1203B), `3` = 1, `4` = 0))
```

Variable "R1204" refers to the number of Village cooperative units (Koperasi Unit Desa - KUD) present in the village. All of R1204 variables are continuous variables.

Variable R1204A - Functioning village cooperatives

Variable R1204B - Village cooperatives that sell/buy farmers' produce

Variable R1204C - Village cooperatives that provide business credit (loan for businesses)

Variable R1204D - Village cooperatives that do other activities

Variable "R1205A" gives us the number of cooperatives in the village aside from Village cooperatives (KUD) that are still active. These are continous variables.

Variable R1205A1 - small micro business cooperatives

Variable R1205A2 - savings & loan cooperatives

Variable R1205A3 - other cooperatives 

Variable "R1205B" refers to whether agricultural shops are present in the village. These agricultural shops sells seeds, pesticide, tools and fertilizer. Recode this to 1 for yes and 0 for no.

Variable R1205A - shops owned by village cooperatives

Variable R1205B - shops owned by state owned enterprises

Variable R1205C - shops owned by others

```{r}
podes3 <- podes3 %>% 
  mutate(R1205B1 = recode_factor(as.vector(podes3$R1205B1), `1` = 1, `2` = 0)) %>% 
  mutate(R1205B2 = recode_factor(as.vector(podes3$R1205B2), `3` = 1, `4` = 0)) %>% 
  mutate(R1205B3 = recode_factor(as.vector(podes3$R1205B3), `5` = 1, `6` = 0))
```

Variable "R1206" gives us information about the number of economic facilities and infrastructure in the village/sub-district. 

Variables R1206 ending with K2 such as R1206AK2 and R1206BK2 refers to the total number of R1206 variables such as markets, minimarts, hotels, restaurants and shops.

Variables R1206 ending with K3 such as R1206AK3 and R1206BK3 refers to the nearest distance to the next facility/infrastructure if it's not available in the direct village.

We will only recode the last column of every variable (columns that end with K4, such as R1206AK4 and R1206BK4, which refers to how accessible the facilities are) as the rest are continuous variables. We will recode 1 to "VERY EASY", 2 to "EASY", 3 to "HARD", 4 to "VERY HARD".

```{r}
podes3 <- podes3 %>% 
  mutate(R1206AK4 = recode_factor(as.vector(podes3$R1206AK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206BK4 = recode_factor(as.vector(podes3$R1206BK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206CK4 = recode_factor(as.vector(podes3$R1206CK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206DK4 = recode_factor(as.vector(podes3$R1206DK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206EK4 = recode_factor(as.vector(podes3$R1206EK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206F1K4 = recode_factor(as.vector(podes3$R1206F1K4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206F2K4 = recode_factor(as.vector(podes3$R1206F2K4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206GK4 = recode_factor(as.vector(podes3$R1206GK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206HK4 = recode_factor(as.vector(podes3$R1206HK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206IK4 = recode_factor(as.vector(podes3$R1206IK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1206JK4 = recode_factor(as.vector(podes3$R1206JK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD'))
```

"R1207" gives us presence of credit lending institutions/facilities for the past year. Recode this to 1 for yes and 0 for no.

Variable R1207A - Kredit Usaha Rakyat (KUR), working capital loan 

Kredit Usaha Rakyat (KUR) is a solution to provide working capital and financing investment to increase the capability of small businesses that have not met the banking (non bankable) requirements

Variable R1207B - Kredit Ketahanan Pangan dan Energi (KKP-E), food and energy capital loan

Variable R1207C - Kredit Usaha Kecil (KUK), small credit loan

Variable R1207D - Kelompok Usaha Bersama (KUBE), joint family program

```{r}
podes3 <- podes3 %>% 
  mutate(R1207A = recode_factor(as.vector(podes3$R1207A), `1` = 1, `2` = 0)) %>% 
  mutate(R1207B = recode_factor(as.vector(podes3$R1207B), `3` = 1, `4` = 0)) %>% 
  mutate(R1207C = recode_factor(as.vector(podes3$R1207C), `5` = 1, `6` = 0)) %>% 
  mutate(R1207D = recode_factor(as.vector(podes3$R1207D), `7` = 1, `8` = 0))
```

Variable "R1208" gives us information about presence of financial institutions present in the village/sub-district.

Variable R1208 ending with K2 such as R1208AK2 and R1208BK2, refers to the total number of financial institutions and variable R1208 ending with K3 refers to the distance to the nearest facility if it's not readily available in the village.

R1208A variable - government commercial banks

R1208B variable - private commercial banks

R1208C variable - credit banks

We will only recode the last column of every R1208 variable ending with K4 such as R1208AK4 and R1208BK4, which refers to how accessible the facilities are. We will recode 1 to "VERY EASY", 2 to "EASY", 3 to "HARD" and 4 to "VERY HARD".

```{r}
podes3 <- podes3 %>% 
  mutate(R1208AK4 = recode_factor(as.vector(podes3$R1208AK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1208BK4 = recode_factor(as.vector(podes3$R1208BK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1208CK4 = recode_factor(as.vector(podes3$R1208CK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) 
```

Variable "R1209" refers to the presence of economic support facilities in the village/sub-district.

Variable R1209 ending with K2 such as R1209AK2 and R1209BK2, refers to the presence of such facilities. We will recode this as 1 for yes and 0 for no.

Variable R1208 ending with K3 refers to the distance to the nearest facility if it's not readily available in the village. This is a continuous variable.

```{r}
podes3 <- podes3 %>% 
  mutate(R1209AK2 = recode_factor(as.vector(podes3$R1209AK2), `1` = 1, `2` = 0)) %>%
  mutate(R1209BK2 = recode_factor(as.vector(podes3$R1209BK2), `1` = 1, `2` = 0)) %>%
  mutate(R1209CK2 = recode_factor(as.vector(podes3$R1209CK2), `1` = 1, `2` = 0)) %>%
  mutate(R1209DK2 = recode_factor(as.vector(podes3$R1209DK2), `1` = 1, `2` = 0)) %>%
  mutate(R1209EK2 = recode_factor(as.vector(podes3$R1209EK2), `1` = 1, `2` = 0)) %>%
  mutate(R1209FK2 = recode_factor(as.vector(podes3$R1209FK2), `1` = 1, `2` = 0)) %>%
  mutate(R1209GK2 = recode_factor(as.vector(podes3$R1209GK2), `1` = 1, `2` = 0)) 
```

We will also recode the last column of every R1209 variable ending with K4 such as R1209AK4 and R1209BK4, which refers to how accessible the facilities are. We will recode 1 to "VERY EASY", 2 to "EASY", 3 to "HARD" and 4 to "VERY HARD".

```{r}
podes3 <- podes3 %>% 
  mutate(R1209AK4 = recode_factor(as.vector(podes3$R1209AK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1209BK4 = recode_factor(as.vector(podes3$R1209BK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1209CK4 = recode_factor(as.vector(podes3$R1209CK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1209DK4 = recode_factor(as.vector(podes3$R1209DK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1209EK4 = recode_factor(as.vector(podes3$R1209EK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1209FK4 = recode_factor(as.vector(podes3$R1209FK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD')) %>% 
  mutate(R1209GK4 = recode_factor(as.vector(podes3$R1209GK4), `1` = 'VERY EASY', `2` = 'EASY', `3` = 'HARD', `4` = 'VERY HARD'))
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
head(podes3)
```

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
var_meaning3 = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE",'HAS_ISLAM',
                   'HAS_CHRISTIAN',
                   'HAS_CATHOLIC',
                   'HAS_BUDDHIST',
                   'HAS_HINDU',
                   'HAS_CONFUCIANISM',
                   'HAS_SECTS',
                   'DOMINANT_RELIGION',
                   'NUM_MOSQUES',
                   'NUM_SURAU',
                   'NUM_CHRISTIAN_CHURCHES',
                   'NUM_CATHOLIC_CHURCHES',
                   'NUM_CHAPELS',
                   'NUM_HINDU_TEMPLE',
                   'NUM_BUDDHIST_TEMPLE',
                   'NUM_NONBUDDHIST_TEMPLES',
                   'NUM_OTHERS',
                   'IS_MULTI_ETHNIC',
                   'LARGEST_ETHNIC_GROUP',
                   'SECOND_LARGEST_ETHNIC_GROUP',
                   'THIRD_LARGEST_ETHNIC_GROUP',
                   'IS_MULTILINGUAL',
                   'DOMINANT_LANGUAGE',
                   'NUM_BLIND',
                   'NUM_DEAF',
                   'NUM_SPEECH_IMPAIRED',
                   'NUM_DEAF_MUTE',
                   'NUM_PARALYSED',
                   'NUM_MENTALLY_DISABLED',
                   'NUM_EMOTIONAL_DISORDER',
                   'NUM_EX_LEPROSY',
                   'NUM_MULTIPLE_DISABILITIES',
                   'NUM_RESTRAINED', #
                   'CULTURAL_RESERVE_SITES',
                   'COMMUNAL_SPACES',
                   'COMMUNAL_ACTIVITIES',
                   'COMMUNAL_ACTIVITIES_HELPING_OTHER_VILLAGERS',
                   'PREGNANCY_CULTURE',
                   'CHILDBIRTH_CULTURE',
                   'WORK_CULTURE',
                   'ENVIRONMENT_CULTURE',
                   'MARRIAGE_CULTURE',
                   'COMMUNITY_CULTURE',
                   'DEATH_CULTURE',
                   'NUM_FAMILY_EDUCATION_ORGS', 
                   'NUM_YOUTH_ORGS', #
                   'NUM_TRADITIONAL_ORGS', #
                   'NUM_FARMING_ORGS', #
                   'NUM_WATER_MANAGEMENT_ORGS', #
                   'NUM_COMMUNITY_ORGS', # 
                   'HAS_SOCCER_FACILITIES',#
                   'HAS_SOCCER_ACTIVITY_GROUP',
                   'HAS_VOLLEYBALL_FACILITIES',
                   'HAS_VOLLEYBALL_ACTIVITY_GROUP',
                   'HAS_BADMINTON_FACILITIES',
                   'HAS_BADMINTON_ACTIVITY_GROUP',
                   'HAS_BASKETBALL_FACILITIES',
                   'HAS_BASKETBALL_ACTIVITY_GROUP',
                   'HAS_TENNIS_FACILITIES',
                   'HAS_TENNIS_ACTIVITY_GROUP',
                   'HAS_TABLETENNIS_FACILITIES',
                   'HAS_TABLETENNIS_ACTIVITY_GROUP',
                   'HAS_FUTSAL_FACILITIES',
                   'HAS_FUTSAL_ACTIVITY_GROUP',
                   'HAS_SWIMMING_FACILITIES',
                   'HAS_SWIMMING_ACTIVITY_GROUP',
                   'HAS_MARTIALARTS_FACILITIES',
                   'HAS_MARTIALARTS_ACTIVITY_GROUP',
                   'HAS_BILLARD_FACILITIES',
                   'HAS_BILLARD_ACTIVITY_GROUP',
                   'HAS_FITNESS_FACILITIES',
                   'HAS_FITNESS_ACTIVITY_GROUP',
                   'HAS_OTHER_FACILITIES',
                   'HAS_OTHER_ACTIVITY_GROUP',
                   'PUBS',
                   'DISTANCE_TO_NEAREST_PUB', 
                   'TRANSPORTATION_METHODS', #
                   'ROAD_MATERIAL',
                   'ROAD_ACCESSIBLE_BY_4_WHEEL_VEHICLE', #
                   'PUBLIC_TRANSPORT', #
                   'PUBLIC_TRANSPORT_DAILY_OPERATION', #
                   'PUBLIC_TRANSPORT_OPERATION_TIME', #
                   'VILLAGE_TO_DISTRICTOFFICE_TRANSPORTATION',
                   'VILLAGE_TO_DISTRICTOFFICE_TYPE_PUBLICTRANSPORT',
                   'VILLAGE_TO_DISTRICTOFFICE_MAIN_PUBLICTRANSPORT',
                   'VILLAGE_TO_DISTRICTOFFICE_DISTANCE_TRAVELLED',
                   'VILLAGE_TO_DISTRICTOFFICE_TRAVEL_TIME_HOUR',
                   'VILLAGE_TO_DISTRICTOFFICE_TRAVEL_TIME_MINUTE',
                   'VILLAGE_TO_DISTRICTOFFICE_TRAVEL_COST',
                   'VILLAGE_TO_MAYOROFFICE_TRANSPORTATION',
                   'VILLAGE_TO_MAYOROFFICE_TYPE_PUBLICTRANSPORT',
                   'HEADOFFICE_MAYOROFFICE_MAIN_PUBLICTRANSPORT',
                   'VILLAGE_TO_MAYOROFFICE_DISTANCE_TRAVELLED',
                   'VILLAGE_TO_MAYOROFFICE_TRAVEL_TIME_HOUR',
                   'HEADOFFICE_MAYOROFFICE_TRAVEL_TIME_MINUTE',
                   'VILLAGE_TO_MAYOROFFICE_TRAVEL_COST',  
                   'VILLAGE_TO_NEXTCLOSEST_DISTRICTOFFICE_TRANSPORTATION',
                   'VILLAGE_TO_NEXTCLOSEST_DISTRICTOFFICE_TYPE_PUBLICTRANSPORT',
                   'VILLAGE_TO_NEXTCLOSEST_DISTRICTOFFICE_MAIN_PUBLICTRANSPORT',
                   'VILLAGE_TO_NEXTCLOSEST_DISTRICTOFFICE_DISTANCE_TRAVELLED',
                   'VILLAGE_TO_NEXTCLOSEST_DISTRICTOFFICE_TRAVEL_TIME_HOUR',
                   'VILLAGE_TO_NEXTCLOSEST_DISTRICTOFFICE_TRAVEL_TIME_MINUTE',
                   'VILLAGE_TO_NEXTCLOSEST_DISTRICTOFFICE_TRAVEL_COST', 
                   'VILLAGE_TO_NEXTCLOSEST_MAYOROFFICE_TRANSPORTATION',
                   'VILLAGE_TO_NEXTCLOSEST_MAYOROFFICE_TYPE_PUBLICTRANSPORT',
                   'VILLAGE_TO_NEXTCLOSEST_MAYOROFFICE_MAIN_PUBLICTRANSPORT',
                   'VILLAGE_TO_NEXTCLOSEST_MAYOROFFICE_DISTANCE_TRAVELLED',
                   'VILLAGE_TO_NEXTCLOSEST_MAYOROFFICE_TRAVEL_TIME_HOUR',
                   'VILLAGE_TO_NEXTCLOSEST_MAYOROFFICE_TRAVEL_TIME_MINUTE',
                   'VILLAGE_TO_NEXTCLOSEST_MAYOROFFICE_TRAVEL_COST',  
                   'NUM_FAMILIES_WITH_LANDLINES', #
                   'CITIZENS_OWN_CELLPHONES', #
                   'INTERNET_CAFES',
                   'BASE_TRANSCEIVER_STATIONS', #
                   'MOBILE_PHONE_SERVICE_OPERATORS',#
                   'STRENGTH_OF_CELLPHONE_SIGNALS', #
                   'TYPE_OF_INTERNET_SIGNAL', #
                   'COMPUTER_IN_VILLAGE_HEADOFFICE', 
                   'INTERNET_FACILITIES_IN_VILLAGE_HEADOFFICE',
                   'POST_OFFICE', #
                   'MOBILE_POSTOFFICE', #
                   'PRIVATE_DELIVERY_COURIER', #
                   'RECEIVE_NATIONAL_TV', 
                   'ON_CABLE_TV_NATIONAL_TV', 
                   'RECEIVE_REGIONAL_TV',
                   'ON_CABLE_TV_REGIONAL_TV',                   
                   'RECEIVE_PRIVATE_TV',
                   'ON_CABLE_TV_PRIVATE_TV',
                   'RECEIVE_OVERSEAS_TV',
                   'ON_CABLE_TV_OVERSEAS_TV',
                   'RECEIVE_NATIONAL_RADIO',
                   'RECEIVE_REGIONAL_RADIO',
                   'RECEIVE_PRIVARE_RADIO',
                   'NUM_LEATHER_INDUSTRY', 
                   'NUM_WOOD_INDUSTRY',
                   'NUM_METAL_INDUSTRY',
                   'NUM_FABRIC_INDUSTRY',
                   'NUM_POTTERY_INDUSTRY',
                   'NUM_BAMBOORATTAN_INDUSTRY',
                   'NUM_FOOD_INDUSTRY',
                   'NUM_OTHERS_INDUSTRY',
                   'NUM_INDUSTRIAL_CENTERS',
                   'NUM_SMALL_INDUSTRIES_ECOSYSTEM',
                   'NUM_SMALL_INDUSTRIAL_VILLAGES',
                   'KEROSENE_SELLERS',
                   'LPG_SELLERS',
                   'VILLAGE_COOPERATIVE',
                   'AGRICULTURE_VILLAGE_COOPERATIVE',
                   'CREDITLOAN_VILLAGE_COOPERATIVE',
                   'OTHER_VILLAGE_COOPERATIVE',
                   'SMALL_INDUSTRIAL_COOPERATIVE_NONKUD',
                   'CREDITSAVINGS_COOPERATIVE_NONKUD',
                   'OTHER_COOPERATIVE_NONKUD',
                   'AGRICULTURE_SHOPS_KUD_OWNED',
                   'AGRICULTURE_SHOPS_BUM_OWNED',
                   'AGRICULTURE_SHOPS_OTHER_OWNED', 
                   'NUM_SHOPHOUSE',
                   'DISTANCE_TO_NEAREST_SHOPHOUSE',
                   'SHOPHOUSE_ACCESSIBILITY',
                   'NUM_PERMANENT_MARKET',
                   'DISTANCE_TO_NEAREST_PERMANENT_MARKET',
                   'PERMANENT_MARKET_ACCESSIBILITY',
                   'NUM_SEMIPERMANENT_MARKET',
                   'DISTANCE_TO_NEAREST_SEMIPERMANENT_MARKET',
                   'SEMIPERMANENT_MARKET_ACCESSIBILITY',
                   'NUM_MARKET_NOBUILDINGS',
                   'DISTANCE_TO_NEAREST_MARKET_NOBUILDINGS',
                   'MARKET_NOBUILDINGS_ACCESSIBILITY',  
                   'NUM_MINIMART',
                   'DISTANCE_TO_NEAREST_MINIMART',
                   'MINIMART_ACCESSIBILITY',
                   'NUM_BIGGER_WARUNG',
                   'DISTANCE_TO_NEAREST_BIGGER_WARUNG',
                   'BIGGER_WARUNG_ACCESSIBILITY',   
                   'NUM_SMALLER_WARUNG',
                   'DISTANCE_TO_NEAREST_SMALLER_WARUNG',
                   'SMALLER_WARUNG_ACCESSIBILITY',         
                   'NUM_RESTAURANTS',
                   'DISTANCE_TO_NEAREST_RESTAURANTS',
                   'RESTAURANTS_ACCESSIBILITY',  
                   'NUM_FOODSTALLS',
                   'DISTANCE_TO_NEAREST_FOODSTALLS',
                   'FOODSTALLS_ACCESSIBILITY',  
                   'NUM_HOTELS',
                   'DISTANCE_TO_NEAREST_HOTELS',
                   'HOTELS_ACCESSIBILITY',                    
                   'NUM_LODGING_PLACES',
                   'DISTANCE_TO_NEAREST_LODGING_PLACES',
                   'LODGING_PLACES_ACCESSIBILITY', 
                   'PEOPLE_BUSINESS_CREDIT', 
                   'ENERGY_FOOD_CREDIT', 
                   'SMALL_BUSINESS_CREDIT', 
                   'JOINT_FAMILY_GROUP', 
                   'NUM_GOVT_BANKS',
                   'DISTANCE_TO_NEAREST_GOVT_BANKS',
                   'GOVT_BANKS_ACCESSIBILITY',
                   'NUM_COMMERCIAL_BANKS',
                   'DISTANCE_TO_NEAREST_COMMERCIAL_BANKS',
                   'COMMERCIAL_BANKS_ACCESSIBILITY',   
                   'NUM_RURAL_CREDIT_BANKS',
                   'DISTANCE_TO_NEAREST_RURAL_BANKS',
                   'RURAL_CREDIT_BANKS_ACCESSIBILITY',  
                   'BMT',
                   'DISTANCE_TO_NEAREST_BMT',
                   'BMT_ACCESSIBILITY',
                   'PAWNSHOPS',
                   'DISTANCE_TO_NEAREST_PAWNSHOP',
                   'PAWNSHOP_ACCESSIBILITY',
                   'ATM',
                   'DISTANCE_TO_NEAREST_ATM',
                   'ATM_ACCESSIBILITY',
                   'CAR_SHOP',
                   'DISTANCE_TO_NEAREST_CAR_SHOP',
                   'CAR_SHOP_ACCESSIBILITY',
                   'BEAUTY_SALON',
                   'DISTANCE_TO_NEAREST_BEAUTY_SALON',
                   'BEAUTY_SALON_ACCESSIBILITY',
                   'TRAVEL_AGENCY',
                   'DISTANCE_TO_NEAREST_TRAVEL_AGENCY',
                   'TRAVEL_AGENCY_ACCESSIBILITY', 
                   'BANK_AGENT',
                   'DISTANCE_TO_NEAREST_BANK_AGENT',
                   'BANK_AGENT_ACCESSIBILITY'
)
                   
```

```{r}
colnames(podes3) <- var_meaning3
```

```{r}
podes3_final <- podes3 %>%
  select("SHAPE", 
         "PROVINCE_ID", 
         "PROVINCE", 
         "CITY_ID", 
         "CITY", 
         "DISTRICT_ID", 
         "DISTRICT", 
         "VILLAGE_ID", 
         "VILLAGE",
         # 'IS_MULTI_ETHNIC',
         # 'IS_MULTILINGUAL',
         # 'CULTURAL_RESERVE_SITES',
         # 'COMMUNAL_SPACES',
         # 'COMMUNAL_ACTIVITIES',
         # 'COMMUNAL_ACTIVITIES_HELPING_OTHER_VILLAGERS', 
         # 'NUM_FAMILY_EDUCATION_ORGS',
         # 'NUM_YOUTH_ORGS', #
         # 'NUM_TRADITIONAL_ORGS', #
         # 'NUM_FARMING_ORGS', #
         # 'NUM_WATER_MANAGEMENT_ORGS', #
         # 'NUM_COMMUNITY_ORGS', # 
         'TRANSPORTATION_METHODS', #
         'ROAD_MATERIAL',
         'ROAD_ACCESSIBLE_BY_4_WHEEL_VEHICLE', #
         'PUBLIC_TRANSPORT', #
         'PUBLIC_TRANSPORT_DAILY_OPERATION', #
         # 'PUBLIC_TRANSPORT_OPERATION_TIME', #
         'NUM_FAMILIES_WITH_LANDLINES', #
         'CITIZENS_OWN_CELLPHONES', #
         'INTERNET_CAFES',
         'BASE_TRANSCEIVER_STATIONS', #
         'MOBILE_PHONE_SERVICE_OPERATORS',#
         'STRENGTH_OF_CELLPHONE_SIGNALS', #
         # 'TYPE_OF_INTERNET_SIGNAL', #
         # 'COMPUTER_IN_VILLAGE_HEADOFFICE', 
         # 'INTERNET_FACILITIES_IN_VILLAGE_HEADOFFICE',
         'POST_OFFICE', #
         'MOBILE_POSTOFFICE', #
         'PRIVATE_DELIVERY_COURIER', #
         'NUM_LEATHER_INDUSTRY', 
         'NUM_WOOD_INDUSTRY',
         'NUM_METAL_INDUSTRY',
         'NUM_FABRIC_INDUSTRY',
         'NUM_POTTERY_INDUSTRY',
         'NUM_BAMBOORATTAN_INDUSTRY',
         'NUM_FOOD_INDUSTRY',
         'NUM_OTHERS_INDUSTRY',
         'NUM_INDUSTRIAL_CENTERS',
         'NUM_SMALL_INDUSTRIES_ECOSYSTEM',
         'NUM_SMALL_INDUSTRIAL_VILLAGES',
         # 'KEROSENE_SELLERS',
         # 'LPG_SELLERS',
         'VILLAGE_COOPERATIVE',
         'AGRICULTURE_VILLAGE_COOPERATIVE',
         'CREDITLOAN_VILLAGE_COOPERATIVE',
         # 'OTHER_VILLAGE_COOPERATIVE',
         'SMALL_INDUSTRIAL_COOPERATIVE_NONKUD',
         'CREDITSAVINGS_COOPERATIVE_NONKUD',
         # 'OTHER_COOPERATIVE_NONKUD',
         # 'AGRICULTURE_SHOPS_KUD_OWNED',
         # 'AGRICULTURE_SHOPS_BUM_OWNED',
         # 'AGRICULTURE_SHOPS_OTHER_OWNED', 
         'NUM_SHOPHOUSE',
         'SHOPHOUSE_ACCESSIBILITY',
         'NUM_PERMANENT_MARKET',
         'PERMANENT_MARKET_ACCESSIBILITY',
         'NUM_SEMIPERMANENT_MARKET',
         'SEMIPERMANENT_MARKET_ACCESSIBILITY',
         'NUM_MARKET_NOBUILDINGS',
         'MARKET_NOBUILDINGS_ACCESSIBILITY',  
         'NUM_MINIMART',
         'MINIMART_ACCESSIBILITY',
         'NUM_BIGGER_WARUNG',
         'BIGGER_WARUNG_ACCESSIBILITY',   
         'NUM_SMALLER_WARUNG',
         'SMALLER_WARUNG_ACCESSIBILITY',            
         'NUM_RESTAURANTS',
         'RESTAURANTS_ACCESSIBILITY',  
         'NUM_FOODSTALLS',
         'FOODSTALLS_ACCESSIBILITY',  
         'NUM_HOTELS',
         'HOTELS_ACCESSIBILITY',                    
         'NUM_LODGING_PLACES',
         'LODGING_PLACES_ACCESSIBILITY', 
         'PEOPLE_BUSINESS_CREDIT', 
         'ENERGY_FOOD_CREDIT', 
         'SMALL_BUSINESS_CREDIT', 
         'JOINT_FAMILY_GROUP', 
         'NUM_GOVT_BANKS',
         'GOVT_BANKS_ACCESSIBILITY',
         'NUM_COMMERCIAL_BANKS',
         'COMMERCIAL_BANKS_ACCESSIBILITY',   
         'NUM_RURAL_CREDIT_BANKS',
         'RURAL_CREDIT_BANKS_ACCESSIBILITY',  
         'BMT',
         'BMT_ACCESSIBILITY',
         'ATM',
         'ATM_ACCESSIBILITY',
         # 'CAR_SHOP',
         # 'CAR_SHOP_ACCESSIBILITY', 
         'BANK_AGENT',
         # 'DISTANCE_TO_NEAREST_BANK_AGENT',
         'BANK_AGENT_ACCESSIBILITY'
)
```


```{r}
head(podes3_final)
```

```{r}
summary(podes3_final)
```

Observations:

- Only 2 villages are non-multiethnic the rest 382 villages are and 333 villages are multilingual as well

- The distribution of organizations in East Kalimantan is skewed, some villages have 49 community organizations while the mean is only 1
there are also 71 family welfare organization in one village while the mean is only 2 per village

- Good cellphone penetration rate as majority of the villagers have cellphones  where the strength of the signals are relatively strong

- While there are good computer utilities in village head offices, only around 3/4 have internet

- The leading industry in East Kalimantan are food industry and fabric industry as both have the 2 highest mean value



### 3.5.4 PODES 2018 part 4 (security,)


```{r}
glimpse(podes4)
```

```{r}
podes4%>% 
  select_if(function(x) any(is.na(x))) %>% 
  summarise_each(funs(sum(is.na(.)))) -> NA_column

NA_column
```

- Security

Changing variable "R1301A" - Massive Fighting Incident in the village/sub-district during the last year. 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301A = recode_factor(as.vector(podes4$R1301A), `1` = 1 , `2` = 0 ))
```


Changing variable "R1301B1K3" - If Massive Fighting Incident happened among the Community Groups and there are **casualty (Died)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B1K3 = recode_factor(as.vector(podes4$R1301B1K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1301B1K4" - If Massive Fighting Incident happened among the Community Groups and there are **casualty (Injured)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B1K4 = recode_factor(as.vector(podes4$R1301B1K4), `1` = 1 , `2` = 0 ))
```

Changing variable "R1301B1K5" - *Cause* of different types of Massive Fighting Incident. 
This can be multiple entry. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B1K5 = recode_factor(as.vector(podes4$R1301B1K5), `1` = "PROPERTY" , `2` = "POWER", `4` = "LOVE", `8` = "IDEOLOGY/FAITH", `16` = " SPORTS/ENTERTAINMENT/OTHERS", `32` = "DISSATISFACTION OVER POLICY/SERVICE", `64` = "OTHERS" ))
```




Changing variable "R1301B2K3" - If Massive Fighting Incident happened among the Between Rural Communities and there are **casualty (Died)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B2K3 = recode_factor(as.vector(podes4$R1301B2K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1301B2K4" - If Massive Fighting Incident happened among the Between Rural Communities and there are **casualty (Injured)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B2K4 = recode_factor(as.vector(podes4$R1301B2K4), `1` = 1 , `2` = 0 ))
```

Changing variable "R1301B2K5" - *Cause* of different types of Massive Fighting Incident. 
This can be multiple entry. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B2K5 = recode_factor(as.vector(podes4$R1301B2K5), `1` = "PROPERTY" , `2` = "POWER", `4` = "LOVE", `8` = "IDEOLOGY/FAITH", `16` = " SPORTS/ENTERTAINMENT/OTHERS", `32` = "DISSATISFACTION OVER POLICY/SERVICE", `64` = "OTHERS" ))
```


Variables "R1301B3K3", "R1301B3K4", "R1301B3K5" are not included as all rows are registered as NA. 




Changing variable "R1301B4K3" - If Massive Fighting Incident happened among the society and Government officials and there are **casualty (Died)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0


Changing variable "R1301B4K4" - If Massive Fighting Incident happened among the society and Government officials and there are **casualty (Injured)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0



Changing variable "R1301B4K5" - *Cause* of different types of Massive Fighting Incident. 
This can be multiple entry. 




Changing variable "R1301B5K3" - If Massive Fighting Incident happened among students and there are **casualty (Died)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B5K3 = recode_factor(as.vector(podes4$R1301B5K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1301B5K4" - If Massive Fighting Incident happened among students and there are **casualty (Injured)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B5K4 = recode_factor(as.vector(podes4$R1301B5K4), `1` = 1 , `2` = 0 ))
```

Changing variable "R1301B5K5" - *Cause* of different types of Massive Fighting Incident. 
This can be multiple entry. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B5K5 = recode_factor(as.vector(podes4$R1301B5K5), `1` = "PROPERTY" , `2` = "POWER", `4` = "LOVE", `8` = "IDEOLOGY/FAITH", `16` = " SPORTS/ENTERTAINMENT/OTHERS", `32` = "DISSATISFACTION OVER POLICY/SERVICE", `64` = "OTHERS" ))
```



Changing variable "R1301B6K3" - If Massive Fighting Incident happened among ethnic group and there are **casualty (Died)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0



Changing variable "R1301B6K4" - If Massive Fighting Incident happened among ethnic group and there are **casualty (Injured)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0


Changing variable "R1301B6K5" - *Cause* of different types of Massive Fighting Incident. 
This can be multiple entry. 




Changing variable "R1301B7K3" - If Massive Fighting Incident of others type happened and there are **casualty (Died)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B7K3 = recode_factor(as.vector(podes4$R1301B7K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1301B7K4" - If Massive Fighting Incident of others type happened and there are **casualty (Injured)** . 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B7K4 = recode_factor(as.vector(podes4$R1301B7K4), `1` = 1 , `2` = 0 ))
```

Changing variable "R1301B7K5" - *Cause* of different types of Massive Fighting Incident. 
This can be multiple entry. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1301B7K5 = recode_factor(as.vector(podes4$R1301B7K5), `1` = "PROPERTY" , `2` = "POWER", `4` = "LOVE", `8` = "IDEOLOGY/FAITH", `16` = " SPORTS/ENTERTAINMENT/OTHERS", `32` = "DISSATISFACTION OVER POLICY/SERVICE", `64` = "OTHERS" ))
```

Changing variable "R1302A" - The most frequently occurring Mass Fighting Incident (based on the highest occurrence of fighting incident type) and how well are they being dealt with. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1302A = recode_factor(as.vector(podes4$R1302A), `1` = "YES ALL OF THEM" , `2` = "YES A FEW OF THEM", `3` = "NO" ))
```


Changing variable "R1302B" - The effort to resolve the mass fighting incident is dealt by: (may choose more than one)

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1302B = recode_factor(as.vector(podes4$R1302B), `1` = "SECURITY FORCE", `2` = "GOVERNMENT OFFICIAL", `4` = "COMMUNITY FIGURE", `8` = "RELIGIOUS FIGURE", `16` = "OTHERS", `32` = "NONE" ))
```




Changing variable "R1303A01K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Theft).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A01K3 = recode_factor(as.vector(podes4$R1303A01K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A01K4" - If there is Theft, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A01K4 = recode_factor(as.vector(podes4$R1303A01K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```



Changing variable "R1303A02K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Robbery).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A02K3 = recode_factor(as.vector(podes4$R1303A02K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A02K4" - If there is Robbery, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A02K4 = recode_factor(as.vector(podes4$R1303A02K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```


Changing variable "R1303A03K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Fraud/Embezzlement).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A03K3 = recode_factor(as.vector(podes4$R1303A03K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A03K4" - If there is Fraud/Embezzlement, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A03K4 = recode_factor(as.vector(podes4$R1303A03K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```



Changing variable "R1303A04K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Persecution).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A04K3 = recode_factor(as.vector(podes4$R1303A04K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A04K4" - If there is Persecution, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A04K4 = recode_factor(as.vector(podes4$R1303A04K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```




Changing variable "R1303A05K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Arson).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A05K3 = recode_factor(as.vector(podes4$R1303A05K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A05K4" - If there is Arson, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A05K4 = recode_factor(as.vector(podes4$R1303A05K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```




Changing variable "R1303A06K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Rape/Crime Against Decency).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A06K3 = recode_factor(as.vector(podes4$R1303A06K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A06K4" - If there is Rape/Crime Against Decency, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A06K4 = recode_factor(as.vector(podes4$R1303A06K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```



Changing variable "R1303A07K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Drug Abuse/Drug Trafficking).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A07K3 = recode_factor(as.vector(podes4$R1303A07K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A07K4" - If there is Drug Abuse/Drug Trafficking, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A07K4 = recode_factor(as.vector(podes4$R1303A07K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```



Changing variable "R1303A08K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Gambling).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A08K3 = recode_factor(as.vector(podes4$R1303A08K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A08K4" - If there is Gambling, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A08K4 = recode_factor(as.vector(podes4$R1303A08K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```



Changing variable "R1303A09K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Murder).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A09K3 = recode_factor(as.vector(podes4$R1303A09K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A09K4" - If there is Murder, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A09K4 = recode_factor(as.vector(podes4$R1303A09K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```



Changing variable "R1303A10K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Trafficking).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A10K3 = recode_factor(as.vector(podes4$R1303A10K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A10K4" - If there is Trafficking, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A10K4 = recode_factor(as.vector(podes4$R1303A10K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```



Changing variable "R1303A11K3" - Crime type that happened in the village that Most Often Occur Within Last Year (Corruption).  1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A11K3 = recode_factor(as.vector(podes4$R1303A11K3), `1` = 1 , `2` = 0 ))
```

Changing variable "R1303A11K4" - If there is Corruption, what is the trend of the crime compared to a year ago. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303A11K4 = recode_factor(as.vector(podes4$R1303A11K4), `1` = "REDUCING" , `2` = "SAME", `3` = "INCREASING" ))
```




Changing variable "R1303B" - Highest number of crime (type)

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1303B = recode_factor(as.vector(podes4$R1303B), `1` = "THEFT" , `2` = "ROBBERY", `3` = "FRAUD_EMBEZZLEMENT", `4` = "PERSECUTION", `5` = "ARSON", `6` = "RAPE_CRIME_AGAINST_DECENCY", `7` = "DRUG_ABUSE_TRAFFICKING", `8` = "GAMBLING", `9` = "MURDER", `10` = "TRAFFICKING", `11` = "CORRUPTION"))
```




Changing variable "R1304A" - Villagers activity (BUILDING_MAINTENANCE_SECURITY_POST) in maintaining the security community in the village within last year. 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1304A = recode_factor(as.vector(podes4$R1304A), `1` = 1 , `2` = 0 ))
```


Changing variable "R1304B" - Villagers activity (ESTABLISHING_SECURITY_GUARD) in maintaining the security community in the village within last year. 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1304B = recode_factor(as.vector(podes4$R1304B), `3` = 1 , `4` = 0 ))
```


Changing variable "R1304C" - Villagers activity (RAISING_CIVIL_DEFENSE) in maintaining the security community in the village within last year. 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1304C = recode_factor(as.vector(podes4$R1304C), `5` = 1 , `6` = 0 ))
```


Changing variable "R1304D" - Villagers activity (REPORTING_GUEST_STAY_MORE_THAN_24_HOURS) in maintaining the security community in the village within last year. 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1304D = recode_factor(as.vector(podes4$R1304D), `7` = 1 , `8` = 0 ))
```



Changing variable "R1304E" - Villagers activity ("ACTIVATION_OF_SECURITY_SYSTEM_FROM_CITIZEN_INITIATIVE"
) in maintaining the security community in the village within last year. 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1304E = recode_factor(as.vector(podes4$R1304E), `1` = 1 , `2` = 0 ))
```


Changing variable "R1306A" - Existence of police station (police office) in the village. 1 means Yes and 2 means No, we will change yes to 1 and no to 0

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1306A = recode_factor(as.vector(podes4$R1306A), `1` = 1 , `2` = 0 ))
```


 
Changing variable "R1306C2" - Convenience to reach the nearest police station. 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1306C2 = recode_factor(as.vector(podes4$R1306C2), `1` = "VERY EASY" , `2` = "EASY", `3` = "DIFFICULT", `4` = "VERY DIFFICULT" ))
```



Changing variable "R1308A" - Convenience to location of street children gathered/hangout in village

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1308A = recode_factor(as.vector(podes4$R1308A), `1` = 1 , `2` = 0))
```



Changing variable "R1308B" - Convenience to hangout places for the homeless/beggar in village

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1308B = recode_factor(as.vector(podes4$R1308B), `3` = 1 , `4` = 0))
```


Changing variable "R1309" - Convenience to Localization/Location of Commercial Sex
Workers

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1309 = recode_factor(as.vector(podes4$R1309), `1` = 1 , `2` = 0))
```


Changing variable "R1403A" - Availability of village information

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1403A = recode_factor(as.vector(podes4$R1403A), `1` = "YES RENEWED" , `2` = "YES NOT RENEWED", `3` = "NONE"))
```


Changing variable "R1403B" - Usage of village financial system

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1403B = recode_factor(as.vector(podes4$R1403B), `1` = "YES RENEWED" , `2` = "YES NOT RENEWED", `3` = "NONE"))
```


Changing variable "R1404B" - Village Owned Enterprise, village land;

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1404B = recode_factor(as.vector(podes4$R1404B), `1` = 1 , `2` = 0))
```

Changing variable "R1404C" - VILLAGE BUILDINGS (VILLAGE HALL)

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1404C = recode_factor(as.vector(podes4$R1404C), `1` = "YES IN USE" , `2` = "YES NOT IN USE", `3` = "NO"))
```


Changing variable "R1404D" - VILLAGE MARKET(ANIMAL MARKET, FISH AUCTION, AGRICULTURAL PRODUCTS AUCTIONS, ETC)

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1404D = recode_factor(as.vector(podes4$R1404D), `1` = "YES FUNCTIONAL" , `2` = "YES NOT FUNCTIONAL", `3` = "NO"))
```



Changing variable "R1404E" - OTHER VILLAGE ASSETS

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1404E = recode_factor(as.vector(podes4$R1404E), `1` = 1 , `2` = 0))
```


Changing variable "R1405A1" - VILLAGE
MEDIUM-TERM DEVELOPMENT PLAN (RPJM) THAT HAPPENED

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1405A1 = recode_factor(as.vector(podes4$R1405A1), `1` = 1 , `2` = 0))
```


Changing variable "R1405B" - Village Government Work Plan 2018

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1405B = recode_factor(as.vector(podes4$R1405B), `3` = 1 , `4` = 0))
```



Changing variable "R1406A" - AVAILABILITY OF
VILLAGE COOPERATION BETWEEN VILLAGES IN 2018

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1406A = recode_factor(as.vector(podes4$R1406A), `1` = 1 , `2` = 0))
```


Changing variable "R1406B" - AVAILABILITY OF
VILLAGE COOPERATION WITH THIRD PARTIES IN 2018

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1406B = recode_factor(as.vector(podes4$R1406B), `3` = 1 , `4` = 0))
```


Changing variable "R1407" - AVAILABILITY OF VILLAGE ASSISTANCE

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1407 = recode_factor(as.vector(podes4$R1407), `1` = "YES ACTIVE" , `2` = "YES NOT ACTIVE", `3` = "NO"))
```

- development and empowerment of village

Changing variable "R1601A1K2" - TRANSPORTATION INFRASTRUCTURE DEVELOPMENT

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A1K2 = recode_factor(as.vector(podes4$R1601A1K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A1K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A1K3 = recode_factor(as.vector(podes4$R1601A1K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A1K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A1K4 = recode_factor(as.vector(podes4$R1601A1K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A1K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A1K5 = recode_factor(as.vector(podes4$R1601A1K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A2K2" - ENERGY INFRASTRUCTURE

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A2K2 = recode_factor(as.vector(podes4$R1601A2K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A2K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A2K3 = recode_factor(as.vector(podes4$R1601A2K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A2K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A2K4 = recode_factor(as.vector(podes4$R1601A2K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A2K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A2K5 = recode_factor(as.vector(podes4$R1601A2K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A3K2" - "INFORMATION_COMMUNICATION_INFRASTRUCTURE"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A2K2 = recode_factor(as.vector(podes4$R1601A2K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A3K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A2K3 = recode_factor(as.vector(podes4$R1601A2K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A3K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A2K4 = recode_factor(as.vector(podes4$R1601A2K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A3K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A2K5 = recode_factor(as.vector(podes4$R1601A2K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A4K2" - "SANITATION_INFRASTRUCTURE"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A4K2 = recode_factor(as.vector(podes4$R1601A4K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A4K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A4K3 = recode_factor(as.vector(podes4$R1601A4K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A4K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A4K4 = recode_factor(as.vector(podes4$R1601A4K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A4K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A4K5 = recode_factor(as.vector(podes4$R1601A4K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

5)
Changing variable "R1601A5K2" - "EDUCATION_CULTURE_HEALTH_INFRASTRUCTURE"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A5K2 = recode_factor(as.vector(podes4$R1601A5K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A5K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A5K3 = recode_factor(as.vector(podes4$R1601A5K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A5K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A5K4 = recode_factor(as.vector(podes4$R1601A5K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A5K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A5K5 = recode_factor(as.vector(podes4$R1601A5K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```


Changing variable "R1601A6K2" - "TRADING_SERVICES_INFRASTRUCTURE"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A6K2 = recode_factor(as.vector(podes4$R1601A6K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A6K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A6K3 = recode_factor(as.vector(podes4$R1601A6K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A6K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A6K4 = recode_factor(as.vector(podes4$R1601A6K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A6K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A6K5 = recode_factor(as.vector(podes4$R1601A6K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```


Changing variable "R1601A7K2" - "FARMING_PRODUCTION_VILLAGE_SMALL_INDUSTRY_INFRASTRUCTURE"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A7K2 = recode_factor(as.vector(podes4$R1601A7K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A7K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A7K3 = recode_factor(as.vector(podes4$R1601A7K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A7K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A7K4 = recode_factor(as.vector(podes4$R1601A7K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A7K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A7K5 = recode_factor(as.vector(podes4$R1601A7K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A8K2" - "RECREATION_TOURISM_INFRASTRUCTURE"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A8K2 = recode_factor(as.vector(podes4$R1601A8K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A8K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A8K3 = recode_factor(as.vector(podes4$R1601A8K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A8K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A8K4 = recode_factor(as.vector(podes4$R1601A8K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A8K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A8K5 = recode_factor(as.vector(podes4$R1601A8K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A9K2" - "DISASTER_MGMT_ENV_CONSERVATION_INFRASTRUCTURE"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A9K2 = recode_factor(as.vector(podes4$R1601A9K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A9K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A9K3 = recode_factor(as.vector(podes4$R1601A9K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A9K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A9K4 = recode_factor(as.vector(podes4$R1601A9K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A9K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A9K5 = recode_factor(as.vector(podes4$R1601A9K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A10K2" - "GOV_SUPPORT_INFRASTRUCTURE"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A10K2 = recode_factor(as.vector(podes4$R1601A10K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601A10K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A10K3 = recode_factor(as.vector(podes4$R1601A10K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601A10K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A10K4 = recode_factor(as.vector(podes4$R1601A10K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601A10K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601A10K5 = recode_factor(as.vector(podes4$R1601A10K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```


- EMPOWERMENT
  
Changing variable "R1601B1K2" - "EDU_HEALTH_PUBLIC_CULTURE_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B1K2 = recode_factor(as.vector(podes4$R1601B1K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B1K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B1K3 = recode_factor(as.vector(podes4$R1601B1K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B1K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B1K4 = recode_factor(as.vector(podes4$R1601B1K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B1K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B1K5 = recode_factor(as.vector(podes4$R1601B1K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

2)
Changing variable "R1601B2K2" - "VILLAGE_RESIDENTIAL_NEIGHBOURHOOD_MGMT_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B2K2 = recode_factor(as.vector(podes4$R1601B2K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B2K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B2K3 = recode_factor(as.vector(podes4$R1601B2K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B2K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B2K4 = recode_factor(as.vector(podes4$R1601B2K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B2K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B2K5 = recode_factor(as.vector(podes4$R1601B2K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

3) 
Changing variable "R1601B3K2" - "VILLAGE_TRANSPORTATION_MGMT_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B3K2 = recode_factor(as.vector(podes4$R1601B3K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B3K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B3K3 = recode_factor(as.vector(podes4$R1601B3K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B3K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B3K4 = recode_factor(as.vector(podes4$R1601B3K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B3K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B3K5 = recode_factor(as.vector(podes4$R1601B3K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

4)
Changing variable "R1601B4K2" - "RENEWABLE_ENERGY_DEVELOPMENT_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B4K2 = recode_factor(as.vector(podes4$R1601B4K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B4K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B4K3 = recode_factor(as.vector(podes4$R1601B4K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B4K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B4K4 = recode_factor(as.vector(podes4$R1601B4K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B4K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B4K5 = recode_factor(as.vector(podes4$R1601B4K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

5)
Changing variable "R1601B5K2" - "INFORMATION_COMMUNICATION_MGMT_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B5K2 = recode_factor(as.vector(podes4$R1601B5K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B5K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B5K3 = recode_factor(as.vector(podes4$R1601B5K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B5K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B5K4 = recode_factor(as.vector(podes4$R1601B5K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B5K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B5K5 = recode_factor(as.vector(podes4$R1601B5K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B6K2" - "AGRI_BASED_PRODUCTIVE_BUSI_NON_AGRI_VILLAGE_SMALL_BUSI_MGMT_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B6K2 = recode_factor(as.vector(podes4$R1601B6K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B6K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B6K3 = recode_factor(as.vector(podes4$R1601B6K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B6K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B6K4 = recode_factor(as.vector(podes4$R1601B6K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B6K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B6K5 = recode_factor(as.vector(podes4$R1601B6K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B7K2" - "NATURE_CONSERVE_AWARENESS_DISASTER_MGMT_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B7K2 = recode_factor(as.vector(podes4$R1601B7K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B7K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B7K3 = recode_factor(as.vector(podes4$R1601B7K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B7K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B7K4 = recode_factor(as.vector(podes4$R1601B7K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B7K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B7K5 = recode_factor(as.vector(podes4$R1601B7K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B8K2" - "COMMUNITY_ROLE_IMPROVE_VILLAGE_GOVERNANCE_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B8K2 = recode_factor(as.vector(podes4$R1601B8K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B8K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B8K3 = recode_factor(as.vector(podes4$R1601B8K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B8K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B8K4 = recode_factor(as.vector(podes4$R1601B8K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B8K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B8K5 = recode_factor(as.vector(podes4$R1601B8K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B9K2" - "QUALITY_CAPACITY_OF_VILLAGE_COMMUNITY_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B9K2 = recode_factor(as.vector(podes4$R1601B9K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B9K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B9K3 = recode_factor(as.vector(podes4$R1601B9K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B9K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B9K4 = recode_factor(as.vector(podes4$R1601B9K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B9K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B9K5 = recode_factor(as.vector(podes4$R1601B9K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

10)
Changing variable "R1601B10K2" - "ESTABLISHMENT_DEVELOPMENT_VILLAGE_GOV_ENTERPRISE_EMPOWERMENT"

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B10K2 = recode_factor(as.vector(podes4$R1601B10K2), `1` = 1 , `2` = 0))
```


Changing variable "R1601B10K3" - "SOURCE_OF_FUND" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B10K3 = recode_factor(as.vector(podes4$R1601B10K3), `1` = "PROVINCIAL REGENCY MUNICIPALITY BUDGET", `2` = "VILLAGE GENERATED REVENUE", `4` = "COMMUNITY", `8` = "OTHERS" ))
```

Changing variable "R1601B10K4" - "ADMINISTRATOR" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B10K4 = recode_factor(as.vector(podes4$R1601B10K4), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

Changing variable "R1601B10K5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1601B10K5 = recode_factor(as.vector(podes4$R1601B10K5), `1` = "POOR POPULATION", `2` = "FARMERS FISHERMAN", `4` = "COMMUNITY BUSINESS GROUP", `8` = "MAJORITY CITIZENS", `16` = "PRIVATE", `32` = "OTHERS" ))
```

- INFORMATION OF VILLAGE GOVERNMENT AGENCY 

EXISTENCE OF VILLAGE HEAD AND SECRETARY 


Changing variable "R1701AK2" - "VILLAGE_HEAD_EXISTENCE" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1701AK2 = recode_factor(as.vector(podes4$R1701AK2), `1` = 1 , `2` = 0 ))
```


Changing variable "R1701AK4" - "GENDER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1701AK4 = recode_factor(as.vector(podes4$R1701AK4), `1` = 1 , `2` = 0 ))
```

Changing variable "R1701AK5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1701AK5 = recode_factor(as.vector(podes4$R1701AK5), `1` = "NEVER SCHOOLED", `2` = "NEVER FINISHED ELEMENTARY SCHOOL", `3` = "FINISHED ELEMENTARY SCHOOL", `4` = "JUNIOR HIGH SCHOOL", `5` = "SENIOR HIGH SCHOOL", `6` = "ACADEMY ASSOCIATE DEGREE", `7` = "BACHELOR DEGREE UNDERGRADUATE", `8` = "GRADUATE", `9` = "POST GRADUATE" ))
```


Changing variable "R1701BK2" - "VILLAGE_SECRETARY_EXISTENCE" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1701BK2 = recode_factor(as.vector(podes4$R1701BK2), `1` = 1 , `2` = 0 ))
```


Changing variable "R1701BK4" - "GENDER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1701BK4 = recode_factor(as.vector(podes4$R1701BK4), `1` = 1 , `2` = 0 ))
```

Changing variable "R1701BK5" - "DIRECT_BENEFIT_RECEIVER" 

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4 <- podes4 %>% mutate(R1701BK5 = recode_factor(as.vector(podes4$R1701BK5), `1` = "NEVER SCHOOLED", `2` = "NEVER FINISHED ELEMENTARY SCHOOL", `3` = "FINISHED ELEMENTARY SCHOOL", `4` = "JUNIOR HIGH SCHOOL", `5` = "SENIOR HIGH SCHOOL", `6` = "ACADEMY ASSOCIATE DEGREE", `7` = "BACHELOR DEGREE UNDERGRADUATE", `8` = "GRADUATE", `9` = "POST GRADUATE" ))
```

TOTAL NUMBER OF GOVERNMENT AGENCIES 

```{r}
head(podes4)
```

```{r}
var_meaning4 <- c("SHAPE",
         "PROVINCE_ID",
         "PROVINCE",
         "CITY_ID",
         "CITY",
         "DISTRICT_ID",
         "DISTRICT",
         "VILLAGE_ID",
         "VILLAGE",
         "FIGHTS_VILLAGE_SUBDISTRICT",
         "TOTAL_FIGHT_COMMUNITY_GRP",
         "FIGHT_COMMUNITY_GRP_DIED",
         "FIGHT_COMMUNITY_GRP_INJURED",
         "CAUSE_OF_FIGHT_COMMUNITY_GRP",
         "TOTAL_FIGHT_RURAL_COMMUNITY",
         "FIGHT_RURAL_COMMUNITY_DIED",
         "FIGHT_RURAL_COMMUNITY_INJURED",
         "CAUSE_OF_FIGHT_RURAL_COMMUNITY",
         "TOTAL_FIGHT_COMMUNITY_SECURITY_FORCE",
         "FIGHT_RURAL_COMMUNITY_SECURITY_FORCE_DIED",
         "FIGHT_RURAL_COMMUNITY_SECURITY_FORCE_INJURED",
         "CAUSE_OF_FIGHT_RURAL_COMMUNITY_SECURITY_FORCE",
         "TOTAL_FIGHT_COMMUNITY_GOV_OFF",
         "FIGHT_RURAL_COMMUNITY_GOV_OFF_DIED",
         "FIGHT_RURAL_COMMUNITY_GOV_OFF_INJURED",
         "CAUSE_OF_FIGHT_RURAL_COMMUNITY_GOV_OFF",
         "TOTAL_FIGHT_STUDENT",
         "FIGHT_RURAL_STUDENT_DIED",
         "FIGHT_RURAL_STUDENT_INJURED",
         "CAUSE_OF_FIGHT_RURAL_STUDENT" ,
         "TOTAL_FIGHT_ETHNIC",
         "FIGHT_RURAL_ETHNIC_DIED",
         "FIGHT_RURAL_ETHNIC_INJURED",
         "CAUSE_OF_FIGHT_RURAL_ETHNIC",
         "TOTAL_FIGHT_OTHERS",
         "FIGHT_RURAL_OTHERS_DIED",
         "FIGHT_RURAL_OTHERS_INJURED",
         "CAUSE_OF_FIGHT_RURAL_OTHERS",
         "RESOLVED_FIGHT",
         "RECONCILIATOR",
         "THEFT",
         "TREND_THEFT",
         "ROBBERY",
         "TREND_ROBBERY",
         "FRAUD_EMBEZZLEMENT",
         "TREND_FRAUD_EMBEZZLEMENT",
         "PERSECUTION",
         "TREND_PERSECUTION",
         "ARSON",
         "TREND_ARSON",
         "RAPE_CRIME_AGAINST_DECENCY",
         "TREND_RAPE_CRIME_AGAINST_DECENCY",
         "DRUG_ABUSE_TRAFFICKING",
         "TREND_DRUG_ABUSE_TRAFFICKING",
         "GAMBLING",
         "TREND_GAMBLING",
         "MURDER",
         "TREND_MURDER",
         "TRAFFICKING",
         "TREND_TRAFFICKING",
         "CORRUPTION",
         "TREND_CORRUPTION",
         "TYPE_OF_CRIME_MOST",
         "BUILDING_MAINTENANCE_SECURITY_POST",
         "ESTABLISHING_SECURITY_GUARD",
         "RAISING_CIVIL_DEFENSE",
         "REPORTING_GUEST_STAY_MORE_THAN_24_HOURS",
         "ACTIVATION_OF_SECURITY_SYSTEM_FROM_CITIZEN_INITIATIVE",
         "NO_OF_CIVIL_DEFENSE_PROTECTION_PERSONNEL_IN_VILLAGE", 
         "EXISTENCE_OF_POLICE_STATION_OFFICE_VILLAGE",
         "NUMBER_OF_POLICE_STATION_USED",
         "NUMBER_OF_POLICE_STATION_NOT_USED",
         "ESTIMATE_DISTANCE_TO_NEAREST_POLICE_STATION_KM",
         "CONVENIENCE_TO_REACH_NEAREST_POLICE_STATION",
         "NO_OF_SUICIDE_VICTIM_ATTEMPTED_SUICIDE_VILLAGE",
         "CONVENIENCE_TO_STREET_CHILDREN_HANGOUT_LOCATION",  
         "CONVENIENCE_TO_HANGOUT_PLACES_HOMELESS_BEGGAR", 
         "CONVENIENCE_TO_LOCATION_OF_COMMERCIAL_SEX_WORKERS",  
         "AVAILABILITY_OF_VILLAGE_INFORMATION",  
         "USAGE_OF_VILLAGE_FINANCIAL_SYSTEM",  
         "VILLAGE_OWNED_ENTERPRISE_LAND",  
         "VILLAGE_BUILDINGS",  
         "VILLAGE_MARKET",  
         "OTHER_VILLAGE_ASSETS",  
         "VILLAGE_MED_TERM_DEV_PLAN",
         "PERIOD_OF_RPJM_DEVELOP_YEAR_START",
         "PERIOD_OF_RPJM_DEVELOP_YEAR_END",
         "VILLAGE_GOV_WORK_PLAN_2018",   
         "VILLAGE_REGULATION_NUMBER_2017", 
         "NO_OF_HEADMAN_REGULATION_2017", 
         "AVAILABILITY_OF_VILLAGE_COOPERATION_BETWEEN_VILLAGES_2018",  
         "AVAILABILITY_OF_VILLAGE_COOPERATION_WITH_THIRD_PARTIES_2018",  
         "AVAILABILITY_OF_VILLAGE_ASSISTANCE",   
         "TRANSPORTATION_INFRASTRUCTURE_DEVELOPMENT", 
         "SOURCE_OF_FUND1",
         "ADMINISTRATOR1",
         "DIRECT_BENEFIT_RECEIVER1",
         "ENERGY_INFRASTRUCTURE",
         "SOURCE_OF_FUND2",
         "ADMINISTRATOR2",
         "DIRECT_BENEFIT_RECEIVER2",
         "INFORMATION_COMMUNICATION_INFRASTRUCTURE",
         "SOURCE_OF_FUND3",
         "ADMINISTRATOR3",
         "DIRECT_BENEFIT_RECEIVER3",
         "SANITATION_INFRASTRUCTURE",
         "SOURCE_OF_FUND4",
         "ADMINISTRATOR4",
         "DIRECT_BENEFIT_RECEIVER4",
         "EDUCATION_CULTURE_HEALTH_INFRASTRUCTURE",
         "SOURCE_OF_FUND5",
         "ADMINISTRATOR5",
         "DIRECT_BENEFIT_RECEIVER5",
         "TRADING_SERVICES_INFRASTRUCTURE",
         "SOURCE_OF_FUND6",
         "ADMINISTRATOR6",
         "DIRECT_BENEFIT_RECEIVER6",
         "FARMING_PRODUCTION_VILLAGE_SMALL_INDUSTRY_INFRASTRUCTURE",
         "SOURCE_OF_FUND7",
         "ADMINISTRATOR7",
         "DIRECT_BENEFIT_RECEIVER7",
         "RECREATION_TOURISM_INFRASTRUCTURE",
         "SOURCE_OF_FUND8",
         "ADMINISTRATOR8",
         "DIRECT_BENEFIT_RECEIVER8",
         "DISASTER_MGMT_ENV_CONSERVATION_INFRASTRUCTURE",
         "SOURCE_OF_FUND9",
         "ADMINISTRATOR9",
         "DIRECT_BENEFIT_RECEIVER9",
         "GOV_SUPPORT_INFRASTRUCTURE",
         "SOURCE_OF_FUND10",
         "ADMINISTRATOR10",
         "DIRECT_BENEFIT_RECEIVER10",
         "EDU_HEALTH_PUBLIC_CULTURE_EMPOWERMENT",
         "SOURCE_OF_FUND11",
         "ADMINISTRATOR11",
         "DIRECT_BENEFIT_RECEIVER11",
         "VILLAGE_RESIDENTIAL_NEIGHBOURHOOD_MGMT_EMPOWERMENT",
         "SOURCE_OF_FUND12",
         "ADMINISTRATOR12",
         "DIRECT_BENEFIT_RECEIVER12",
         "VILLAGE_TRANSPORTATION_MGMT_EMPOWERMENT",
         "SOURCE_OF_FUND13",
         "ADMINISTRATOR13",
         "DIRECT_BENEFIT_RECEIVER13= R1601B3K5",
         "RENEWABLE_ENERGY_DEVELOPMENT_EMPOWERMENT",
         "SOURCE_OF_FUND14",
         "ADMINISTRATOR14",
         "DIRECT_BENEFIT_RECEIVER14",
         "INFORMATION_COMMUNICATION_MGMT_EMPOWERMENT",
         "SOURCE_OF_FUND15",
         "ADMINISTRATOR15",
         "DIRECT_BENEFIT_RECEIVER15",
         "AGRI_BASED_PRODUCTIVE_BUSI_NON_AGRI_VILLAGE_SMALL_BUSI_MGMT_EMPOWERMENT",
         "SOURCE_OF_FUND16",
         "ADMINISTRATOR16",
         "DIRECT_BENEFIT_RECEIVER16",
         "NATURE_CONSERVE_AWARENESS_DISASTER_MGMT_EMPOWERMENT",
         "SOURCE_OF_FUND17",
         "ADMINISTRATOR17",
         "DIRECT_BENEFIT_RECEIVER17",
         "COMMUNITY_ROLE_IMPROVE_VILLAGE_GOVERNANCE_EMPOWERMENT",
         "SOURCE_OF_FUND18",
         "ADMINISTRATOR18",
         "DIRECT_BENEFIT_RECEIVER18",
         "QUALITY_CAPACITY_OF_VILLAGE_COMMUNITY_EMPOWERMENT",
         "SOURCE_OF_FUND19",
         "ADMINISTRATOR19",
         "DIRECT_BENEFIT_RECEIVER19",
         "ESTABLISHMENT_DEVELOPMENT_VILLAGE_GOV_ENTERPRISE_EMPOWERMENT",
         "SOURCE_OF_FUND20",
         "ADMINISTRATOR20",
         "DIRECT_BENEFIT_RECEIVER20",
         "VILLAGE_HEAD_EXISTENCE",
         "AGE1",  
         "GENDER1",  
         "HIGHEST_EDUCATION_LEVEL1", 
         "VILLAGE_SECRETARY_EXISTENCE", 
         "AGE2", 
         "GENDER2", 
         "HIGHEST_EDUCATION_LEVEL2",
         "VILLAGE_SECRETARIAT_TREASURER",  
         "TECHNICAL_EXECUTOR", 
         "TERRITORIAL_EXECUTOR", 
         "VILLAGE_OFFICIALS")
```


4 <- c("SHAPE = Shape,
         PROVINCE_ID = R101,
         PROVINCE = R101N,
         CITY_ID = R102,
         CITY = R102N,
         DISTRICT_ID = R103,
         DISTRICT = R103N,
         VILLAGE_ID = R104,
         VILLAGE = R104N,
         FIGHTS_VILLAGE_SUBDISTRICT = R1301A,
         TOTAL_FIGHT_COMMUNITY_GRP = R1301B1K2,
         FIGHT_COMMUNITY_GRP_DIED = R1301B1K3,
         FIGHT_COMMUNITY_GRP_INJURED = R1301B1K4,
         CAUSE_OF_FIGHT_COMMUNITY_GRP = R1301B1K5,
         TOTAL_FIGHT_RURAL_COMMUNITY = R1301B2K2,
         FIGHT_RURAL_COMMUNITY_DIED = R1301B2K3,
         FIGHT_RURAL_COMMUNITY_INJURED = R1301B2K4,
         CAUSE_OF_FIGHT_RURAL_COMMUNITY = R1301B2K5,
         TOTAL_FIGHT_COMMUNITY_SECURITY_FORCE = R1301B3K2,
         FIGHT_RURAL_COMMUNITY_SECURITY_FORCE_DIED = R1301B3K3,
         FIGHT_RURAL_COMMUNITY_SECURITY_FORCE_INJURED = R1301B3K4,
         CAUSE_OF_FIGHT_RURAL_COMMUNITY_SECURITY_FORCE = R1301B3K5,
         TOTAL_FIGHT_COMMUNITY_GOV_OFF = R1301B4K2,
         FIGHT_RURAL_COMMUNITY_GOV_OFF_DIED = R1301B4K3,
         FIGHT_RURAL_COMMUNITY_GOV_OFF_INJURED = R1301B4K4,
         CAUSE_OF_FIGHT_RURAL_COMMUNITY_GOV_OFF = R1301B4K5,
         TOTAL_FIGHT_STUDENT = R1301B5K2,
         FIGHT_RURAL_STUDENT_DIED = R1301B5K3,
         FIGHT_RURAL_STUDENT_INJURED = R1301B5K4,
         CAUSE_OF_FIGHT_RURAL_STUDENT = R1301B5K5,
         TOTAL_FIGHT_ETHNIC= R1301B6K2,
         FIGHT_RURAL_ETHNIC_DIED = R1301B6K3,
         FIGHT_RURAL_ETHNIC_INJURED = R1301B6K4,
         CAUSE_OF_FIGHT_RURAL_ETHNIC = R1301B6K5,
         TOTAL_FIGHT_OTHERS = R1301B7K2,
         FIGHT_RURAL_OTHERS_DIED = R1301B7K3,
         FIGHT_RURAL_OTHERS_INJURED = R1301B7K4,
         CAUSE_OF_FIGHT_RURAL_OTHERS = R1301B7K5,
         RESOLVED_FIGHT = R1302A,
         RECONCILIATOR = R1302B,
         THEFT = R1303A01K3,
         TREND_THEFT= R1303A01K4,
         ROBBERY= R1303A02K3,
         TREND_ROBBERY = R1303A02K4,
         FRAUD_EMBEZZLEMENT = R1303A03K3,
         TREND_FRAUD_EMBEZZLEMENT = R1303A03K4,
         PERSECUTION = R1303A04K3,
         TREND_PERSECUTION = R1303A04K4,
         ARSON = R1303A05K3,
         TREND_ARSON= R1303A05K4,
         RAPE_CRIME_AGAINST_DECENCY = R1303A06K3,
         TREND_RAPE_CRIME_AGAINST_DECENCY = R1303A06K4,
         DRUG_ABUSE_TRAFFICKING = R1303A07K3,
         TREND_DRUG_ABUSE_TRAFFICKING = R1303A07K4,
         GAMBLING = R1303A08K3,
         TREND_GAMBLING = R1303A08K4,
         MURDER= R1303A09K3,
         TREND_MURDER= R1303A09K4,
         TRAFFICKING= R1303A10K3,
         TREND_TRAFFICKING= R1303A10K4,
         CORRUPTION= R1303A11K3,
         TREND_CORRUPTION= R1303A11K4,
         TYPE_OF_CRIME_MOST= R1303B,
         BUILDING_MAINTENANCE_SECURITY_POST= R1304A,
         ESTABLISHING_SECURITY_GUARD= R1304B,
         RAISING_CIVIL_DEFENSE= R1304C,
         REPORTING_GUEST_STAY_MORE_THAN_24_HOURS= R1304D,
         ACTIVATION_OF_SECURITY_SYSTEM_FROM_CITIZEN_INITIATIVE= R1304E,
         NO_OF_CIVIL_DEFENSE_PROTECTION_PERSONNEL_IN_VILLAGE= R1305, 
         EXISTENCE_OF_POLICE_STATION_OFFICE_VILLAGE= R1306A,
         NUMBER_OF_POLICE_STATION_USED= R1306B1,
         NUMBER_OF_POLICE_STATION_NOT_USED= R1306B2,
         ESTIMATE_DISTANCE_TO_NEAREST_POLICE_STATION_KM= R1306C1,
         CONVENIENCE_TO_REACH_NEAREST_POLICE_STATION= R1306C2,
         NO_OF_SUICIDE_VICTIM_ATTEMPTED_SUICIDE_VILLAGE= R1307,
         CONVENIENCE_TO_STREET_CHILDREN_HANGOUT_LOCATION= R1308A,  
         CONVENIENCE_TO_HANGOUT_PLACES_HOMELESS_BEGGAR= R1308B, 
         CONVENIENCE_TO_LOCATION_OF_COMMERCIAL_SEX_WORKERS= R1309,  
         AVAILABILITY_OF_VILLAGE_INFORMATION= R1403A,  
         USAGE_OF_VILLAGE_FINANCIAL_SYSTEM= R1403B,  
         VILLAGE_OWNED_ENTERPRISE_LAND= R1404B,  
         VILLAGE_BUILDINGS= R1404C,  
         VILLAGE_MARKET= R1404D,  
         OTHER_VILLAGE_ASSETS= R1404E,  
         VILLAGE_MED_TERM_DEV_PLAN= R1405A1,
         PERIOD_OF_RPJM_DEVELOP_YEAR_START= R1405A2K1,
         PERIOD_OF_RPJM_DEVELOP_YEAR_END= R1405A2K2,
         VILLAGE_GOV_WORK_PLAN_2018= R1405B,   
         VILLAGE_REGULATION_NUMBER_2017= R1405C, 
         NO_OF_HEADMAN_REGULATION_2017= R1405D, 
         AVAILABILITY_OF_VILLAGE_COOPERATION_BETWEEN_VILLAGES_2018= R1406A,  
         AVAILABILITY_OF_VILLAGE_COOPERATION_WITH_THIRD_PARTIES_2018= R1406B,  
         AVAILABILITY_OF_VILLAGE_ASSISTANCE= R1407,   
         TRANSPORTATION_INFRASTRUCTURE_DEVELOPMENT= R1601A1K2, 
         SOURCE_OF_FUND1= R1601A1K3,
         ADMINISTRATOR1= R1601A1K4,
         DIRECT_BENEFIT_RECEIVER1= R1601A1K5,
         ENERGY_INFRASTRUCTURE= R1601A2K2,
         SOURCE_OF_FUND2= R1601A2K3,
         ADMINISTRATOR2= R1601A2K4,
         DIRECT_BENEFIT_RECEIVER2= R1601A2K5,
         INFORMATION_COMMUNICATION_INFRASTRUCTURE= R1601A3K2,
         SOURCE_OF_FUND3= R1601A3K3,
         ADMINISTRATOR3= R1601A3K4,
         DIRECT_BENEFIT_RECEIVER3= R1601A3K5,
         SANITATION_INFRASTRUCTURE= R1601A4K2,
         SOURCE_OF_FUND4= R1601A4K3,
         ADMINISTRATOR4= R1601A4K4,
         DIRECT_BENEFIT_RECEIVER4= R1601A4K5,
         EDUCATION_CULTURE_HEALTH_INFRASTRUCTURE= R1601A5K2,
         SOURCE_OF_FUND5= R1601A5K3,
         ADMINISTRATOR5= R1601A5K4,
         DIRECT_BENEFIT_RECEIVER5= R1601A5K5,
         TRADING_SERVICES_INFRASTRUCTURE= R1601A6K2,
         SOURCE_OF_FUND6= R1601A6K3,
         ADMINISTRATOR6= R1601A6K4,
         DIRECT_BENEFIT_RECEIVER6= R1601A6K5,
         FARMING_PRODUCTION_VILLAGE_SMALL_INDUSTRY_INFRASTRUCTURE= R1601A7K2,
         SOURCE_OF_FUND7= R1601A7K3,
         ADMINISTRATOR7= R1601A7K4,
         DIRECT_BENEFIT_RECEIVER7= R1601A7K5,
         RECREATION_TOURISM_INFRASTRUCTURE= R1601A8K2,
         SOURCE_OF_FUND8= R1601A8K3,
         ADMINISTRATOR8= R1601A8K4,
         DIRECT_BENEFIT_RECEIVER8= R1601A8K5,
         DISASTER_MGMT_ENV_CONSERVATION_INFRASTRUCTURE= R1601A9K2,
         SOURCE_OF_FUND9= R1601A9K3,
         ADMINISTRATOR9= R1601A9K4,
         DIRECT_BENEFIT_RECEIVER9= R1601A9K5,
         GOV_SUPPORT_INFRASTRUCTURE= R1601A10K2 ,
         SOURCE_OF_FUND10= R1601A10K3,
         ADMINISTRATOR10= R1601A10K4,
         DIRECT_BENEFIT_RECEIVER10= R1601A10K5,
         EDU_HEALTH_PUBLIC_CULTURE_EMPOWERMENT= R1601B1K2,
         SOURCE_OF_FUND11= R1601B1K3,
         ADMINISTRATOR11= R1601B1K4,
         DIRECT_BENEFIT_RECEIVER11= R1601B1K5,
         VILLAGE_RESIDENTIAL_NEIGHBOURHOOD_MGMT_EMPOWERMENT= R1601B2K2,
         SOURCE_OF_FUND12= R1601B2K3,
         ADMINISTRATOR12= R1601B2K4,
         DIRECT_BENEFIT_RECEIVER12= R1601B2K5,
         VILLAGE_TRANSPORTATION_MGMT_EMPOWERMENT= R1601B3K2,
         SOURCE_OF_FUND13= R1601B3K3,
         ADMINISTRATOR13= R1601B3K4,
         DIRECT_BENEFIT_RECEIVER13= R1601B3K5,
         RENEWABLE_ENERGY_DEVELOPMENT_EMPOWERMENT= R1601B4K2,
         SOURCE_OF_FUND14= R1601B4K3,
         ADMINISTRATOR14= R1601B4K4,
         DIRECT_BENEFIT_RECEIVER14= R1601B4K5,
         INFORMATION_COMMUNICATION_MGMT_EMPOWERMENT= R1601B5K2,
         SOURCE_OF_FUND15= R1601B5K3,
         ADMINISTRATOR15= R1601B5K4,
         DIRECT_BENEFIT_RECEIVER15= R1601B5K5,
         AGRI_BASED_PRODUCTIVE_BUSI_NON_AGRI_VILLAGE_SMALL_BUSI_MGMT_EMPOWERMENT= R1601B6K2,
         SOURCE_OF_FUND16= R1601B6K3,
         ADMINISTRATOR16= R1601B6K4,
         DIRECT_BENEFIT_RECEIVER16= R1601B6K5,
         NATURE_CONSERVE_AWARENESS_DISASTER_MGMT_EMPOWERMENT= R1601B7K2,
         SOURCE_OF_FUND17= R1601B7K3,
         ADMINISTRATOR17= R1601B7K4,
         DIRECT_BENEFIT_RECEIVER17= R1601B7K5,
         COMMUNITY_ROLE_IMPROVE_VILLAGE_GOVERNANCE_EMPOWERMENT= R1601B8K2,
         SOURCE_OF_FUND18= R1601B8K3,
         ADMINISTRATOR18= R1601B8K4,
         DIRECT_BENEFIT_RECEIVER18= R1601B8K5,
         QUALITY_CAPACITY_OF_VILLAGE_COMMUNITY_EMPOWERMENT = R1601B9K2,
         SOURCE_OF_FUND19 = R1601B9K3,
         ADMINISTRATOR19= R1601B9K4,
         DIRECT_BENEFIT_RECEIVER19= R1601B9K5,
         ESTABLISHMENT_DEVELOPMENT_VILLAGE_GOV_ENTERPRISE_EMPOWERMENT= R1601B10K2,
         SOURCE_OF_FUND20= R1601B10K3,
         ADMINISTRATOR20= R1601B10K4,
         DIRECT_BENEFIT_RECEIVER20= R1601B10K5,
         VILLAGE_HEAD_EXISTENCE= R1701AK2,
         AGE1= R1701AK3,  
         GENDER1= R1701AK4,  
         HIGHEST_EDUCATION_LEVEL1= R1701AK5, 
         VILLAGE_SECRETARY_EXISTENCE= R1701BK2, 
         AGE2= R1701BK3, 
         GENDER2 = R1701BK4, 
         HIGHEST_EDUCATION_LEVEL2= R1701BK5,
         VILLAGE_SECRETARIAT_TREASURER= R1702A,  
         TECHNICAL_EXECUTOR = R1702B, 
         TERRITORIAL_EXECUTOR= R1702C, 
         VILLAGE_OFFICIALS= R1702D)


```{r}
colnames(podes4) <- var_meaning4
```

variables chosen:

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes4_final <- podes4 %>%
  select("SHAPE",
         "PROVINCE_ID", 
         "PROVINCE",
         "CITY_ID", 
         "CITY", 
         "DISTRICT_ID",
         "DISTRICT",
         "VILLAGE_ID", 
         "VILLAGE", 
         "AVAILABILITY_OF_VILLAGE_INFORMATION",
         "USAGE_OF_VILLAGE_FINANCIAL_SYSTEM",
         # "VILLAGE_OWNED_ENTERPRISE_LAND",
         # "VILLAGE_BUILDINGS",
         # "VILLAGE_MARKET",
         # "OTHER_VILLAGE_ASSETS",
         "VILLAGE_MED_TERM_DEV_PLAN", 
         # "PERIOD_OF_RPJM_DEVELOP_YEAR_START", 
         # "PERIOD_OF_RPJM_DEVELOP_YEAR_END", 
         # "VILLAGE_GOV_WORK_PLAN_2018", 
         # "VILLAGE_REGULATION_NUMBER_2017", 
         # "NO_OF_HEADMAN_REGULATION_2017",
         # "AVAILABILITY_OF_VILLAGE_COOPERATION_BETWEEN_VILLAGES_2018",
         # "AVAILABILITY_OF_VILLAGE_COOPERATION_WITH_THIRD_PARTIES_2018", 
         "TRANSPORTATION_INFRASTRUCTURE_DEVELOPMENT",
         "ENERGY_INFRASTRUCTURE", 
         "INFORMATION_COMMUNICATION_INFRASTRUCTURE", 
         "SANITATION_INFRASTRUCTURE", 
         "EDUCATION_CULTURE_HEALTH_INFRASTRUCTURE", 
         "TRADING_SERVICES_INFRASTRUCTURE",
         "FARMING_PRODUCTION_VILLAGE_SMALL_INDUSTRY_INFRASTRUCTURE",
         "RECREATION_TOURISM_INFRASTRUCTURE", 
         "DISASTER_MGMT_ENV_CONSERVATION_INFRASTRUCTURE",
         "GOV_SUPPORT_INFRASTRUCTURE", 
         "EDU_HEALTH_PUBLIC_CULTURE_EMPOWERMENT", 
         "VILLAGE_RESIDENTIAL_NEIGHBOURHOOD_MGMT_EMPOWERMENT",
         "VILLAGE_TRANSPORTATION_MGMT_EMPOWERMENT",
         "RENEWABLE_ENERGY_DEVELOPMENT_EMPOWERMENT",
         "INFORMATION_COMMUNICATION_MGMT_EMPOWERMENT", 
         "AGRI_BASED_PRODUCTIVE_BUSI_NON_AGRI_VILLAGE_SMALL_BUSI_MGMT_EMPOWERMENT",
         "NATURE_CONSERVE_AWARENESS_DISASTER_MGMT_EMPOWERMENT",
         "COMMUNITY_ROLE_IMPROVE_VILLAGE_GOVERNANCE_EMPOWERMENT",
         "QUALITY_CAPACITY_OF_VILLAGE_COMMUNITY_EMPOWERMENT", 
         "ESTABLISHMENT_DEVELOPMENT_VILLAGE_GOV_ENTERPRISE_EMPOWERMENT")
```

```{r}
head(podes4_final)
```


## 3.6 Combining 4 parts PODES 2018 data 
# We will be deriving the variable names by part and combine all the 4 parts into 1 at the end.


Since, all the 4 parts have the same number of rows, we will just use inner_join() function of dplyr package to combine the 4 parts into 1 dataframe.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podesv1 <- inner_join(podes1, podes2, by = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE"))
podesv2 <- inner_join(podes3, podes4, by = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE"))
podes <- inner_join(podesv1, podesv2, by = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE"))
```

```{r}
head(podes)
```

We can see that the podes data frame have 757 variables now, and it's correct because if we bind everything it will have 784 variables and subtracted by 3 times of 9 same variable will be 784-27 = 757.


We will also do inner joins on the subsetted podes dataframes to retrieve the initial dataframe with the metrics we would like to analyse for the Project. The join condition will be on similar fields as above. 
```{r}
podesv1.subset <- inner_join(podes1_final, podes2_final, by = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE"))
podesv2.subset <- inner_join(podes3_final, podes4_final, by = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE"))
podes.subset <- inner_join(podesv1.subset, podesv2.subset, by = c("SHAPE", "PROVINCE_ID", "PROVINCE", "CITY_ID", "CITY", "DISTRICT_ID", "DISTRICT", "VILLAGE_ID", "VILLAGE"))
```




# 3.7 Combining spatial and aspatial data

We will join the `area` shapefile of East Kalimantan boundary with the tidied podes dataset so that we can do further analysis. Our common variables between `area` and `podes` have different data types so we have to change the podes' variabel into character type.

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes$PROVINCE_ID <- as.character(podes$PROVINCE_ID)
podes$CITY_ID <- as.character(podes$CITY_ID)
podes$DISTRICT_ID <- as.character(podes$DISTRICT_ID)
podes$VILLAGE_ID <- as.character(podes$VILLAGE_ID)
```


```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
eastkalimantan.podes <- inner_join(area,podes, by = c("PROVINCE_ID", "CITY_ID", "DISTRICT_ID", "VILLAGE_ID","PROVINCE",
                                                                    "CITY","DISTRICT","VILLAGE")) 
```

Do the same for podes.subset
```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
podes.subset$PROVINCE_ID <- as.character(podes.subset$PROVINCE_ID)
podes.subset$CITY_ID <- as.character(podes.subset$CITY_ID)
podes.subset$DISTRICT_ID <- as.character(podes.subset$DISTRICT_ID)
podes.subset$VILLAGE_ID <- as.character(podes.subset$VILLAGE_ID)
```

```{r}
eastkalimantan.podes.subset <- inner_join(area,podes.subset, by = c("PROVINCE_ID", "CITY_ID", "DISTRICT_ID", "VILLAGE_ID","PROVINCE",
                                                                    "CITY","DISTRICT","VILLAGE")) 
```

# 3.8 Data Transformation

## 3.8.1 Process Nulls 

Check for nulls in resulting dataframe 
```{r}
any(is.na.data.frame(eastkalimantan.podes.subset))
```
There are nulls present in the dataframe. This is probably due to the way in which the survey is structured, where there are multi parts to certain questions. We will loop through and replace such values with -1 to encode for such situations. 

```{r}
eastkalimantan.podes.subset[is.na(eastkalimantan.podes.subset)] = -1
```

The error messages tell us that there are still NAs present in the dataframe. This is due to some columns being coded as factors. 
```{r}
factorised_cols <- colnames(eastkalimantan.podes.subset)[colSums(is.na(eastkalimantan.podes.subset)) > 0]
# should aggregate at village level
```


```{r}
for (colname in factorised_cols) {
  col <- as.data.frame(eastkalimantan.podes.subset %>% select(colname))
  vec <- as.numeric(factor(col[,1]))
  vec[is.na(vec)] = -1
  eastkalimantan.podes.subset[which(colnames(eastkalimantan.podes.subset) == colname)] <- vec
}
```

```{r}
any(is.na.data.frame(eastkalimantan.podes.subset))
```
All NA values are successfully replaced. 

## 3.8.2 Recode Categorical Variables as Numbers 

This step is necessary for the clustering analysis later on, which requires numerical inputs. Save the new dataframe as a new variable so that we can refer to the categories for analysis if needed later on. 

```{r}
# Use visual inspection to sieve out columns, which is alright since we have reduced the number of columns already. 
# Another reason is because some of the factors have already been encoded - if we unclass it, it will ruin the encoding 
to_recode <- c("VILLAGE_LOCATION_TO_FOREST",
               "VILLAGE_MAIN_INCOME",
               "STREET_LIGHTING",
               "FUEL_USED_OFTEN",
               "TRASH_DUMP_USED_OFTEN",
               "TOILET_FACILITIES",
               "TRANSPORTATION_METHODS",
               "PUBLIC_TRANSPORT",
               "CITIZENS_OWN_CELLPHONES",
               "STRENGTH_OF_CELLPHONE_SIGNALS",
               "POST_OFFICE",
               "PRIVATE_DELIVERY_COURIER")

ekps.recoded <- eastkalimantan.podes.subset 
```

```{r}
for (name in to_recode) {
  col <- as.data.frame(ekps.recoded %>% select(name))
  vec <- as.numeric(factor(col[,1]))  
  ekps.recoded[which(colnames(ekps.recoded) == name)] <- vec
}
```

## 3.8.3 Further Dimensional Reduction - Aggregating Features
Let us first change the datatypes of some columns to numerical. 
```{r}
to_numeric <- c("STREET_LIGHTING",
                "PRESENCE_SLUMS",
                "SLASH_AND_BURN",
                "PRESENCE_POWER_LINES",
                "PRESENCE_RIVER",
                "PRESENCE_IRRIGATIONCHANNEL",
                "PRESENCE_RESERVOIR",
                "PRESENCE_BASIN",
                "PRESENCE_MUDSLIDES",
                "PRESENCE_FLOOD",
                "PRESENCE_FLASHFLOOD",
                "PRESENCE_EARTHQUAKE",
                "PRESENCE_TSUNAMI",
                "PRESENCE_TIDALWAVES",
                "PRESENCE_TORNADO",
                "PRESENCE_VOLCANIC_ERUPTIONS",
                "PRESENCE_FORESTFIRE",
                "WARNING_SYSTEM_NATURAL_DISASTER",
                "WARNING_SYSTEM_TSUNAMI",
                "DIARRHEA_OUTBREAK",
                "DENGUE_OUTBREAK",
                "MEASLES_OUTBREAK",
                "MALARIA_OUTBREAK",
                "SARS_OUTBREAK",
                "HEPATITIS_OUTBREAK",
                "DIPHTHERIA_OUTBREAK",
                "POST_OFFICE",
                "MOBILE_POSTOFFICE",
                "PRIVATE_DELIVERY_COURIER",
                "PEOPLE_BUSINESS_CREDIT",
                "ENERGY_FOOD_CREDIT",
                "SMALL_BUSINESS_CREDIT",
                "BMT",
                "ATM",
                "BANK_AGENT",
                "TRANSPORTATION_INFRASTRUCTURE_DEVELOPMENT",
                "INFORMATION_COMMUNICATION_INFRASTRUCTURE",
                "SANITATION_INFRASTRUCTURE",
                "EDUCATION_CULTURE_HEALTH_INFRASTRUCTURE",
                "TRADING_SERVICES_INFRASTRUCTURE",
                "FARMING_PRODUCTION_VILLAGE_SMALL_INDUSTRY_INFRASTRUCTURE",
                "RECREATION_TOURISM_INFRASTRUCTURE",
                "DISASTER_MGMT_ENV_CONSERVATION_INFRASTRUCTURE",
                "GOV_SUPPORT_INFRASTRUCTURE",
                "INTERNET_CAFES")



for (col in to_numeric) {
  ekps.recoded[, col] <- as.numeric(unlist(ekps.recoded[,col] %>% st_set_geometry(NULL)))
}

```

Next, we will consider aggregating certain similar features together in order to reduce the number of features in the dataset further.
```{r}
ekps.recoded <- ekps.recoded %>%
  mutate(`ELECTRICTY` = `STREET_LIGHTING` + `PRESENCE_POWER_LINES`) %>%
  mutate(`WASTE_DISPOSAL` = `TRASH_DUMP_USED_OFTEN` + `TOILET_FACILITIES` + `TOILET_DISPOSAL_SITE`) %>%
  mutate(`WATER_MANAGEMENT` = `PRESENCE_RIVER` + `PRESENCE_IRRIGATIONCHANNEL` + `PRESENCE_RESERVOIR` + `PRESENCE_BASIN`) %>%
  mutate(`NATURAL_DISASTER_SCORE` = PRESENCE_MUDSLIDES + PRESENCE_FLOOD + PRESENCE_FLASHFLOOD + PRESENCE_EARTHQUAKE + PRESENCE_TSUNAMI + PRESENCE_TIDALWAVES + PRESENCE_TORNADO + PRESENCE_VOLCANIC_ERUPTIONS + PRESENCE_FORESTFIRE + WARNING_SYSTEM_NATURAL_DISASTER + WARNING_SYSTEM_TSUNAMI) %>%
  mutate(`HEALTHCARE_SERVICE_NUM` = HOSPITAL_NUM + MATERNITY_HOSPITAL_NUM + PUBLIC_HEALTH_CLINIC_INPATIENT_CARE_NUM + PUBLIC_HEALTH_CLINIC_OUTPATIENT_CARE_NUM + POLYCLINIC_NUM + GP_NUM + MIDWIFE_PRACTICE_NUM+ VILLAGE_HEALTH_POST_NUM + VILLAGE_MATERNITY_HUT_NUM + PHARMACY_NUM + DRUGSTORE_NUM + DENTIST_NUM) %>%
  mutate(`HEALTHCARE_ACCESS_SCORE` = CONVENIENCE_TO_HOSPITAL + CONVENIENCE_TO_MATERNITY_HOSPITAL + CONVENIENCE_TO_CLINIC_INPATIENT_CARE +  CONVENIENCE_TO_CLINIC_OUTPATIENT_CARE + CONVENIENCE_TO_POLYCLINIC + CONVENIENCE_TO_GP + CONVENIENCE_TO_MIDWIFE_PRACTICE + CONVENIENCE_TO_HEALTH_POST + CONVENIENCE_TO_MATERNITY_HUT + CONVENIENCE_TO_PHARMACY + CONVENIENCE_TO_DRUGSTORE) %>%
  mutate(`DISEASE_OUTBREAK_SCORE` = DIARRHEA_OUTBREAK + DENGUE_OUTBREAK + MEASLES_OUTBREAK + MALARIA_OUTBREAK + SARS_OUTBREAK + HEPATITIS_OUTBREAK + DIPHTHERIA_OUTBREAK) %>% 
  mutate(`EDUCATION_INSTITUTION_NUM` = EARLYCHILDHOOD_PUBLIC_INSTITUTION_NUM + EARLYCHILDHOOD_PRIVATE_INSTITUTION_NUM + KINDERGARTEN_PUBLIC_INSTITUTION_NUM + KINDERGARTEN_PRIVATE_INSTITUTION_NUM + PRIMARY_PUBLIC_INSTITUTION_NUM + PRIMARY_PRIVATE_INSTITUTION_NUM + MIDDLE_PUBLIC_INSTITUTION_NUM + HIGH_PUBLIC_INSTITUTION_NUM + HIGH_PRIVATE_INSTITUTION_NUM + POLYTECHNIC_PUBLIC_INSTITUTION_NUM + POLYTECHNIC_PRIVATE_INSTITUTION_NUM + COLLEGE_PUBLIC_INSTITUTION_NUM + COLLEGE_PRIVATE_INSTITUTION_NUM + ISLAMIC_SCHOOL_PRIVATE_INSTITUTION_NUM) %>%
  mutate(`EDUCATION_ACCESS_SCORE`  =  CONVENIENCE_TO_CHILDHOODCENTRE + CONVENIENCE_TO_KINDERGARTEN + CONVENIENCE_TO_PRIMARYSCHOOL + CONVENIENCE_TO_MIDDLESCHOOL + CONVENIENCE_TO_HIGHSCHOOL + CONVENIENCE_TO_POLYTECHNIC + CONVENIENCE_TO_COLLEGE) %>%
  mutate(`MAIL_ACCESS_SCORE` =  POST_OFFICE + MOBILE_POSTOFFICE + PRIVATE_DELIVERY_COURIER) %>%
  mutate(`INDUSTRIES` = NUM_INDUSTRIAL_CENTERS + NUM_SMALL_INDUSTRIES_ECOSYSTEM + NUM_SMALL_INDUSTRIES_ECOSYSTEM)  %>%
  mutate(`COOPERATIVES` = VILLAGE_COOPERATIVE + SMALL_INDUSTRIAL_COOPERATIVE_NONKUD + CREDITSAVINGS_COOPERATIVE_NONKUD) %>%
  mutate(`GROCERIES_NUMBER` = NUM_SHOPHOUSE + NUM_PERMANENT_MARKET + NUM_SEMIPERMANENT_MARKET + NUM_MARKET_NOBUILDINGS + NUM_MINIMART) %>%
  mutate(`GROCERIES_ACCESS_SCORE` = SHOPHOUSE_ACCESSIBILITY + PERMANENT_MARKET_ACCESSIBILITY + SEMIPERMANENT_MARKET_ACCESSIBILITY + MARKET_NOBUILDINGS_ACCESSIBILITY+ MINIMART_ACCESSIBILITY) %>%
  mutate(`FOOD_ESTAB_NUMBER` = NUM_BIGGER_WARUNG + NUM_SMALLER_WARUNG + NUM_RESTAURANTS + NUM_FOODSTALLS) %>%
  mutate(`FOOD_ESTAB_ACCESS_SCORE` = BIGGER_WARUNG_ACCESSIBILITY + SMALLER_WARUNG_ACCESSIBILITY + RESTAURANTS_ACCESSIBILITY + FOODSTALLS_ACCESSIBILITY) %>%
  mutate(`LODGING_NUM` = NUM_HOTELS + NUM_LODGING_PLACES) %>%
  mutate(`LODGING_ACCESS_SCORE` = HOTELS_ACCESSIBILITY + LODGING_PLACES_ACCESSIBILITY) %>%
  mutate(`TOOK_CREDIT_SCORE` = PEOPLE_BUSINESS_CREDIT + ENERGY_FOOD_CREDIT + SMALL_BUSINESS_CREDIT) %>%
  mutate(`BANK_NUM` = NUM_GOVT_BANKS + NUM_COMMERCIAL_BANKS + NUM_RURAL_CREDIT_BANKS) %>%
  mutate(`BANK_ACCESS_SCORE` = GOVT_BANKS_ACCESSIBILITY + COMMERCIAL_BANKS_ACCESSIBILITY + RURAL_CREDIT_BANKS_ACCESSIBILITY) %>%
  mutate(`FI_INFRA_NUM` = BMT + ATM + BANK_AGENT) %>%
  mutate(`FI_INFRA_ACCESS_SCORE` = BMT_ACCESSIBILITY + ATM_ACCESSIBILITY + BANK_AGENT_ACCESSIBILITY) %>%
  mutate(`INFRA_DEVELOPMENT_SCORE` = TRANSPORTATION_INFRASTRUCTURE_DEVELOPMENT + INFORMATION_COMMUNICATION_INFRASTRUCTURE + SANITATION_INFRASTRUCTURE + EDUCATION_CULTURE_HEALTH_INFRASTRUCTURE + TRADING_SERVICES_INFRASTRUCTURE + FARMING_PRODUCTION_VILLAGE_SMALL_INDUSTRY_INFRASTRUCTURE + RECREATION_TOURISM_INFRASTRUCTURE + DISASTER_MGMT_ENV_CONSERVATION_INFRASTRUCTURE + GOV_SUPPORT_INFRASTRUCTURE) %>%
  mutate(DESA = paste(CITY, DISTRICT, VILLAGE)) # done to generate a unique identifier other than region code, which may be hard to interpret in plots
```

Next, let us deal with some aggregated variables that are in different scales/unit of measurement
```{r}
ekps.recoded$NUM_FAMILIES_WITH_LANDLINES <- normalize(ekps.recoded$NUM_FAMILIES_WITH_LANDLINES)
ekps.recoded$CITIZENS_OWN_CELLPHONES <- normalize(ekps.recoded$CITIZENS_OWN_CELLPHONES)
ekps.recoded$INTERNET_CAFES <- normalize(ekps.recoded$INTERNET_CAFES)
ekps.recoded$MOBILE_PHONE_SERVICE_OPERATORS <- normalize(ekps.recoded$MOBILE_PHONE_SERVICE_OPERATORS)
ekps.recoded$STRENGTH_OF_CELLPHONE_SIGNALS<- normalize(ekps.recoded$STRENGTH_OF_CELLPHONE_SIGNALS)
```

```{r}
ekps.recoded <- ekps.recoded %>%
  mutate(`TELECOMMUNICATIONS` = NUM_FAMILIES_WITH_LANDLINES + CITIZENS_OWN_CELLPHONES + INTERNET_CAFES + BASE_TRANSCEIVER_STATIONS + MOBILE_PHONE_SERVICE_OPERATORS + STRENGTH_OF_CELLPHONE_SIGNALS)
```

Now, let us select out all the variables.
```{r}
ekps.transformed <- ekps.recoded %>%
  mutate(`MALNOURISHED_POP` = MALNUTRITION_POP_2017) %>%
  mutate(`POVERTY_POP` = STATEMENT_OF_POVERTY) %>%
  select("PROVINCE_ID", 
         "CITY_ID", 
         "DISTRICT_ID", 
         "VILLAGE_ID", 
         "REGION_CODE", 
         "DESA",
         "PRESENCE_SLUMS", 
         "SLASH_AND_BURN", 
         "MALNOURISHED_POP", 
         "POVERTY_POP",
         "TRANSPORTATION_METHODS",
         "ROAD_ACCESSIBLE_BY_4_WHEEL_VEHICLE",
         "PUBLIC_TRANSPORT",
         "NUM_LEATHER_INDUSTRY",
         "NUM_WOOD_INDUSTRY",
         "NUM_METAL_INDUSTRY",
         "NUM_FABRIC_INDUSTRY",
         "NUM_POTTERY_INDUSTRY",
         "NUM_BAMBOORATTAN_INDUSTRY",
         "NUM_FOOD_INDUSTRY",
         "ELECTRICTY",
         "WASTE_DISPOSAL",
         "WATER_MANAGEMENT",
         "NATURAL_DISASTER_SCORE",
         "HEALTHCARE_SERVICE_NUM",
         "HEALTHCARE_ACCESS_SCORE",
         "DISEASE_OUTBREAK_SCORE",
         "EDUCATION_INSTITUTION_NUM",
         "EDUCATION_ACCESS_SCORE",
         "MAIL_ACCESS_SCORE",
         "INDUSTRIES",
         "COOPERATIVES",
         "GROCERIES_NUMBER",
         "GROCERIES_ACCESS_SCORE",
         "FOOD_ESTAB_NUMBER",
         "FOOD_ESTAB_ACCESS_SCORE",
         "LODGING_NUM",
         "LODGING_ACCESS_SCORE",
         "TOOK_CREDIT_SCORE",
         "BANK_NUM",
         "BANK_ACCESS_SCORE",
         "FI_INFRA_NUM",
         "FI_INFRA_ACCESS_SCORE",
         "INFRA_DEVELOPMENT_SCORE",
         "TELECOMMUNICATIONS",
         "GEOMETRY"
         )
```

# 4. Exploratory Data Analysis (EDA)

## 4.1 EDA using choropleth map

```{r , echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}
tm_shape(eastkalimantan.podes)+
  tm_fill(col = "UNIVERSAL_HEALTHCARE_PROGRAMME_POP_2017",
          palette = "Blues",
          title = "Population with universal healthcare")+
  tm_text("CITY_ID", size = 0.2)+ 
  tm_borders(lwd=0.5)+
  tm_layout(legend.height = 0.50, 
            legend.width = 0.44,
            frame = FALSE) +
  tm_compass(type="8star", size = 2) +
  tm_scale_bar(width = 0.15)
```

## 4.2 Correlation Analysis 
```{r}
ekps.cor <- cor(as.data.frame(ekps.transformed[6:44] %>% st_set_geometry(NULL)))
corrplot.mixed(ekps.cor,
         lower = "ellipse", 
         upper = "number",
         tl.pos = "lt",
         diag = "l",
         tl.col = "black",
         tl.cex = 0.3
         )
```
As there are still many transformed variables, it becomes hard to interpret the correlation plot. Let us write a function that will pull out the variables with high correlation (>0.8) that we should drop for the clustering analysis. 

```{r}
corr_filter <- function(df_cor, threshold) {
  #run a correlation and drop the insignificant ones
  
  corr <- cor(df_cor)
  # replace lower triangle values with NA
  corr[lower.tri(corr,diag=TRUE)] <- NA 

  #change to data frame format 
  corr <- as.data.frame(as.table(corr))
  
  #drop NA values
  corr <- na.omit(corr) 
  
  # filter out correlations that are higher than the threshold
  
  corr <- subset(corr, abs(Freq) > threshold) 
  
  #sort by correlation value 
  corr <- corr[order(-abs(corr$Freq)),] 
  
  #print correlation table
  print(corr)
  
  # transform from df to matrix for plot
  mtx_corr <- reshape2::acast(corr, Var1~Var2, value.var="Freq")
  
  return(mtx_corr)
}
```

```{r}
ekps.corr.filtered <- corr_filter(as.data.frame(ekps.transformed[6:44] %>% st_set_geometry(NULL)), 0.7)
corrplot(ekps.corr.filtered,
         tl.pos = "lt",
         tl.col = "black",
         tl.cex = 0.5
         )
```
The above reduced plot shows us only the variables with correlations above 0.7. Looking at the plot, we will drop:

+ **HEALTHCARE_ACCESS_SCORE** as it has a high correlation with 6 other variables. 
+ **FI_INFRA_ACCESS_SCORE** as it has a high correlation with 4 other variables, getting rid of 3 more high correlations.
+ **BANK_ACCESS_SCORE** as it is highly correlated with 3 other variables, getting rid of 2 more high correlations. 
+ **EDUCATION_ACCESS_SCORE** as it is highly correlated with 2 other variables, getting rid of 2 more high correlations
+ **GROCERIES_ACCESS_SCORE** as it is highly correlated with 2 other variables, getting rid of the last 2 high correlations.

# 5. Clustering Analysis 

## 5.1 Hierarchial Clustering Analysis
Firstly, let us extract the clustering variables.

```{r}
cluster_df <- ekps.transformed %>%
  st_set_geometry(NULL) %>%
  select("DESA",
         "PRESENCE_SLUMS",
         "SLASH_AND_BURN",
         "MALNOURISHED_POP",
         "POVERTY_POP",
         "TRANSPORTATION_METHODS",
         "ROAD_ACCESSIBLE_BY_4_WHEEL_VEHICLE",
         "PUBLIC_TRANSPORT",
         "NUM_LEATHER_INDUSTRY",
         "NUM_WOOD_INDUSTRY",
         "NUM_METAL_INDUSTRY",
         "NUM_FABRIC_INDUSTRY",
         "NUM_POTTERY_INDUSTRY",
         "NUM_BAMBOORATTAN_INDUSTRY",
         "NUM_FOOD_INDUSTRY",
         "ELECTRICTY",
         "WASTE_DISPOSAL",
         "WATER_MANAGEMENT",
         "NATURAL_DISASTER_SCORE",
         "HEALTHCARE_SERVICE_NUM",
         "DISEASE_OUTBREAK_SCORE",
         "EDUCATION_INSTITUTION_NUM",
         "MAIL_ACCESS_SCORE",
         "INDUSTRIES",
         "COOPERATIVES",
         "GROCERIES_NUMBER",
         "FOOD_ESTAB_NUMBER",
         "FOOD_ESTAB_ACCESS_SCORE",
         "LODGING_NUM",
         "LODGING_ACCESS_SCORE",
         "TOOK_CREDIT_SCORE",
         "BANK_NUM",
         "FI_INFRA_NUM",
         "INFRA_DEVELOPMENT_SCORE",
         "TELECOMMUNICATIONS"
  )

head(cluster_df, 5)
```

Use region code as unique identifier of the rows. Drop **REGION_CODE** column afterwards
```{r}
row.names(cluster_df) <- cluster_df$DESA
cluster_df <- select(cluster_df, c(2:35))

# Verify df
head(cluster_df,5)
```

### 5.1.1 Standardise Data
This step is important as the variables that we have selected for are different in terms of units and thus range. We will use Min-Max standardisation as we cannot assume that the variables come from a normal distribution.

```{r}
cluster_df <- normalize(cluster_df)
summary(cluster_df)
```

### 5.1.2 Compute Proximity Matrix
This computes the euclidean distance between 2 of the DESAs using the input attributes.

```{r}
proxmat <- dist(cluster_df, method = "euclidean")
```

### 5.1.3 Select Optimal Clustering Method
```{r}
m <- c( "average", "single", "complete", "ward")
names(m) <- c( "average", "single", "complete", "ward")

ac <- function(x) {
  agnes(cluster_df, method = x)$ac
}

map_dbl(m, ac)
```
From the above, we can see the Ward's method provides the strongest clustering structure. We will use this method for hierarchical clustering of the municipalities.

### 5.1.4 Perform Hierarchical Clustering

```{r}
hclust_ward <- hclust(proxmat, method = 'ward.D')
```

Visualise Dendogram
```{r}
plot(hclust_ward, cex = 0.3)
```
### 5.1.5 Select Optimal Number of Clusters
We will use the gap statistic method which compares total intra-cluster variation for different number of clusters used; with comparison to the expected values under null reference data distriubtion. We want to select the cluster number that maximises the gap statistic.

```{r}
set.seed(12345)
gap_stat <- clusGap(cluster_df, FUN = hcut, nstart = 20, K.max = 15, B =50)
# Print the result
print(gap_stat, method = "firstmax")
```

Visualize Gap Statistic
```{r}
fviz_gap_stat(gap_stat)
```
From the above plot, we can see that the Gap Statistic seems to be increasing as k increases. While theoratically it means we can pick a large number for k, this is not a good practice as it will result in lesser than meaningful clusters. Pick k = 7 as the line from k =6 to k=7 is distinctively steeper than any value from k = 8 onwards. 

### 5.1.6 Cut Dendogram and Visualize it
```{r}
plot(hclust_ward, cex = 0.4)
rect.hclust(hclust_ward, k = 7, border = 2:5)
```
### 5.1.7 Visually-driven Hierarchical Clustering Analysis

Transform df to matrix
```{r}
cluster_df_mat <- data.matrix(cluster_df)
```

Plot interactive Cluster Heat Map
```{r}
heatmaply(cluster_df_mat,
          Colv=NA,
          dist_method = "euclidean",
          hclust_method = "ward.D",
          seriate = "OLO",
          colors = Blues,
          k_row = 7,
          margins = c(NA,200,60,NA),
          fontsize_row = 2,
          fontsize_col = 5,
          main="Geographic Segmentation of East Kalimantan by EconoSocial Indicators",
          xlab = "EconoSocial Indicators",
          ylab = "Kalimantan DESA"
          )
```

### 5.1.8 Map back Clusters
```{r}
groups <- as.factor(cutree(hclust_ward, k=7))
```

Join back to original df
```{r}
ekps.transformed <- cbind(ekps.transformed, as.matrix(groups)) %>%
  rename(`H_CLUSTER` = `as.matrix.groups.`)
```

Visualize on chloropleth
```{r}
qtm(ekps.transformed, "H_CLUSTER")
```